[0m16:22:47.606105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a864b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8d100>]}


============================== 16:22:47.613091 | 310e094f-1ab2-47ec-a65e-7fbc6cc7d3c5 ==============================
[0m16:22:47.613091 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:22:47.614065 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'quiet': 'False', 'version_check': 'True', 'static_parser': 'True', 'partial_parse': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'no_print': 'None', 'empty': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'target_path': 'None', 'introspect': 'True', 'printer_width': '80', 'profiles_dir': '/Users/cherry/.dbt', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': 'logs', 'invocation_command': 'dbt init', 'log_cache_events': 'False', 'use_colors': 'True', 'log_format': 'default', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:22:54.554796 [debug] [MainThread]: Starter project path: /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/include/starter_project
[0m16:22:54.565485 [info ] [MainThread]: 
Your new dbt project "dbt_project" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m16:22:54.566269 [info ] [MainThread]: Setting up your profile.
[0m16:33:57.830148 [info ] [MainThread]: Profile dbt_project written to /Users/cherry/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m16:33:57.840406 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 670.3503, "process_in_blocks": "0", "process_kernel_time": 0.892898, "process_mem_max_rss": "353140736", "process_out_blocks": "0", "process_user_time": 3.09855}
[0m16:33:57.843749 [debug] [MainThread]: Command `dbt init` succeeded at 16:33:57.843444 after 670.35 seconds
[0m16:33:57.845544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0e1e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136bc9ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135c8aff0>]}
[0m16:33:57.846391 [debug] [MainThread]: Flushing usage events
[0m16:33:58.403640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:47.550969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047bebd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053997f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050f9bb0>]}


============================== 16:34:47.557984 | 4c03709e-860d-4db5-9163-930a2f4b5d28 ==============================
[0m16:34:47.557984 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:34:47.559021 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'target_path': 'None', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'debug': 'False', 'log_format': 'default', 'fail_fast': 'False', 'invocation_command': 'dbt ', 'profiles_dir': '/Users/cherry/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'None', 'warn_error': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'quiet': 'False', 'printer_width': '80'}
[0m16:34:47.717079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c03709e-860d-4db5-9163-930a2f4b5d28', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cc3fb0>]}
[0m16:34:47.737147 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:34:47.738592 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:34:47.741396 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.2913334, "process_in_blocks": "0", "process_kernel_time": 0.294481, "process_mem_max_rss": "107872256", "process_out_blocks": "0", "process_user_time": 1.433329}
[0m16:34:47.742187 [debug] [MainThread]: Command `cli deps` succeeded at 16:34:47.741948 after 0.29 seconds
[0m16:34:47.742603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10567d6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10504d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a2f30>]}
[0m16:34:47.743095 [debug] [MainThread]: Flushing usage events
[0m16:34:48.199633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:58.764240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1197034d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aca1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11aca0e60>]}


============================== 16:44:58.771620 | 06ec0fbb-cafe-4328-b744-cf090a3ec0a4 ==============================
[0m16:44:58.771620 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:44:58.772968 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'partial_parse': 'True', 'fail_fast': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'printer_width': '80', 'debug': 'False', 'write_json': 'True', 'use_colors': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'version_check': 'True', 'empty': 'None', 'target_path': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'cache_selected_only': 'False', 'invocation_command': 'dbt ', 'use_experimental_parser': 'False', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None'}
[0m16:44:58.928605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '06ec0fbb-cafe-4328-b744-cf090a3ec0a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119b0ad80>]}
[0m16:44:58.951542 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:44:58.953464 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:44:58.956492 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.32506025, "process_in_blocks": "0", "process_kernel_time": 0.388402, "process_mem_max_rss": "105660416", "process_out_blocks": "0", "process_user_time": 1.650745}
[0m16:44:58.957370 [debug] [MainThread]: Command `cli deps` succeeded at 16:44:58.957229 after 0.33 seconds
[0m16:44:58.957853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ad82690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11adc1df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044f68d0>]}
[0m16:44:58.958577 [debug] [MainThread]: Flushing usage events
[0m16:44:59.498580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:02:51.526325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067476b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078790d0>]}


============================== 17:02:51.533510 | 0fefbd30-69da-4a01-a657-43e2966726d6 ==============================
[0m17:02:51.533510 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:02:51.534607 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/cherry/.dbt', 'printer_width': '80', 'version_check': 'True', 'empty': 'None', 'introspect': 'True', 'warn_error': 'None', 'debug': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_colors': 'True', 'invocation_command': 'dbt ', 'static_parser': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'fail_fast': 'False'}
[0m17:02:51.696906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fefbd30-69da-4a01-a657-43e2966726d6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079667b0>]}
[0m17:02:51.717082 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:02:51.718769 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m17:02:51.721668 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.28932533, "process_in_blocks": "0", "process_kernel_time": 0.325023, "process_mem_max_rss": "110280704", "process_out_blocks": "0", "process_user_time": 1.5004}
[0m17:02:51.722416 [debug] [MainThread]: Command `cli deps` succeeded at 17:02:51.722128 after 0.29 seconds
[0m17:02:51.722912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107879370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078790d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078791c0>]}
[0m17:02:51.723261 [debug] [MainThread]: Flushing usage events
[0m17:02:52.267743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:00.708003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063aeba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079950d0>]}


============================== 16:40:00.714089 | 2f5487f2-56f3-4dbb-bc4b-47714a061655 ==============================
[0m16:40:00.714089 [info ] [MainThread]: Running with dbt=1.10.13
[0m16:40:00.714846 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'introspect': 'True', 'fail_fast': 'False', 'printer_width': '80', 'target_path': 'None', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'quiet': 'False', 'static_parser': 'True', 'empty': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'invocation_command': 'dbt ', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'indirect_selection': 'eager'}
[0m16:40:00.835807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f5487f2-56f3-4dbb-bc4b-47714a061655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10732c6b0>]}
[0m16:40:00.855318 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:40:00.856025 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m16:40:00.867355 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22659612, "process_in_blocks": "0", "process_kernel_time": 0.289578, "process_mem_max_rss": "109887488", "process_out_blocks": "0", "process_user_time": 1.171058}
[0m16:40:00.867790 [debug] [MainThread]: Command `cli deps` succeeded at 16:40:00.867714 after 0.23 seconds
[0m16:40:00.868027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791a240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071a5d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107995100>]}
[0m16:40:00.868268 [debug] [MainThread]: Flushing usage events
[0m16:40:01.321005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:21:05.204452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b03350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a0d40>]}


============================== 23:21:05.210471 | a522c1aa-c9d9-421e-af89-ffa89befaf7b ==============================
[0m23:21:05.210471 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:21:05.211466 [debug] [MainThread]: running dbt with arguments {'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'static_parser': 'True', 'target_path': 'None', 'printer_width': '80', 'partial_parse': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'no_print': 'None'}
[0m23:21:05.324086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a522c1aa-c9d9-421e-af89-ffa89befaf7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a38e840>]}
[0m23:21:05.337799 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:21:05.338973 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m23:21:05.354774 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.22748616, "process_in_blocks": "0", "process_kernel_time": 0.240368, "process_mem_max_rss": "111050752", "process_out_blocks": "0", "process_user_time": 1.059895}
[0m23:21:05.355174 [debug] [MainThread]: Command `cli deps` succeeded at 23:21:05.355093 after 0.23 seconds
[0m23:21:05.355400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a0ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1a0bc0>]}
[0m23:21:05.355613 [debug] [MainThread]: Flushing usage events
[0m23:21:05.929815 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:39:26.769418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10889f7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f952e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f95010>]}


============================== 19:39:26.777561 | c7dc25bd-5eb0-4c3a-83ab-8f260caccf7c ==============================
[0m19:39:26.777561 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:39:26.778327 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'no_print': 'None', 'debug': 'False', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/cherry/.dbt', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'introspect': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error': 'None', 'partial_parse': 'True', 'empty': 'None', 'invocation_command': 'dbt debug', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'static_parser': 'True', 'version_check': 'True', 'log_format': 'default'}
[0m19:39:26.798987 [info ] [MainThread]: dbt version: 1.10.13
[0m19:39:26.799571 [info ] [MainThread]: python version: 3.12.11
[0m19:39:26.800002 [info ] [MainThread]: python path: /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/bin/python
[0m19:39:26.800446 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m19:39:29.999944 [info ] [MainThread]: Using profiles dir at /Users/cherry/.dbt
[0m19:39:30.000662 [info ] [MainThread]: Using profiles.yml file at /Users/cherry/.dbt/profiles.yml
[0m19:39:30.001263 [info ] [MainThread]: Using dbt_project.yml file at /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt_project.yml
[0m19:39:30.001617 [info ] [MainThread]: adapter type: bigquery
[0m19:39:30.002143 [info ] [MainThread]: adapter version: 1.10.2
[0m19:39:30.134615 [info ] [MainThread]: Configuration:
[0m19:39:30.135168 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:39:30.135541 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:39:30.136224 [info ] [MainThread]: Required dependencies:
[0m19:39:30.137052 [debug] [MainThread]: Executing "git --help"
[0m19:39:30.170385 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:39:30.171866 [debug] [MainThread]: STDERR: "b''"
[0m19:39:30.172300 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:39:30.173287 [info ] [MainThread]: Connection:
[0m19:39:30.173746 [info ] [MainThread]:   method: oauth
[0m19:39:30.174379 [info ] [MainThread]:   database: modern-sublime-383117
[0m19:39:30.174736 [info ] [MainThread]:   execution_project: modern-sublime-383117
[0m19:39:30.175534 [info ] [MainThread]:   schema: orders
[0m19:39:30.176056 [info ] [MainThread]:   location: US
[0m19:39:30.176732 [info ] [MainThread]:   priority: interactive
[0m19:39:30.177293 [info ] [MainThread]:   maximum_bytes_billed: 1000000000
[0m19:39:30.177728 [info ] [MainThread]:   impersonate_service_account: None
[0m19:39:30.177939 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:39:30.178227 [info ] [MainThread]:   job_retries: 1
[0m19:39:30.178746 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:39:30.179436 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:39:30.179782 [info ] [MainThread]:   timeout_seconds: 300
[0m19:39:30.180064 [info ] [MainThread]:   client_id: None
[0m19:39:30.180428 [info ] [MainThread]:   token_uri: None
[0m19:39:30.180787 [info ] [MainThread]:   compute_region: None
[0m19:39:30.181030 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:39:30.181272 [info ] [MainThread]:   gcs_bucket: None
[0m19:39:30.181888 [info ] [MainThread]:   dataproc_batch: None
[0m19:39:30.183409 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:39:30.595522 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:39:30.596244 [debug] [MainThread]: On debug: select 1 as id
[0m19:39:30.596726 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:39:32.251101 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:fe419568-0b2f-4013-aafb-fd4f5b2c716a&page=queryresults
[0m19:39:33.047631 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:39:33.048464 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:39:33.052915 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.378711, "process_in_blocks": "0", "process_kernel_time": 1.024724, "process_mem_max_rss": "355467264", "process_out_blocks": "0", "process_user_time": 3.54316}
[0m19:39:33.054134 [debug] [MainThread]: Command `dbt debug` succeeded at 19:39:33.053833 after 6.38 seconds
[0m19:39:33.054814 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:39:33.055829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a0ec90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ad8e600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aba88c0>]}
[0m19:39:33.056725 [debug] [MainThread]: Flushing usage events
[0m19:39:33.625090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:12:19.289006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10629bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069894f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069891f0>]}


============================== 21:12:19.296502 | 1ed2eafd-47cd-48a2-ab08-21949d106012 ==============================
[0m21:12:19.296502 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:12:19.297262 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'warn_error': 'None', 'quiet': 'False', 'target_path': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt deps', 'profiles_dir': '/Users/cherry/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'no_print': 'None', 'debug': 'False', 'use_colors': 'True', 'version_check': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'static_parser': 'True', 'log_cache_events': 'False'}
[0m21:12:19.482602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ed2eafd-47cd-48a2-ab08-21949d106012', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a16450>]}
[0m21:12:19.506862 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-2i3z3w5h'
[0m21:12:19.507375 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:12:19.816570 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:12:19.819995 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:12:20.013596 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:12:20.022095 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:12:20.170938 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:12:20.191079 [info ] [MainThread]: Updating lock file in file path: /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/package-lock.yml
[0m21:12:20.195957 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-21jf0wn2'
[0m21:12:20.203868 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:12:20.567180 [info ] [MainThread]: Installed from version 0.13.1
[0m21:12:20.567841 [info ] [MainThread]: Up to date!
[0m21:12:20.568766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ed2eafd-47cd-48a2-ab08-21949d106012', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9d130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106988fe0>]}
[0m21:12:20.569205 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:12:21.041750 [info ] [MainThread]: Installed from version 1.3.1
[0m21:12:21.042588 [info ] [MainThread]: Up to date!
[0m21:12:21.043185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1ed2eafd-47cd-48a2-ab08-21949d106012', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa2d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106aa04a0>]}
[0m21:12:21.046476 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.856006, "process_in_blocks": "0", "process_kernel_time": 0.471775, "process_mem_max_rss": "116342784", "process_out_blocks": "0", "process_user_time": 1.645213}
[0m21:12:21.047544 [debug] [MainThread]: Command `dbt deps` succeeded at 21:12:21.047264 after 1.86 seconds
[0m21:12:21.048032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069893a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106966690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b56ab0>]}
[0m21:12:21.048811 [debug] [MainThread]: Flushing usage events
[0m21:12:21.564685 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:18.327459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d3e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f952e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f94fe0>]}


============================== 22:11:18.334347 | 1a879883-3981-455c-84a7-658b84792ad2 ==============================
[0m22:11:18.334347 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:11:18.335272 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'printer_width': '80', 'log_format': 'default', 'empty': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "COGS", "database_name": "modern-sublime-383117", "generate_columns": true}', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'warn_error': 'None', 'profiles_dir': '/Users/cherry/.dbt'}
[0m22:11:21.925327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14d672180>]}
[0m22:11:22.005001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f101070>]}
[0m22:11:22.005830 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:11:22.456860 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:11:22.745769 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m22:11:22.746728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10890c680>]}
[0m22:11:24.754292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15830edb0>]}
[0m22:11:24.855865 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:11:24.858343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:11:24.877692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585d1fd0>]}
[0m22:11:24.878130 [info ] [MainThread]: Found 2 models, 4 data tests, 646 macros
[0m22:11:24.878710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a879883-3981-455c-84a7-658b84792ad2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x158347ce0>]}
[0m22:11:24.879562 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:11:24.939905 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.COGS.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:11:24.940780 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:27.106445 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:3a393d33-9bfd-46cd-9bb7-b1f39dcfa319&page=queryresults
[0m22:11:28.846928 [info ] [MainThread]: version: 2

sources:
  - name: cogs
    tables:
      - name: bb cogs
        columns:

[0m22:11:28.866107 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:11:28.870150 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 10.639735, "process_in_blocks": "0", "process_kernel_time": 1.301418, "process_mem_max_rss": "367312896", "process_out_blocks": "0", "process_user_time": 5.381205}
[0m22:11:28.870905 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:11:28.870680 after 10.64 seconds
[0m22:11:28.871348 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:11:28.871838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585a0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1585b9df0>]}
[0m22:11:28.872408 [debug] [MainThread]: Flushing usage events
[0m22:11:29.400905 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:12:59.005229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ab080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a1490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a1190>]}


============================== 22:12:59.013102 | 264618a7-f788-4d02-9506-5d73fe4312ae ==============================
[0m22:12:59.013102 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:12:59.014114 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'printer_width': '80', 'log_format': 'default', 'write_json': 'True', 'warn_error': 'None', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'no_print': 'None', 'fail_fast': 'False', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "awd", "database_name": "modern-sublime-383117", "generate_columns": true}', 'quiet': 'False'}
[0m22:13:02.408778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '264618a7-f788-4d02-9506-5d73fe4312ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149ce0800>]}
[0m22:13:02.487525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '264618a7-f788-4d02-9506-5d73fe4312ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058de990>]}
[0m22:13:02.488295 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:13:02.912832 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:13:03.273458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:13:03.274188 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/COGS/sources.yml
[0m22:13:03.388796 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/COGS/sources.yml @ sources: {'name': 'cogs', 'tables': [{'name': 'bb cogs', 'columns': None}]} - at path ['tables'][0]['columns']: None is not of type 'array'
[0m22:13:03.393974 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.485802, "process_in_blocks": "0", "process_kernel_time": 1.046438, "process_mem_max_rss": "361168896", "process_out_blocks": "0", "process_user_time": 3.87003}
[0m22:13:03.394653 [debug] [MainThread]: Command `dbt run-operation` failed at 22:13:03.394525 after 4.49 seconds
[0m22:13:03.395256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060a10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149c18b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058aa1b0>]}
[0m22:13:03.395671 [debug] [MainThread]: Flushing usage events
[0m22:13:03.933450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:20:31.816353 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c95640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c953a0>]}


============================== 22:20:31.823175 | bfc870b3-e890-4442-a51b-234516db8719 ==============================
[0m22:20:31.823175 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:20:31.823973 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'log_format': 'default', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'target_path': 'None', 'version_check': 'True', 'static_parser': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "awd", "database_name": "modern-sublime-383117", "generate_columns": true}', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'debug': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/cherry/.dbt', 'partial_parse': 'True', 'write_json': 'True', 'warn_error': 'None', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'use_colors': 'True'}
[0m22:20:35.276858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bfc870b3-e890-4442-a51b-234516db8719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107618b90>]}
[0m22:20:35.360331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bfc870b3-e890-4442-a51b-234516db8719', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105021010>]}
[0m22:20:35.361325 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:20:35.798511 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:20:36.211110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:20:36.212121 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/COGS/sources.yml
[0m22:20:36.341051 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid sources config given in models/staging/COGS/sources.yml @ sources: {'name': 'COGS', 'tables': [{'name': 'BB COGS', 'columns': None}]} - at path ['tables'][0]['columns']: None is not of type 'array'
[0m22:20:36.344984 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.6170025, "process_in_blocks": "0", "process_kernel_time": 1.099391, "process_mem_max_rss": "360939520", "process_out_blocks": "0", "process_user_time": 4.010848}
[0m22:20:36.345638 [debug] [MainThread]: Command `dbt run-operation` failed at 22:20:36.345530 after 4.62 seconds
[0m22:20:36.346036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671f980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163b64e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14fd5ca70>]}
[0m22:20:36.346449 [debug] [MainThread]: Flushing usage events
[0m22:20:36.875352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:21:16.860236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057a66f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e956a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e953a0>]}


============================== 22:21:16.867715 | f28eef0e-2284-487c-b731-696b01538e0d ==============================
[0m22:21:16.867715 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:21:16.868869 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'no_print': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_cache_events': 'False', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "awd", "database_name": "modern-sublime-383117", "generate_columns": true}', 'partial_parse': 'True', 'static_parser': 'True', 'introspect': 'True', 'use_colors': 'True', 'empty': 'None', 'warn_error': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'version_check': 'True', 'quiet': 'False'}
[0m22:21:20.272183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f28eef0e-2284-487c-b731-696b01538e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eb90ce0>]}
[0m22:21:20.352718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f28eef0e-2284-487c-b731-696b01538e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105818710>]}
[0m22:21:20.353654 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:21:20.911205 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:21:21.482447 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:21:21.483630 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:21:21.555245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f28eef0e-2284-487c-b731-696b01538e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12eac4740>]}
[0m22:21:21.722750 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:21:21.727953 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:21:21.755145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f28eef0e-2284-487c-b731-696b01538e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ee68320>]}
[0m22:21:21.756993 [info ] [MainThread]: Found 2 models, 4 data tests, 646 macros
[0m22:21:21.757952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f28eef0e-2284-487c-b731-696b01538e0d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ecc37d0>]}
[0m22:21:21.759496 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:21:21.865283 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.awd.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:21:21.866492 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:24.882340 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:cd181a29-2934-40ad-94bc-ea1c94902a89&page=queryresults
[0m22:21:27.959085 [info ] [MainThread]: version: 2

sources:
  - name: awd
    tables:
      - name: inbound_shipments
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: ship_by
            data_type: string
          - name: order_id
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: tracking_id
            data_type: string
          - name: shipment_status
            data_type: string
          - name: received_quantity
            data_type: string
          - name: origin_address_city
            data_type: string
          - name: origin_address_name
            data_type: string
          - name: external_reference_id
            data_type: string
          - name: warehouse_reference_id
            data_type: string
          - name: origin_address_district
            data_type: string
          - name: shipment_sku_quantities
            data_type: string
          - name: destination_address_city
            data_type: string
          - name: destination_address_name
            data_type: string
          - name: shipment_create_date_utc
            data_type: timestamp
          - name: origin_address_postal_code
            data_type: int64
          - name: origin_address_country_code
            data_type: string
          - name: origin_address_phone_number
            data_type: int64
          - name: destination_address_district
            data_type: string
          - name: origin_address_address_line_1
            data_type: string
          - name: origin_address_address_line_2
            data_type: string
          - name: shipment_container_quantities
            data_type: string
          - name: shipment_last_update_date_utc
            data_type: timestamp
          - name: carrier_code_carrier_code_type
            data_type: string
          - name: origin_address_state_or_region
            data_type: string
          - name: carrier_code_carrier_code_value
            data_type: string
          - name: destination_address_postal_code
            data_type: string
          - name: destination_address_country_code
            data_type: string
          - name: destination_address_address_line_1
            data_type: string
          - name: destination_address_address_line_2
            data_type: string
          - name: destination_address_address_line_3
            data_type: string
          - name: destination_address_state_or_region
            data_type: string

      - name: inbound_shipments_detailed_view
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: asin
            data_type: string
          - name: date
            data_type: date
          - name: cases
            data_type: int64
          - name: country
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: facility_id
            data_type: string
          - name: shipment_id
            data_type: string
          - name: total_quantity
            data_type: int64
          - name: shipment_status
            data_type: string
          - name: inbound_quantity
            data_type: int64
          - name: package_quantity
            data_type: int64
          - name: expected_quantity
            data_type: int64
          - name: inbound_box_count
            data_type: int64
          - name: received_quantity
            data_type: int64
          - name: expected_box_count
            data_type: int64
          - name: received_box_count
            data_type: int64

      - name: inbound_shipments_summary
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: order_id
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: shipment_status
            data_type: string
          - name: external_reference_id
            data_type: string
          - name: shipment_create_date_utc
            data_type: timestamp
          - name: shipment_last_update_date_utc
            data_type: timestamp

      - name: inventory
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: total_onhand_quantity
            data_type: int64
          - name: total_inbound_quantity
            data_type: int64
          - name: inventory_details_reserved_distributable_quantity
            data_type: int64
          - name: inventory_details_available_distributable_quantity
            data_type: int64

[0m22:21:27.980698 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:21:27.984379 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 11.219317, "process_in_blocks": "0", "process_kernel_time": 1.27216, "process_mem_max_rss": "359776256", "process_out_blocks": "0", "process_user_time": 4.633129}
[0m22:21:27.985580 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:21:27.985405 after 11.22 seconds
[0m22:21:27.986100 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:21:27.986544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d99130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12f085340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12ef65dc0>]}
[0m22:21:27.987350 [debug] [MainThread]: Flushing usage events
[0m22:21:28.463087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:22:37.171289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c1e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa1100>]}


============================== 22:22:37.179212 | f945f1f7-e852-4f34-8c4f-cad800759f29 ==============================
[0m22:22:37.179212 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:22:37.180207 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'None', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "brand_analytics", "database_name": "modern-sublime-383117", "generate_columns": true}', 'write_json': 'True', 'log_format': 'default', 'use_colors': 'True', 'indirect_selection': 'eager', 'printer_width': '80', 'introspect': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'log_cache_events': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'target_path': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m22:22:40.531648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f945f1f7-e852-4f34-8c4f-cad800759f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14ae0ee10>]}
[0m22:22:40.613089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f945f1f7-e852-4f34-8c4f-cad800759f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f1e720>]}
[0m22:22:40.613984 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:22:41.066564 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:22:41.453752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:22:41.454236 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:22:41.518063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f945f1f7-e852-4f34-8c4f-cad800759f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b268410>]}
[0m22:22:41.645903 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:22:41.649046 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:22:41.667688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f945f1f7-e852-4f34-8c4f-cad800759f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b55e1b0>]}
[0m22:22:41.668315 [info ] [MainThread]: Found 2 models, 4 data tests, 4 sources, 646 macros
[0m22:22:41.668908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f945f1f7-e852-4f34-8c4f-cad800759f29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14aefb2f0>]}
[0m22:22:41.669578 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:22:41.735142 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.brand_analytics.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:22:41.736562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:22:43.682066 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:bf96933d-0d4a-4d76-b84c-c54d1e164b66&page=queryresults
[0m22:22:45.898023 [info ] [MainThread]: version: 2

sources:
  - name: brand_analytics
    tables:
      - name: search_query_performance_asin_view
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: week
            data_type: string
          - name: end_date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: clicks_price
            data_type: numeric
          - name: search_query
            data_type: string
          - name: reporting_date
            data_type: date
          - name: cart_adds_price
            data_type: numeric
          - name: purchases_price
            data_type: numeric
          - name: reporting_range
            data_type: string
          - name: clicks_asin_count
            data_type: int64
          - name: clicks_asin_price
            data_type: numeric
          - name: clicks_asin_share
            data_type: numeric
          - name: clicks_click_rate
            data_type: numeric
          - name: clicks_total_count
            data_type: int64
          - name: search_query_score
            data_type: int64
          - name: search_query_volume
            data_type: int64
          - name: cart_adds_asin_count
            data_type: int64
          - name: cart_adds_asin_price
            data_type: numeric
          - name: cart_adds_asin_share
            data_type: numeric
          - name: purchases_asin_count
            data_type: int64
          - name: purchases_asin_price
            data_type: numeric
          - name: purchases_asin_share
            data_type: numeric
          - name: cart_adds_total_count
            data_type: int64
          - name: purchases_total_count
            data_type: int64
          - name: impressions_asin_count
            data_type: int64
          - name: impressions_asin_share
            data_type: numeric
          - name: cart_adds_cart_add_rate
            data_type: numeric
          - name: impressions_total_count
            data_type: int64
          - name: purchases_purchase_rate
            data_type: numeric
          - name: clicks_1d_shipping_speed
            data_type: int64
          - name: clicks_2d_shipping_speed
            data_type: int64
          - name: cart_adds_1d_shipping_speed
            data_type: int64
          - name: cart_adds_2d_shipping_speed
            data_type: int64
          - name: purchases_1d_shipping_speed
            data_type: int64
          - name: purchases_2d_shipping_speed
            data_type: int64
          - name: clicks_same_day_shipping_speed
            data_type: int64
          - name: cart_adds_same_day_shipping_speed
            data_type: int64
          - name: purchases_same_day_shipping_speed
            data_type: int64

      - name: search_query_performance_brand_view
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: week
            data_type: string
          - name: end_date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: clicks_price
            data_type: numeric
          - name: search_query
            data_type: string
          - name: reporting_date
            data_type: date
          - name: cart_adds_price
            data_type: numeric
          - name: purchases_price
            data_type: numeric
          - name: reporting_range
            data_type: string
          - name: clicks_click_rate
            data_type: numeric
          - name: clicks_brand_count
            data_type: int64
          - name: clicks_brand_price
            data_type: numeric
          - name: clicks_brand_share
            data_type: numeric
          - name: clicks_total_count
            data_type: int64
          - name: search_query_score
            data_type: int64
          - name: search_query_volume
            data_type: int64
          - name: cart_adds_brand_count
            data_type: int64
          - name: cart_adds_brand_price
            data_type: numeric
          - name: cart_adds_brand_share
            data_type: numeric
          - name: cart_adds_total_count
            data_type: int64
          - name: purchases_brand_count
            data_type: int64
          - name: purchases_brand_price
            data_type: numeric
          - name: purchases_brand_share
            data_type: numeric
          - name: purchases_total_count
            data_type: int64
          - name: cart_adds_cart_add_rate
            data_type: numeric
          - name: impressions_brand_count
            data_type: int64
          - name: impressions_brand_share
            data_type: numeric
          - name: impressions_total_count
            data_type: int64
          - name: purchases_purchase_rate
            data_type: numeric
          - name: clicks_1d_shipping_speed
            data_type: int64
          - name: clicks_2d_shipping_speed
            data_type: int64
          - name: cart_adds_1d_shipping_speed
            data_type: int64
          - name: cart_adds_2d_shipping_speed
            data_type: int64
          - name: purchases_1d_shipping_speed
            data_type: int64
          - name: purchases_2d_shipping_speed
            data_type: int64
          - name: clicks_same_day_shipping_speed
            data_type: int64
          - name: cart_adds_same_day_shipping_speed
            data_type: int64
          - name: purchases_same_day_shipping_speed
            data_type: int64

      - name: search_query_performance_weekly_asin
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: end_date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: search_query
            data_type: string
          - name: asin_click_count
            data_type: numeric
          - name: asin_click_share
            data_type: numeric
          - name: total_click_rate
            data_type: numeric
          - name: total_click_count
            data_type: numeric
          - name: search_query_score
            data_type: numeric
          - name: asin_cart_add_count
            data_type: numeric
          - name: asin_cart_add_share
            data_type: numeric
          - name: asin_purchase_count
            data_type: numeric
          - name: asin_purchase_share
            data_type: numeric
          - name: search_query_volume
            data_type: numeric
          - name: total_cart_add_rate
            data_type: numeric
          - name: total_purchase_rate
            data_type: numeric
          - name: total_cart_add_count
            data_type: numeric
          - name: total_purchase_count
            data_type: numeric
          - name: asin_impression_count
            data_type: numeric
          - name: asin_impression_share
            data_type: numeric
          - name: asin_median_click_price
            data_type: numeric
          - name: asin_median_cart_add_price
            data_type: numeric
          - name: asin_median_purchase_price
            data_type: numeric
          - name: total_median_cart_add_price
            data_type: numeric
          - name: total_median_purchase_price
            data_type: numeric
          - name: total_query_impression_count
            data_type: numeric
          - name: asin_median_click_price_amount
            data_type: numeric
          - name: total_median_click_price_amount
            data_type: numeric
          - name: asin_median_cart_add_price_amount
            data_type: numeric
          - name: asin_median_purchase_price_amount
            data_type: numeric
          - name: total_median_cart_add_price_amount
            data_type: numeric
          - name: total_median_purchase_price_amount
            data_type: numeric
          - name: total_one_day_shipping_click_count
            data_type: numeric
          - name: total_two_day_shipping_click_count
            data_type: numeric
          - name: total_same_day_shipping_click_count
            data_type: numeric
          - name: asin_median_click_price_currency_code
            data_type: string
          - name: total_one_day_shipping_cart_add_count
            data_type: numeric
          - name: total_one_day_shipping_purchase_count
            data_type: numeric
          - name: total_two_day_shipping_cart_add_count
            data_type: numeric
          - name: total_two_day_shipping_purchase_count
            data_type: numeric
          - name: total_median_click_price_currency_code
            data_type: string
          - name: total_same_day_shipping_cart_add_count
            data_type: numeric
          - name: total_same_day_shipping_purchase_count
            data_type: numeric
          - name: asin_median_cart_add_price_currency_code
            data_type: string
          - name: asin_median_purchase_price_currency_code
            data_type: string
          - name: total_median_cart_add_price_currency_code
            data_type: string
          - name: total_median_purchase_price_currency_code
            data_type: string

[0m22:22:45.916911 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:22:45.920685 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.837588, "process_in_blocks": "0", "process_kernel_time": 1.125694, "process_mem_max_rss": "362463232", "process_out_blocks": "0", "process_user_time": 4.109414}
[0m22:22:45.921690 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:22:45.921423 after 8.84 seconds
[0m22:22:45.922325 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:22:45.923150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a0ce870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14b0bd7c0>]}
[0m22:22:45.923951 [debug] [MainThread]: Flushing usage events
[0m22:22:46.439047 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:27:14.451450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c49760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105395670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105395340>]}


============================== 22:27:14.459460 | 9221b051-5c81-4a50-a020-05012fa0cc6b ==============================
[0m22:27:14.459460 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:27:14.460539 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'static_parser': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "business_reports", "database_name": "modern-sublime-383117", "generate_columns": true}', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'fail_fast': 'False', 'write_json': 'True', 'no_print': 'None', 'quiet': 'False', 'partial_parse': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_format': 'default', 'indirect_selection': 'eager', 'debug': 'False', 'printer_width': '80'}
[0m22:27:17.875574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9221b051-5c81-4a50-a020-05012fa0cc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160d04b30>]}
[0m22:27:17.956896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9221b051-5c81-4a50-a020-05012fa0cc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15fbbccb0>]}
[0m22:27:17.957981 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:27:18.406473 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:27:18.801046 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:27:18.801821 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/business_reports/sources.yml
[0m22:27:18.951959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9221b051-5c81-4a50-a020-05012fa0cc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160ec5f70>]}
[0m22:27:19.082079 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:27:19.085362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:27:19.106971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9221b051-5c81-4a50-a020-05012fa0cc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1621924e0>]}
[0m22:27:19.107743 [info ] [MainThread]: Found 2 models, 4 data tests, 7 sources, 646 macros
[0m22:27:19.108096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9221b051-5c81-4a50-a020-05012fa0cc6b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c768470>]}
[0m22:27:19.108708 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:27:19.171649 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.business_reports.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:27:19.172413 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:27:21.206700 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:4149e02b-cc7a-4a45-8360-831e4221fa11&page=queryresults
[0m22:27:23.331068 [info ] [MainThread]: version: 2

sources:
  - name: business_reports
    tables:
      - name: detail_page_sales_and_traffic_child
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: child_asin
            data_type: string
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: parent_asin
            data_type: string
          - name: traffic_by_asin_sessions
            data_type: numeric
          - name: traffic_by_asin_page_views
            data_type: numeric
          - name: sales_by_asin_units_ordered
            data_type: numeric
          - name: traffic_by_asin_sessions_b2b
            data_type: numeric
          - name: traffic_by_asin_page_views_b2b
            data_type: numeric
          - name: sales_by_asin_total_order_items
            data_type: numeric
          - name: sales_by_asin_units_ordered_b2b
            data_type: numeric
          - name: traffic_by_asin_browser_sessions
            data_type: numeric
          - name: traffic_by_asin_browser_page_views
            data_type: numeric
          - name: traffic_by_asin_buy_box_percentage
            data_type: numeric
          - name: traffic_by_asin_session_percentage
            data_type: numeric
          - name: sales_by_asin_total_order_items_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_sessions
            data_type: numeric
          - name: traffic_by_asin_browser_sessions_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views
            data_type: numeric
          - name: traffic_by_asin_page_views_percentage
            data_type: numeric
          - name: traffic_by_asin_browser_page_views_b2b
            data_type: numeric
          - name: traffic_by_asin_buy_box_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_sessions_b2b
            data_type: numeric
          - name: traffic_by_asin_unit_session_percentage
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_b2b
            data_type: numeric
          - name: traffic_by_asin_page_views_percentage_b2b
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_amount
            data_type: numeric
          - name: traffic_by_asin_browser_session_percentage
            data_type: numeric
          - name: traffic_by_asin_unit_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_browser_page_views_percentage
            data_type: numeric
          - name: traffic_by_asin_mobile_app_session_percentage
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_b2b_amount
            data_type: numeric
          - name: traffic_by_asin_browser_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_percentage
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_currency_code
            data_type: string
          - name: traffic_by_asin_browser_page_views_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_percentage_b2b
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_b2b_currency_code
            data_type: string

      - name: detail_page_sales_and_traffic_parent
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: parent_asin
            data_type: string
          - name: traffic_by_asin_sessions
            data_type: int64
          - name: traffic_by_asin_page_views
            data_type: int64
          - name: sales_by_asin_units_ordered
            data_type: int64
          - name: traffic_by_asin_sessions_b2b
            data_type: int64
          - name: traffic_by_asin_page_views_b2b
            data_type: int64
          - name: sales_by_asin_total_order_items
            data_type: int64
          - name: sales_by_asin_units_ordered_b2b
            data_type: int64
          - name: traffic_by_asin_browser_sessions
            data_type: int64
          - name: traffic_by_asin_browser_page_views
            data_type: int64
          - name: traffic_by_asin_buy_box_percentage
            data_type: numeric
          - name: traffic_by_asin_session_percentage
            data_type: numeric
          - name: sales_by_asin_total_order_items_b2b
            data_type: int64
          - name: traffic_by_asin_mobile_app_sessions
            data_type: int64
          - name: traffic_by_asin_browser_sessions_b2b
            data_type: int64
          - name: traffic_by_asin_mobile_app_page_views
            data_type: int64
          - name: traffic_by_asin_page_views_percentage
            data_type: numeric
          - name: traffic_by_asin_browser_page_views_b2b
            data_type: int64
          - name: traffic_by_asin_buy_box_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_sessions_b2b
            data_type: int64
          - name: traffic_by_asin_unit_session_percentage
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_b2b
            data_type: int64
          - name: traffic_by_asin_page_views_percentage_b2b
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_amount
            data_type: numeric
          - name: traffic_by_asin_browser_session_percentage
            data_type: numeric
          - name: traffic_by_asin_unit_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_browser_page_views_percentage
            data_type: numeric
          - name: traffic_by_asin_mobile_app_session_percentage
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_b2b_amount
            data_type: numeric
          - name: traffic_by_asin_browser_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_percentage
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_currency_code
            data_type: string
          - name: traffic_by_asin_browser_page_views_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_session_percentage_b2b
            data_type: numeric
          - name: traffic_by_asin_mobile_app_page_views_percentage_b2b
            data_type: numeric
          - name: sales_by_asin_ordered_product_sales_b2b_currency_code
            data_type: string

      - name: fba_fee_preview
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: asin
            data_type: string
          - name: date
            data_type: date
          - name: brand
            data_type: string
          - name: fnsku
            data_type: string
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: your_price
            data_type: numeric
          - name: median_side
            data_type: numeric
          - name: sales_price
            data_type: numeric
          - name: amazon_store
            data_type: string
          - name: fulfilled_by
            data_type: string
          - name: longest_side
            data_type: numeric
          - name: product_name
            data_type: string
          - name: product_group
            data_type: string
          - name: shortest_side
            data_type: numeric
          - name: unit_of_weight
            data_type: string
          - name: length_and_girth
            data_type: numeric
          - name: product_size_tier
            data_type: string
          - name: unit_of_dimension
            data_type: string
          - name: estimated_fee_total
            data_type: numeric
          - name: item_package_weight
            data_type: numeric
          - name: estimated_variable_closing_fee
            data_type: numeric
          - name: estimated_referral_fee_per_unit
            data_type: numeric
          - name: estimated_pick_pack_fee_per_unit
            data_type: numeric
          - name: expected_fulfillment_fee_per_unit
            data_type: numeric
          - name: estimated_order_handling_fee_per_order
            data_type: numeric
          - name: estimated_weight_handling_fee_per_unit
            data_type: numeric

[0m22:27:23.351420 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:27:23.356645 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.997591, "process_in_blocks": "0", "process_kernel_time": 1.134174, "process_mem_max_rss": "368623616", "process_out_blocks": "0", "process_user_time": 4.207703}
[0m22:27:23.357288 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:27:23.357129 after 9.00 seconds
[0m22:27:23.358250 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:27:23.358851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105395460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1621920c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1625369f0>]}
[0m22:27:23.359642 [debug] [MainThread]: Flushing usage events
[0m22:27:23.893128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:34:40.573020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f1ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115956a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115953a0>]}


============================== 22:34:40.581029 | f6900f4e-6609-4908-90f5-ed91f5adf5c7 ==============================
[0m22:34:40.581029 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:34:40.581953 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "fulfillment_inbound", "database_name": "modern-sublime-383117", "generate_columns": true}', 'printer_width': '80', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'write_json': 'True', 'log_format': 'default', 'introspect': 'True', 'log_cache_events': 'False', 'target_path': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False', 'no_print': 'None', 'debug': 'False', 'cache_selected_only': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'partial_parse': 'True'}
[0m22:34:43.989385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6900f4e-6609-4908-90f5-ed91f5adf5c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164636e70>]}
[0m22:34:44.070471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6900f4e-6609-4908-90f5-ed91f5adf5c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1645ce810>]}
[0m22:34:44.071479 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:34:44.514790 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:34:44.906295 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:34:44.907419 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/fulfillment_inbound/sources.yml
[0m22:34:45.056825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6900f4e-6609-4908-90f5-ed91f5adf5c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166630470>]}
[0m22:34:45.194829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:34:45.198477 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:34:45.221816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6900f4e-6609-4908-90f5-ed91f5adf5c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1666e2240>]}
[0m22:34:45.222842 [info ] [MainThread]: Found 2 models, 4 data tests, 10 sources, 646 macros
[0m22:34:45.223725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6900f4e-6609-4908-90f5-ed91f5adf5c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1666c2bd0>]}
[0m22:34:45.224438 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:34:45.304338 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.fulfillment_inbound.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:34:45.304800 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:48.020003 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:0c17a996-b96b-4a2d-9822-4390479a1210&page=queryresults
[0m22:34:50.759836 [info ] [MainThread]: version: 2

sources:
  - name: fulfillment_inbound
    tables:
      - name: fba_awd_shipments_view
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: skus
            data_type: int64
          - name: created
            data_type: timestamp
          - name: ship_from
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: last_updated
            data_type: timestamp
          - name: reference_id
            data_type: string
          - name: shipment_name
            data_type: string
          - name: origin_country
            data_type: string
          - name: inbound_plan_id
            data_type: string
          - name: shipment_status
            data_type: string
          - name: quantity_shipped
            data_type: int64
          - name: quantity_received
            data_type: int64
          - name: fulfillment_center
            data_type: string
          - name: destination_country
            data_type: string

      - name: inbound_plans
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: status
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: date_created_at
            data_type: timestamp
          - name: inbound_plan_id
            data_type: string
          - name: last_updated_at
            data_type: timestamp
          - name: marketplace_ids
            data_type: json
          - name: source_address_city
            data_type: string
          - name: source_address_name
            data_type: string
          - name: source_address_email
            data_type: string
          - name: source_address_postal_code
            data_type: string
          - name: source_address_company_name
            data_type: string
          - name: source_address_country_code
            data_type: string
          - name: source_address_phone_number
            data_type: string
          - name: source_address_address_line_1
            data_type: string
          - name: source_address_address_line_2
            data_type: string
          - name: source_address_state_or_province_code
            data_type: string

      - name: inbound_plans_info
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: status
            data_type: string
          - name: shipments
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: date_created_at
            data_type: timestamp
          - name: inbound_plan_id
            data_type: string
          - name: last_updated_at
            data_type: timestamp
          - name: marketplace_ids
            data_type: json
          - name: packing_options
            data_type: string
          - name: placement_options
            data_type: string
          - name: source_address_city
            data_type: string
          - name: source_address_name
            data_type: string
          - name: source_address_postal_code
            data_type: string
          - name: source_address_company_name
            data_type: string
          - name: source_address_country_code
            data_type: string
          - name: source_address_phone_number
            data_type: string
          - name: source_address_address_line_1
            data_type: string
          - name: source_address_address_line_2
            data_type: string
          - name: source_address_state_or_province_code
            data_type: string

      - name: inbound_plans_shipments
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: status
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: source_source_type
            data_type: string
          - name: amazon_reference_id
            data_type: string
          - name: placement_option_id
            data_type: string
          - name: source_address_city
            data_type: string
          - name: source_address_name
            data_type: string
          - name: contact_information_name
            data_type: string
          - name: destination_address_city
            data_type: string
          - name: destination_address_name
            data_type: string
          - name: destination_warehouse_id
            data_type: string
          - name: shipment_confirmation_id
            data_type: string
          - name: contact_information_email
            data_type: string
          - name: source_address_postal_code
            data_type: string
          - name: source_address_company_name
            data_type: string
          - name: source_address_country_code
            data_type: string
          - name: source_address_phone_number
            data_type: string
          - name: destination_destination_type
            data_type: string
          - name: source_address_address_line_1
            data_type: string
          - name: source_address_address_line_2
            data_type: string
          - name: dates_ready_to_ship_window_end
            data_type: timestamp
          - name: destination_address_postal_code
            data_type: string
          - name: contact_information_phone_number
            data_type: string
          - name: dates_ready_to_ship_window_start
            data_type: timestamp
          - name: destination_address_country_code
            data_type: string
          - name: selected_delivery_window_end_date
            data_type: timestamp
          - name: selected_transportation_option_id
            data_type: string
          - name: destination_address_address_line_1
            data_type: string
          - name: selected_delivery_window_start_date
            data_type: timestamp
          - name: source_address_state_or_province_code
            data_type: string
          - name: selected_delivery_window_editable_until
            data_type: string
          - name: destination_address_state_or_province_code
            data_type: string
          - name: selected_delivery_window_availability_type
            data_type: string
          - name: selected_delivery_window_delivery_window_option_id
            data_type: string
          - name: tracking_details_spd_tracking_detail_spd_tracking_items
            data_type: string
          - name: tracking_details_ltl_tracking_detail_freight_bill_number
            data_type: json
          - name: tracking_details_ltl_tracking_detail_bill_of_lading_number
            data_type: string

      - name: shipment_items
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: seller_sku
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: quantity_in_case
            data_type: int64
          - name: quantity_shipped
            data_type: int64
          - name: prep_details_list
            data_type: string
          - name: quantity_received
            data_type: int64
          - name: fulfillment_network_sku
            data_type: string

      - name: shipments
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: shipment_id
            data_type: string
          - name: shipment_name
            data_type: string
          - name: label_prep_type
            data_type: string
          - name: shipment_status
            data_type: string
          - name: are_cases_required
            data_type: string
          - name: box_contents_source
            data_type: string
          - name: ship_from_address_city
            data_type: string
          - name: ship_from_address_name
            data_type: string
          - name: ship_from_address_postal_code
            data_type: string
          - name: ship_from_address_country_code
            data_type: string
          - name: ship_from_address_address_line_1
            data_type: string
          - name: ship_from_address_address_line_2
            data_type: string
          - name: destination_fulfillment_center_id
            data_type: string
          - name: ship_from_address_district_or_county
            data_type: string
          - name: estimated_box_contents_fee_total_units
            data_type: numeric
          - name: ship_from_address_state_or_province_code
            data_type: string
          - name: estimated_box_contents_fee_total_fee_value
            data_type: numeric
          - name: estimated_box_contents_fee_fee_per_unit_value
            data_type: numeric
          - name: estimated_box_contents_fee_total_fee_currency_code
            data_type: string
          - name: estimated_box_contents_fee_fee_per_unit_currency_code
            data_type: string

[0m22:34:50.779479 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:34:50.783441 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 10.305627, "process_in_blocks": "0", "process_kernel_time": 1.129743, "process_mem_max_rss": "364773376", "process_out_blocks": "0", "process_user_time": 4.209372}
[0m22:34:50.784460 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:34:50.784226 after 10.31 seconds
[0m22:34:50.785003 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:34:50.785842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111595490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1660c5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1666e24e0>]}
[0m22:34:50.786629 [debug] [MainThread]: Flushing usage events
[0m22:34:51.303555 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:38:59.803076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040e8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295130>]}


============================== 22:38:59.811322 | 96adec01-3613-4bc5-a7f6-139295d37d40 ==============================
[0m22:38:59.811322 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:38:59.812141 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "inventory", "database_name": "modern-sublime-383117", "generate_columns": true}', 'fail_fast': 'False', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'log_cache_events': 'False', 'static_parser': 'True', 'printer_width': '80', 'warn_error': 'None', 'empty': 'None', 'debug': 'False', 'partial_parse': 'True', 'quiet': 'False', 'target_path': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'version_check': 'True', 'log_format': 'default', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:39:03.219480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '96adec01-3613-4bc5-a7f6-139295d37d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624e6960>]}
[0m22:39:03.299575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '96adec01-3613-4bc5-a7f6-139295d37d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162290cb0>]}
[0m22:39:03.300659 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:39:03.756463 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:39:04.174964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:39:04.175689 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/inventory/sources.yml
[0m22:39:04.328874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '96adec01-3613-4bc5-a7f6-139295d37d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106271220>]}
[0m22:39:04.480319 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:39:04.483572 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:39:04.510292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '96adec01-3613-4bc5-a7f6-139295d37d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1633ff770>]}
[0m22:39:04.510881 [info ] [MainThread]: Found 2 models, 4 data tests, 16 sources, 646 macros
[0m22:39:04.511289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '96adec01-3613-4bc5-a7f6-139295d37d40', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163476420>]}
[0m22:39:04.511875 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:39:04.583258 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.inventory.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:39:04.583986 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:39:06.576056 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:e4445b6f-51c7-451d-9abb-7720f2e75278&page=queryresults
[0m22:39:08.541919 [info ] [MainThread]: version: 2

sources:
  - name: inventory
    tables:
      - name: fba
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: date
            data_type: date
          - name: fn_sku
            data_type: string
          - name: condition
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: seller_sku
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: product_name
            data_type: string
          - name: total_quantity
            data_type: int64
          - name: last_updated_time
            data_type: timestamp
          - name: fulfillable_quantity
            data_type: int64
          - name: inbound_shipped_quantity
            data_type: int64
          - name: inbound_working_quantity
            data_type: int64
          - name: inbound_receiving_quantity
            data_type: int64
          - name: unfulfillable_quantity_expired_quantity
            data_type: int64
          - name: reserved_quantity_fc_processing_quantity
            data_type: int64
          - name: reserved_quantity_total_reserved_quantity
            data_type: int64
          - name: unfulfillable_quantity_defective_quantity
            data_type: int64
          - name: researching_quantity_total_researching_quantity
            data_type: int64
          - name: unfulfillable_quantity_carrier_damaged_quantity
            data_type: int64
          - name: reserved_quantity_pending_transshipment_quantity
            data_type: int64
          - name: unfulfillable_quantity_customer_damaged_quantity
            data_type: int64
          - name: reserved_quantity_pending_customer_order_quantity
            data_type: int64
          - name: unfulfillable_quantity_warehouse_damaged_quantity
            data_type: int64
          - name: researching_quantity_researching_quantity_breakdown
            data_type: string
          - name: unfulfillable_quantity_distributor_damaged_quantity
            data_type: int64
          - name: unfulfillable_quantity_total_unfulfillable_quantity
            data_type: int64
          - name: future_supply_quantity_future_supply_buyable_quantity
            data_type: int64
          - name: future_supply_quantity_reserved_future_supply_quantity
            data_type: int64

      - name: fba_planning_inventory
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: asin
            data_type: string
          - name: alert
            data_type: string
          - name: fnsku
            data_type: string
          - name: currency
            data_type: string
          - name: available
            data_type: int64
          - name: condition
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: sales_rank
            data_type: numeric
          - name: updated_at
            data_type: datetime
          - name: your_price
            data_type: numeric
          - name: item_volume
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: sales_price
            data_type: numeric
          - name: product_name
            data_type: string
          - name: sell_through
            data_type: numeric
          - name: storage_type
            data_type: string
          - name: product_group
            data_type: string
          - name: snapshot_date
            data_type: date
          - name: days_of_supply
            data_type: int64
          - name: storage_volume
            data_type: numeric
          - name: inbound_shipped
            data_type: int64
          - name: inbound_working
            data_type: int64
          - name: inbound_quantity
            data_type: int64
          - name: inbound_received
            data_type: int64
          - name: lowest_price_used
            data_type: numeric
          - name: reserved_quantity
            data_type: int64
          - name: units_shipped_t_7
            data_type: numeric
          - name: recommended_action
            data_type: string
          - name: units_shipped_t_30
            data_type: numeric
          - name: units_shipped_t_60
            data_type: numeric
          - name: units_shipped_t_90
            data_type: numeric
          - name: featuredoffer_price
            data_type: numeric
          - name: projected_ltsf_6_mo
            data_type: numeric
          - name: weeks_of_cover_t_30
            data_type: numeric
          - name: weeks_of_cover_t_90
            data_type: numeric
          - name: inv_age_0_to_30_days
            data_type: int64
          - name: inv_age_0_to_90_days
            data_type: int64
          - name: inv_age_31_to_60_days
            data_type: int64
          - name: inv_age_365_plus_days
            data_type: int64
          - name: inv_age_61_to_90_days
            data_type: int64
          - name: no_sale_last_6_months
            data_type: numeric
          - name: inv_age_91_to_180_days
            data_type: int64
          - name: unfulfillable_quantity
            data_type: int64
          - name: healthy_inventory_level
            data_type: numeric
          - name: inv_age_181_to_270_days
            data_type: int64
          - name: inv_age_181_to_330_days
            data_type: int64
          - name: inv_age_271_to_365_days
            data_type: int64
          - name: inv_age_331_to_365_days
            data_type: int64
          - name: recommended_sales_price
            data_type: numeric
          - name: volume_unit_measurement
            data_type: string
          - name: pending_removal_quantity
            data_type: int64
          - name: estimated_excess_quantity
            data_type: int64
          - name: sales_shipped_last_7_days
            data_type: numeric
          - name: estimated_ais_181_210_days
            data_type: numeric
          - name: estimated_ais_211_240_days
            data_type: numeric
          - name: estimated_ais_241_270_days
            data_type: numeric
          - name: estimated_ais_271_300_days
            data_type: numeric
          - name: estimated_ais_301_330_days
            data_type: numeric
          - name: estimated_ais_331_365_days
            data_type: numeric
          - name: estimated_ltsf_next_charge
            data_type: numeric
          - name: sales_shipped_last_30_days
            data_type: numeric
          - name: sales_shipped_last_60_days
            data_type: numeric
          - name: sales_shipped_last_90_days
            data_type: numeric
          - name: estimated_ais_365_plus_days
            data_type: numeric
          - name: qty_to_be_charged_ltsf_6_mo
            data_type: numeric
          - name: qty_to_be_charged_ltsf_12_mo
            data_type: numeric
          - name: recommended_removal_quantity
            data_type: numeric
          - name: lowest_price_new_plus_shipping
            data_type: numeric
          - name: recommended_sale_duration_days
            data_type: numeric
          - name: estimated_storage_cost_next_month
            data_type: numeric
          - name: quantity_to_be_charged_ais_181_210_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_211_240_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_241_270_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_271_300_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_301_330_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_331_365_days
            data_type: numeric
          - name: quantity_to_be_charged_ais_365_plus_days
            data_type: numeric
          - name: estimated_cost_savings_of_recommended_actions
            data_type: numeric

[0m22:39:08.561549 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:39:08.564508 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.861051, "process_in_blocks": "0", "process_kernel_time": 1.13722, "process_mem_max_rss": "370835456", "process_out_blocks": "0", "process_user_time": 4.230032}
[0m22:39:08.565180 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:39:08.565069 after 8.86 seconds
[0m22:39:08.565549 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:39:08.565980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1633ffa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161337230>]}
[0m22:39:08.566373 [debug] [MainThread]: Flushing usage events
[0m22:39:09.121669 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:40:07.570107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c664b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f95400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f95130>]}


============================== 22:40:07.577900 | 02f60e8b-2744-4892-88a0-73599691012a ==============================
[0m22:40:07.577900 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:40:07.578702 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "listings_items", "database_name": "modern-sublime-383117", "generate_columns": true}', 'quiet': 'False', 'introspect': 'True', 'target_path': 'None', 'partial_parse': 'True', 'log_format': 'default', 'static_parser': 'True', 'use_colors': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'empty': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'profiles_dir': '/Users/cherry/.dbt', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'log_cache_events': 'False', 'version_check': 'True', 'indirect_selection': 'eager'}
[0m22:40:10.925051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02f60e8b-2744-4892-88a0-73599691012a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161bc64b0>]}
[0m22:40:11.013303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02f60e8b-2744-4892-88a0-73599691012a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1637010a0>]}
[0m22:40:11.013997 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:40:11.499636 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:40:11.935527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:40:11.936461 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/listings_items/sources.yml
[0m22:40:12.090563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02f60e8b-2744-4892-88a0-73599691012a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ac31d0>]}
[0m22:40:12.241829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:40:12.244944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:40:12.274108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02f60e8b-2744-4892-88a0-73599691012a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ded460>]}
[0m22:40:12.274709 [info ] [MainThread]: Found 2 models, 4 data tests, 18 sources, 646 macros
[0m22:40:12.275287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02f60e8b-2744-4892-88a0-73599691012a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070d6480>]}
[0m22:40:12.276079 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:40:12.355368 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.listings_items.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:40:12.356021 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:40:14.336905 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:87862e90-61e6-42e0-b454-120dca605619&page=queryresults
[0m22:40:17.139412 [info ] [MainThread]: version: 2

sources:
  - name: listings_items
    tables:
      - name: attributes
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: size_value
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: brand_value
            data_type: string
          - name: color_value
            data_type: string
          - name: marketplace
            data_type: string
          - name: material_value
            data_type: string
          - name: item_name_value
            data_type: string
          - name: list_price_value
            data_type: numeric
          - name: model_name_value
            data_type: string
          - name: part_number_value
            data_type: string
          - name: size_language_tag
            data_type: string
          - name: brand_language_tag
            data_type: string
          - name: bullet_point_value
            data_type: string
          - name: color_language_tag
            data_type: string
          - name: manufacturer_value
            data_type: string
          - name: model_number_value
            data_type: string
          - name: list_price_currency
            data_type: string
          - name: size_marketplace_id
            data_type: string
          - name: brand_marketplace_id
            data_type: string
          - name: color_marketplace_id
            data_type: string
          - name: condition_type_value
            data_type: string
          - name: item_type_name_value
            data_type: string
          - name: variation_theme_name
            data_type: string
          - name: generic_keyword_value
            data_type: string
          - name: material_language_tag
            data_type: string
          - name: number_of_boxes_value
            data_type: numeric
          - name: number_of_items_value
            data_type: numeric
          - name: parentage_level_value
            data_type: string
          - name: item_name_language_tag
            data_type: string
          - name: country_of_origin_value
            data_type: string
          - name: item_type_keyword_value
            data_type: string
          - name: material_marketplace_id
            data_type: string
          - name: model_name_language_tag
            data_type: string
          - name: batteries_included_value
            data_type: string
          - name: batteries_required_value
            data_type: string
          - name: item_name_marketplace_id
            data_type: string
          - name: item_package_weight_unit
            data_type: string
          - name: max_order_quantity_value
            data_type: numeric
          - name: bullet_point_language_tag
            data_type: string
          - name: included_components_value
            data_type: string
          - name: item_package_weight_value
            data_type: numeric
          - name: list_price_marketplace_id
            data_type: string
          - name: manufacturer_language_tag
            data_type: string
          - name: model_name_marketplace_id
            data_type: string
          - name: product_description_value
            data_type: string
          - name: part_number_marketplace_id
            data_type: string
          - name: purchasable_offer_currency
            data_type: string
          - name: warranty_description_value
            data_type: string
          - name: bullet_point_marketplace_id
            data_type: string
          - name: item_type_name_language_tag
            data_type: string
          - name: manufacturer_marketplace_id
            data_type: string
          - name: model_number_marketplace_id
            data_type: string
          - name: purchasable_offer_our_price
            data_type: string
          - name: generic_keyword_language_tag
            data_type: string
          - name: condition_type_marketplace_id
            data_type: string
          - name: item_type_name_marketplace_id
            data_type: string
          - name: merchant_shipping_group_value
            data_type: string
          - name: merchant_suggested_asin_value
            data_type: string
          - name: contains_liquid_contents_value
            data_type: string
          - name: generic_keyword_marketplace_id
            data_type: string
          - name: number_of_boxes_marketplace_id
            data_type: string
          - name: number_of_items_marketplace_id
            data_type: string
          - name: parentage_level_marketplace_id
            data_type: string
          - name: purchasable_offer_end_at_value
            data_type: string
          - name: recommended_browse_nodes_value
            data_type: numeric
          - name: variation_theme_marketplace_id
            data_type: string
          - name: country_of_origin_marketplace_id
            data_type: string
          - name: cpsia_cautionary_statement_value
            data_type: string
          - name: included_components_language_tag
            data_type: string
          - name: item_type_keyword_marketplace_id
            data_type: string
          - name: product_description_language_tag
            data_type: string
          - name: purchasable_offer_marketplace_id
            data_type: string
          - name: purchasable_offer_start_at_value
            data_type: string
          - name: batteries_included_marketplace_id
            data_type: string
          - name: batteries_required_marketplace_id
            data_type: string
          - name: fulfillment_availability_quantity
            data_type: numeric
          - name: max_order_quantity_marketplace_id
            data_type: string
          - name: warranty_description_language_tag
            data_type: string
          - name: included_components_marketplace_id
            data_type: string
          - name: item_package_dimensions_width_unit
            data_type: string
          - name: item_package_weight_marketplace_id
            data_type: string
          - name: product_description_marketplace_id
            data_type: string
          - name: item_package_dimensions_height_unit
            data_type: string
          - name: item_package_dimensions_length_unit
            data_type: string
          - name: item_package_dimensions_width_value
            data_type: numeric
          - name: warranty_description_marketplace_id
            data_type: string
          - name: item_package_dimensions_height_value
            data_type: numeric
          - name: item_package_dimensions_length_value
            data_type: numeric
          - name: item_package_dimensions_marketplace_id
            data_type: string
          - name: merchant_shipping_group_marketplace_id
            data_type: string
          - name: merchant_suggested_asin_marketplace_id
            data_type: string
          - name: contains_liquid_contents_marketplace_id
            data_type: string
          - name: fulfillment_availability_marketplace_id
            data_type: string
          - name: recommended_browse_nodes_marketplace_id
            data_type: string
          - name: child_parent_sku_relationship_parent_sku
            data_type: string
          - name: supplier_declared_dg_hz_regulation_value
            data_type: string
          - name: cpsia_cautionary_statement_marketplace_id
            data_type: string
          - name: main_product_image_locator_marketplace_id
            data_type: string
          - name: main_product_image_locator_media_location
            data_type: string
          - name: externally_assigned_product_identifier_type
            data_type: string
          - name: swatch_product_image_locator_marketplace_id
            data_type: string
          - name: swatch_product_image_locator_media_location
            data_type: string
          - name: child_parent_sku_relationship_marketplace_id
            data_type: string
          - name: externally_assigned_product_identifier_value
            data_type: numeric
          - name: other_product_image_locator_1_marketplace_id
            data_type: string
          - name: other_product_image_locator_1_media_location
            data_type: string
          - name: other_product_image_locator_2_marketplace_id
            data_type: string
          - name: other_product_image_locator_2_media_location
            data_type: string
          - name: other_product_image_locator_3_marketplace_id
            data_type: string
          - name: other_product_image_locator_3_media_location
            data_type: string
          - name: other_product_image_locator_4_marketplace_id
            data_type: string
          - name: other_product_image_locator_4_media_location
            data_type: string
          - name: other_product_image_locator_5_marketplace_id
            data_type: string
          - name: other_product_image_locator_5_media_location
            data_type: string
          - name: other_product_image_locator_6_marketplace_id
            data_type: string
          - name: other_product_image_locator_6_media_location
            data_type: string
          - name: other_product_image_locator_7_marketplace_id
            data_type: string
          - name: other_product_image_locator_7_media_location
            data_type: string
          - name: required_product_compliance_certificate_value
            data_type: string
          - name: fulfillment_availability_fulfillment_channel_code
            data_type: string
          - name: supplier_declared_dg_hz_regulation_marketplace_id
            data_type: string
          - name: child_parent_sku_relationship_child_relationship_type
            data_type: string
          - name: externally_assigned_product_identifier_marketplace_id
            data_type: string
          - name: required_product_compliance_certificate_marketplace_id
            data_type: string

      - name: fulfillment_availability
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: fulfillment_channel_code
            data_type: string

      - name: issues
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: code
            data_type: int64
          - name: date
            data_type: date
          - name: message
            data_type: string
          - name: severity
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: attribute_names
            data_type: json

      - name: offers
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: offer_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: price_amount
            data_type: numeric
          - name: marketplace_id
            data_type: string
          - name: price_currency
            data_type: string
          - name: price_currency_code
            data_type: string

      - name: summaries
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: asin
            data_type: string
          - name: date
            data_type: date
          - name: fn_sku
            data_type: string
          - name: status
            data_type: json
          - name: item_name
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: created_date
            data_type: timestamp
          - name: product_type
            data_type: string
          - name: condition_type
            data_type: string
          - name: marketplace_id
            data_type: string
          - name: main_image_link
            data_type: string
          - name: main_image_width
            data_type: numeric
          - name: last_updated_date
            data_type: timestamp
          - name: main_image_height
            data_type: numeric

[0m22:40:17.159326 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:40:17.162292 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 9.686116, "process_in_blocks": "0", "process_kernel_time": 1.133749, "process_mem_max_rss": "371736576", "process_out_blocks": "0", "process_user_time": 4.278465}
[0m22:40:17.163398 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:40:17.163270 after 9.69 seconds
[0m22:40:17.163821 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:40:17.164782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f94c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1658f3c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165a420c0>]}
[0m22:40:17.165385 [debug] [MainThread]: Flushing usage events
[0m22:40:17.647487 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:41:28.723881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10937bb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096c95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c951c0>]}


============================== 22:41:28.731511 | 21ee657b-e169-4cce-91ad-89f7df529830 ==============================
[0m22:41:28.731511 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:41:28.732205 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'warn_error': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'target_path': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_colors': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'static_parser': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'no_print': 'None', 'debug': 'False', 'partial_parse': 'True', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "orders", "database_name": "modern-sublime-383117", "generate_columns": true}', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True'}
[0m22:41:32.073916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ee657b-e169-4cce-91ad-89f7df529830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1389043b0>]}
[0m22:41:32.158652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ee657b-e169-4cce-91ad-89f7df529830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109290cb0>]}
[0m22:41:32.159561 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:41:32.602128 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:41:33.009270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:41:33.009946 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/orders/sources.yml
[0m22:41:33.160695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ee657b-e169-4cce-91ad-89f7df529830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x138b686b0>]}
[0m22:41:33.329409 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:41:33.332748 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:41:33.360643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ee657b-e169-4cce-91ad-89f7df529830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a0a3410>]}
[0m22:41:33.361336 [info ] [MainThread]: Found 2 models, 4 data tests, 23 sources, 646 macros
[0m22:41:33.361707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ee657b-e169-4cce-91ad-89f7df529830', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a0b1c70>]}
[0m22:41:33.363012 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:41:33.439256 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.orders.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:41:33.439784 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:41:35.392628 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:d1a2da9e-fded-4a02-b3e4-2fb5e04a9ed6&page=queryresults
[0m22:41:37.943709 [info ] [MainThread]: version: 2

sources:
  - name: orders
    tables:
      - name: amazon_order_items
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: title
            data_type: string
          - name: is_gift
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: seller_sku
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: order_item_id
            data_type: int64
          - name: promotion_ids
            data_type: string
          - name: amazon_order_id
            data_type: string
          - name: is_transparency
            data_type: boolean
          - name: item_tax_amount
            data_type: numeric
          - name: quantity_ordered
            data_type: int64
          - name: quantity_shipped
            data_type: int64
          - name: item_price_amount
            data_type: numeric
          - name: shipping_tax_amount
            data_type: numeric
          - name: tax_collection_model
            data_type: string
          - name: shipping_price_amount
            data_type: numeric
          - name: item_tax_currency_code
            data_type: string
          - name: item_price_currency_code
            data_type: string
          - name: shipping_discount_amount
            data_type: numeric
          - name: promotion_discount_amount
            data_type: numeric
          - name: shipping_tax_currency_code
            data_type: string
          - name: product_info_number_of_items
            data_type: int64
          - name: shipping_discount_tax_amount
            data_type: numeric
          - name: shipping_price_currency_code
            data_type: string
          - name: promotion_discount_tax_amount
            data_type: numeric
          - name: buyer_info_gift_wrap_tax_amount
            data_type: numeric
          - name: shipping_discount_currency_code
            data_type: string
          - name: promotion_discount_currency_code
            data_type: string
          - name: tax_collection_responsible_party
            data_type: string
          - name: buyer_info_gift_wrap_price_amount
            data_type: numeric
          - name: shipping_discount_tax_currency_code
            data_type: string
          - name: promotion_discount_tax_currency_code
            data_type: string
          - name: buyer_info_gift_wrap_tax_currency_code
            data_type: string
          - name: buyer_info_gift_wrap_price_currency_code
            data_type: string

      - name: amazon_order_items_detailed_view
        columns:
          - name: amazon_order_id
            data_type: string
          - name: order_item_id
            data_type: int64
          - name: purchase_datetime
            data_type: timestamp
          - name: purchase_date
            data_type: date
          - name: marketplace
            data_type: string
          - name: sales_channel
            data_type: string
          - name: asin
            data_type: string
          - name: seller_sku
            data_type: string
          - name: order_status
            data_type: string
          - name: quantity_ordered
            data_type: int64
          - name: promotion_ids
            data_type: string
          - name: product_info_number_of_items
            data_type: int64
          - name: item_price_currency_code
            data_type: string
          - name: item_price_amount
            data_type: numeric
          - name: item_tax_amount
            data_type: numeric
          - name: promotion_discount_tax_currency_code
            data_type: string
          - name: output_vat
            data_type: numeric
          - name: item_tax_currency_code
            data_type: string
          - name: promotion_discount_tax_amount
            data_type: numeric
          - name: promotion_discount_currency_code
            data_type: string
          - name: promotion_discount_amount
            data_type: numeric
          - name: coupon_fee
            data_type: numeric
          - name: tax_collection_model
            data_type: string
          - name: tax_collection_responsible_party
            data_type: string
          - name: is_prime
            data_type: boolean
          - name: is_replacement_order
            data_type: boolean
          - name: replaced_order_id
            data_type: string
          - name: is_gift
            data_type: string
          - name: is_vine
            data_type: boolean
          - name: tenant_id
            data_type: int64

      - name: amazon_orders
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: is_ispu
            data_type: boolean
          - name: is_prime
            data_type: boolean
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: order_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: order_status
            data_type: string
          - name: is_sold_by_ab
            data_type: boolean
          - name: purchase_date
            data_type: timestamp
          - name: sales_channel
            data_type: string
          - name: marketplace_id
            data_type: string
          - name: payment_method
            data_type: string
          - name: amazon_order_id
            data_type: string
          - name: seller_order_id
            data_type: string
          - name: is_premium_order
            data_type: boolean
          - name: last_update_date
            data_type: timestamp
          - name: latest_ship_date
            data_type: timestamp
          - name: is_business_order
            data_type: boolean
          - name: replaced_order_id
            data_type: string
          - name: earliest_ship_date
            data_type: timestamp
          - name: order_total_amount
            data_type: numeric
          - name: ship_service_level
            data_type: string
          - name: fulfillment_channel
            data_type: string
          - name: has_regulated_items
            data_type: boolean
          - name: is_replacement_order
            data_type: boolean
          - name: is_access_point_order
            data_type: boolean
          - name: shipping_address_city
            data_type: string
          - name: buyer_info_buyer_email
            data_type: string
          - name: payment_method_details
            data_type: string
          - name: number_of_items_shipped
            data_type: int64
          - name: is_global_express_enabled
            data_type: boolean
          - name: number_of_items_unshipped
            data_type: int64
          - name: order_total_currency_code
            data_type: string
          - name: shipping_address_postal_code
            data_type: string
          - name: shipping_address_country_code
            data_type: string
          - name: shipment_service_level_category
            data_type: string
          - name: shipping_address_state_or_region
            data_type: string

      - name: amazon_orders_summary_view
        columns:
          - name: purchase_date
            data_type: date
          - name: marketplace
            data_type: string
          - name: order_status
            data_type: string
          - name: asin
            data_type: string
          - name: seller_sku
            data_type: string
          - name: product_code
            data_type: string
          - name: quantity_ordered
            data_type: int64
          - name: net_item_price_per_unit
            data_type: numeric
          - name: item_price_amount
            data_type: numeric
          - name: promotion_discount_amount
            data_type: numeric
          - name: item_tax_amount
            data_type: numeric
          - name: output_vat
            data_type: numeric
          - name: net_item_price_amount
            data_type: numeric
          - name: referral_fees
            data_type: numeric
          - name: coupon_fee
            data_type: numeric
          - name: item_price_currency_code
            data_type: string
          - name: is_vine
            data_type: boolean
          - name: is_replacement_order
            data_type: boolean
          - name: tenant_id
            data_type: int64

[0m22:41:37.963312 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:41:37.967078 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 9.334774, "process_in_blocks": "0", "process_kernel_time": 1.120793, "process_mem_max_rss": "372834304", "process_out_blocks": "0", "process_user_time": 4.222123}
[0m22:41:37.967723 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:41:37.967549 after 9.34 seconds
[0m22:41:37.968102 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:41:37.968612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098c1e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a0a3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1389c1820>]}
[0m22:41:37.969129 [debug] [MainThread]: Flushing usage events
[0m22:41:38.435187 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:49:14.133029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10503d280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a0b00>]}


============================== 22:49:14.140257 | c994f464-fd80-4f66-b243-0bf5c352406e ==============================
[0m22:49:14.140257 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:49:14.140998 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "product_pricing", "database_name": "modern-sublime-383117", "generate_columns": true}', 'static_parser': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'use_colors': 'True', 'partial_parse': 'True', 'no_print': 'None', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'empty': 'None', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'log_format': 'default', 'debug': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'printer_width': '80'}
[0m22:49:17.498922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c994f464-fd80-4f66-b243-0bf5c352406e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163bb9d60>]}
[0m22:49:17.581923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c994f464-fd80-4f66-b243-0bf5c352406e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1629f9070>]}
[0m22:49:17.582803 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:49:17.993153 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:49:18.432724 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:49:18.433700 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/product_pricing/sources.yml
[0m22:49:18.588057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c994f464-fd80-4f66-b243-0bf5c352406e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163c7d640>]}
[0m22:49:18.758545 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:49:18.761847 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:49:18.793128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c994f464-fd80-4f66-b243-0bf5c352406e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163ea1400>]}
[0m22:49:18.793727 [info ] [MainThread]: Found 2 models, 4 data tests, 27 sources, 646 macros
[0m22:49:18.794326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c994f464-fd80-4f66-b243-0bf5c352406e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161937920>]}
[0m22:49:18.794987 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:49:18.858984 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.product_pricing.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:49:18.859935 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:49:20.925972 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:9a5c9bdf-f4ac-47dd-8dbf-485cedbcf9d3&page=queryresults
[0m22:49:22.104405 [info ] [MainThread]: version: 2

sources:
  - name: product_pricing
    tables:
      - name: competitive_pricing
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: date
            data_type: date
          - name: status
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: customer_type
            data_type: string
          - name: product_sales_rankings
            data_type: string
          - name: product_identifiers_marketplace_asin_asin
            data_type: string
          - name: product_competitive_pricing_competitive_prices
            data_type: string
          - name: product_identifiers_marketplace_asin_marketplace_id
            data_type: string
          - name: product_competitive_pricing_number_of_offer_listings
            data_type: string

[0m22:49:22.121428 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:49:22.124911 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.092931, "process_in_blocks": "0", "process_kernel_time": 1.118948, "process_mem_max_rss": "379666432", "process_out_blocks": "0", "process_user_time": 4.19086}
[0m22:49:22.125756 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:49:22.125564 after 8.09 seconds
[0m22:49:22.126787 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:49:22.127490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082a1130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163ea2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165c2a1e0>]}
[0m22:49:22.128019 [debug] [MainThread]: Flushing usage events
[0m22:49:22.670961 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:50:57.783326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fa7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198954f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1198951f0>]}


============================== 22:50:57.790082 | 1925104b-81e9-479d-8e19-4c85c9fc0661 ==============================
[0m22:50:57.790082 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:50:57.790968 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'empty': 'None', 'no_print': 'None', 'static_parser': 'True', 'version_check': 'True', 'printer_width': '80', 'use_colors': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'log_format': 'default', 'warn_error': 'None', 'fail_fast': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'target_path': 'None', 'partial_parse': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "public", "database_name": "modern-sublime-383117", "generate_columns": true}', 'send_anonymous_usage_stats': 'True'}
[0m22:51:01.279694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1925104b-81e9-479d-8e19-4c85c9fc0661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165300ad0>]}
[0m22:51:01.362265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1925104b-81e9-479d-8e19-4c85c9fc0661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164f2b200>]}
[0m22:51:01.363544 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:51:01.793777 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:51:02.234567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:51:02.235465 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/public/sources.yml
[0m22:51:02.431554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1925104b-81e9-479d-8e19-4c85c9fc0661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1653caab0>]}
[0m22:51:02.648081 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:51:02.651249 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:51:02.683550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1925104b-81e9-479d-8e19-4c85c9fc0661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166b55760>]}
[0m22:51:02.684585 [info ] [MainThread]: Found 2 models, 4 data tests, 28 sources, 646 macros
[0m22:51:02.685218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1925104b-81e9-479d-8e19-4c85c9fc0661', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f568d0>]}
[0m22:51:02.686408 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:51:02.764434 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.public.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:51:02.765294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:51:05.221641 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:2b37cd8c-39fb-408a-808a-289687432a52&page=queryresults
[0m22:51:07.629373 [info ] [MainThread]: version: 2

sources:
  - name: public
    tables:
      - name: amazon_advertising_portfolios
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: in_budget
            data_type: boolean
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: creation_date
            data_type: datetime
          - name: serving_status
            data_type: string
          - name: last_updated_date
            data_type: datetime

      - name: amazon_marketplaces
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: active
            data_type: boolean
          - name: region
            data_type: string
          - name: endpoint
            data_type: string
          - name: marketplace_id
            data_type: string
          - name: marketplace_name
            data_type: string

      - name: category_benchmark
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: brand
            data_type: string
          - name: category
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: string
          - name: click_thru_rate
            data_type: string
          - name: peer_ctr_median
            data_type: string
          - name: peer_ctr_top_25
            data_type: string
          - name: peer_acos_median
            data_type: string
          - name: peer_acos_top_25
            data_type: string
          - name: peer_roas_median
            data_type: string
          - name: peer_roas_top_25
            data_type: string
          - name: peer_ctr_bottom_25
            data_type: string
          - name: peer_acos_bottom_25
            data_type: string
          - name: peer_roas_bottom_25
            data_type: string
          - name: peer_impressions_median
            data_type: string
          - name: peer_impressions_top_25
            data_type: string
          - name: peer_impressions_bottom_25
            data_type: string
          - name: total_advertising_cost_of_sales
            data_type: string
          - name: total_return_on_advertising_spend
            data_type: string

      - name: tenants
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: company
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime

[0m22:51:07.651493 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:51:07.655969 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 9.965218, "process_in_blocks": "0", "process_kernel_time": 1.164968, "process_mem_max_rss": "372703232", "process_out_blocks": "0", "process_user_time": 4.310213}
[0m22:51:07.656705 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:51:07.656508 after 9.97 seconds
[0m22:51:07.657201 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:51:07.657577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fa7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166b55910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11939f440>]}
[0m22:51:07.658116 [debug] [MainThread]: Flushing usage events
[0m22:51:08.175133 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:53:14.791852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ad700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e535c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062a1070>]}


============================== 22:53:14.799441 | 36bcd3e5-b534-4c7d-8d3c-1293713620a2 ==============================
[0m22:53:14.799441 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:53:14.800364 [debug] [MainThread]: running dbt with arguments {'empty': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "rankings", "database_name": "modern-sublime-383117", "generate_columns": true}', 'quiet': 'False', 'introspect': 'True', 'log_format': 'default', 'partial_parse': 'True', 'target_path': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'static_parser': 'True', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_experimental_parser': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'fail_fast': 'False', 'debug': 'False', 'printer_width': '80', 'version_check': 'True'}
[0m22:53:18.164376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36bcd3e5-b534-4c7d-8d3c-1293713620a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162202090>]}
[0m22:53:18.248059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36bcd3e5-b534-4c7d-8d3c-1293713620a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160add070>]}
[0m22:53:18.248973 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:53:18.691834 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:53:19.124575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:53:19.125293 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/rankings/sources.yml
[0m22:53:19.280518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36bcd3e5-b534-4c7d-8d3c-1293713620a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162500890>]}
[0m22:53:19.459006 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:53:19.462666 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:53:19.494673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36bcd3e5-b534-4c7d-8d3c-1293713620a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163e034d0>]}
[0m22:53:19.495287 [info ] [MainThread]: Found 2 models, 4 data tests, 32 sources, 646 macros
[0m22:53:19.496103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36bcd3e5-b534-4c7d-8d3c-1293713620a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163f2e030>]}
[0m22:53:19.497035 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:53:19.564610 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.rankings.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:53:19.565788 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:21.603047 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:05805061-23d8-4861-8b62-15a2ba60bb97&page=queryresults
[0m22:53:23.247668 [info ] [MainThread]: version: 2

sources:
  - name: rankings
    tables:
      - name: h10_keyword_search_volume
        columns:
          - name: date_added
            data_type: date
          - name: marketplace_id
            data_type: string
          - name: keyword
            data_type: string
          - name: search_volume
            data_type: numeric

      - name: h10_keyword_tracker
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: asin
            data_type: string
          - name: title
            data_type: string
          - name: keyword
            data_type: string
          - name: created_at
            data_type: datetime
          - name: date_added
            data_type: timestamp
          - name: updated_at
            data_type: datetime
          - name: marketplace
            data_type: string
          - name: organic_rank
            data_type: int64
          - name: search_volume
            data_type: numeric
          - name: marketplace_id
            data_type: string
          - name: sponsored_position
            data_type: numeric

[0m22:53:23.264561 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:53:23.268187 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.569613, "process_in_blocks": "0", "process_kernel_time": 1.121012, "process_mem_max_rss": "378421248", "process_out_blocks": "0", "process_user_time": 4.223978}
[0m22:53:23.269522 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:53:23.269316 after 8.57 seconds
[0m22:53:23.269974 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:53:23.270405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ad700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163e03710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163f2ffb0>]}
[0m22:53:23.271002 [debug] [MainThread]: Flushing usage events
[0m22:53:23.761368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:07.482598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10771b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea1100>]}


============================== 22:54:07.492237 | cd4407c9-8400-45ff-a9b7-6632d8f25485 ==============================
[0m22:54:07.492237 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:54:07.493450 [debug] [MainThread]: running dbt with arguments {'write_json': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_colors': 'True', 'warn_error': 'None', 'fail_fast': 'False', 'empty': 'None', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "sponsored_brands", "database_name": "modern-sublime-383117", "generate_columns": true}', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'profiles_dir': '/Users/cherry/.dbt', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'debug': 'False'}
[0m22:54:11.042360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd4407c9-8400-45ff-a9b7-6632d8f25485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051466f0>]}
[0m22:54:11.121767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd4407c9-8400-45ff-a9b7-6632d8f25485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162f067e0>]}
[0m22:54:11.122811 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:54:11.655436 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:54:12.082585 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:54:12.083375 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/sponsored_brands/sources.yml
[0m22:54:12.240596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd4407c9-8400-45ff-a9b7-6632d8f25485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16442e120>]}
[0m22:54:12.409894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:54:12.413927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:54:12.445773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd4407c9-8400-45ff-a9b7-6632d8f25485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165066c90>]}
[0m22:54:12.446380 [info ] [MainThread]: Found 2 models, 4 data tests, 34 sources, 646 macros
[0m22:54:12.446779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd4407c9-8400-45ff-a9b7-6632d8f25485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164455940>]}
[0m22:54:12.447294 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:54:12.512752 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.sponsored_brands.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:54:12.513919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:14.447926 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:966f3cba-4698-4490-b9e8-c045133bcb44&page=queryresults
[0m22:54:19.789736 [info ] [MainThread]: version: 2

sources:
  - name: sponsored_brands
    tables:
      - name: ad
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: int64
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: ad_status
            data_type: string
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: top_of_search_impression_share
            data_type: numeric
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign_console
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: _5_second_views
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: portfolio_name
            data_type: string
          - name: click_thru_rate
            data_type: numeric
          - name: view_through_rate
            data_type: numeric
          - name: _14_day_total_sales
            data_type: numeric
          - name: _14_day_total_units
            data_type: int64
          - name: _5_second_view_rate
            data_type: numeric
          - name: _14_day_total_orders
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: _14_day_conversion_rate
            data_type: numeric
          - name: _14_day_branded_searches
            data_type: numeric
          - name: _14_day_detail_page_views
            data_type: numeric
          - name: _14_day_new_to_brand_sales
            data_type: numeric
          - name: _14_day_new_to_brand_units
            data_type: numeric
          - name: _14_day_new_to_brand_orders
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: _14_day_of_sales_new_to_brand
            data_type: numeric
          - name: _14_day_of_units_new_to_brand
            data_type: numeric
          - name: click_through_rate_for_views
            data_type: numeric
          - name: _14_day_of_orders_new_to_brand
            data_type: numeric
          - name: _14_day_new_to_brand_order_rate
            data_type: numeric
          - name: total_advertising_cost_of_sales
            data_type: numeric
          - name: total_return_on_advertising_spend
            data_type: numeric

      - name: campaign_placement
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: placement_classification
            data_type: string
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign_placement_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: vctr
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: dpv_14d
            data_type: int64
          - name: currency
            data_type: string
          - name: placement
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: attributed_sales_14d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: int64
          - name: attributed_conversions_14d_same_sku
            data_type: int64
          - name: attributed_order_rate_new_to_brand_14d
            data_type: numeric
          - name: attributed_detail_page_views_clicks_14d
            data_type: int64
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_percentage_14d
            data_type: numeric

      - name: campaign_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: vctr
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: dpv_14d
            data_type: int64
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: attributed_sales_14d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: top_of_search_impression_share
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: int64
          - name: attributed_conversions_14d_same_sku
            data_type: int64
          - name: attributed_order_rate_new_to_brand_14d
            data_type: numeric
          - name: attributed_detail_page_views_clicks_14d
            data_type: int64
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_percentage_14d
            data_type: numeric

      - name: campaigns
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: budget
            data_type: numeric
          - name: outcome
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: budget_type
            data_type: string
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: brand_entity_id
            data_type: string
          - name: bidding_bid_optimization
            data_type: boolean
          - name: is_multi_ad_groups_enabled
            data_type: boolean
          - name: bidding_bid_optimization_strategy
            data_type: string

      - name: gross_and_invalid_traffic
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_status
            data_type: string
          - name: gross_impressions
            data_type: int64
          - name: invalid_impressions
            data_type: int64
          - name: gross_click_throughs
            data_type: int64
          - name: invalid_click_throughs
            data_type: int64
          - name: invalid_impression_rate
            data_type: numeric
          - name: invalid_click_through_rate
            data_type: numeric

      - name: portfolio_performance_summary_view
        columns:
          - name: date
            data_type: date
          - name: marketplace
            data_type: string
          - name: portfolio_name
            data_type: string
          - name: product_code
            data_type: string
          - name: currency
            data_type: string
          - name: cost
            data_type: numeric
          - name: units_sold
            data_type: int64
          - name: clicks
            data_type: int64
          - name: impressions
            data_type: int64
          - name: sales
            data_type: numeric

      - name: purchased_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: sales_14d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: orders_14d
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: product_name
            data_type: string
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchased_asin
            data_type: string
          - name: units_sold_14d
            data_type: int64
          - name: attribution_type
            data_type: string
          - name: product_category
            data_type: string
          - name: new_to_brand_sales_14d
            data_type: numeric
          - name: new_to_brand_purchases_14d
            data_type: int64
          - name: new_to_brand_units_sold_14d
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_sales_percentage_14d
            data_type: numeric
          - name: new_to_brand_purchases_percentage_14d
            data_type: numeric
          - name: new_to_brand_units_sold_percentage_14d
            data_type: numeric

      - name: search_term
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: search_term
            data_type: string
          - name: keyword_text
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: ad_keyword_status
            data_type: string
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: view_click_through_rate
            data_type: numeric
          - name: video_5_second_view_rate
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string

      - name: targeting
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: keyword_text
            data_type: string
          - name: keyword_type
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: sales_promoted
            data_type: numeric
          - name: targeting_text
            data_type: string
          - name: targeting_type
            data_type: string
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: detail_page_views
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: targeting_expression
            data_type: string
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: top_of_search_impression_share
            data_type: numeric
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

[0m22:54:19.813945 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:54:19.817738 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 12.42777, "process_in_blocks": "0", "process_kernel_time": 1.181393, "process_mem_max_rss": "367919104", "process_out_blocks": "0", "process_user_time": 4.452895}
[0m22:54:19.818840 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:54:19.818634 after 12.43 seconds
[0m22:54:19.819523 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:54:19.820069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ea1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165066e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1647e5880>]}
[0m22:54:19.821032 [debug] [MainThread]: Flushing usage events
[0m22:54:20.282955 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:56:30.498835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108416930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa11f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa0f80>]}


============================== 22:56:30.506029 | 45d93fb4-539d-41cc-91e6-08966fd84a31 ==============================
[0m22:56:30.506029 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:56:30.506883 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'use_colors': 'True', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'partial_parse': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "sponsored_brands", "database_name": "modern-sublime-383117", "generate_columns": true}', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'version_check': 'True', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'empty': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'cache_selected_only': 'False', 'printer_width': '80', 'static_parser': 'True'}
[0m22:56:33.854013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '45d93fb4-539d-41cc-91e6-08966fd84a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb95e20>]}
[0m22:56:33.930669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '45d93fb4-539d-41cc-91e6-08966fd84a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dab3980>]}
[0m22:56:33.932014 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:56:34.381955 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:56:34.806460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:56:34.806789 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:56:34.875230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45d93fb4-539d-41cc-91e6-08966fd84a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee59a90>]}
[0m22:56:35.057127 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:56:35.060371 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:56:35.092988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45d93fb4-539d-41cc-91e6-08966fd84a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14837a780>]}
[0m22:56:35.093623 [info ] [MainThread]: Found 2 models, 4 data tests, 34 sources, 646 macros
[0m22:56:35.094377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45d93fb4-539d-41cc-91e6-08966fd84a31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1483d1880>]}
[0m22:56:35.095268 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:56:35.171613 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.sponsored_brands.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:56:35.172589 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:56:37.209117 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:b87953a2-d88e-415c-b16f-d3550b9671b4&page=queryresults
[0m22:56:42.650523 [info ] [MainThread]: version: 2

sources:
  - name: sponsored_brands
    tables:
      - name: ad
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: int64
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: ad_status
            data_type: string
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: top_of_search_impression_share
            data_type: numeric
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign_console
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: _5_second_views
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: portfolio_name
            data_type: string
          - name: click_thru_rate
            data_type: numeric
          - name: view_through_rate
            data_type: numeric
          - name: _14_day_total_sales
            data_type: numeric
          - name: _14_day_total_units
            data_type: int64
          - name: _5_second_view_rate
            data_type: numeric
          - name: _14_day_total_orders
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: _14_day_conversion_rate
            data_type: numeric
          - name: _14_day_branded_searches
            data_type: numeric
          - name: _14_day_detail_page_views
            data_type: numeric
          - name: _14_day_new_to_brand_sales
            data_type: numeric
          - name: _14_day_new_to_brand_units
            data_type: numeric
          - name: _14_day_new_to_brand_orders
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: _14_day_of_sales_new_to_brand
            data_type: numeric
          - name: _14_day_of_units_new_to_brand
            data_type: numeric
          - name: click_through_rate_for_views
            data_type: numeric
          - name: _14_day_of_orders_new_to_brand
            data_type: numeric
          - name: _14_day_new_to_brand_order_rate
            data_type: numeric
          - name: total_advertising_cost_of_sales
            data_type: numeric
          - name: total_return_on_advertising_spend
            data_type: numeric

      - name: campaign_placement
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: sales_promoted
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: detail_page_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: placement_classification
            data_type: string
          - name: video_5_second_view_rate
            data_type: numeric
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

      - name: campaign_placement_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: vctr
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: dpv_14d
            data_type: int64
          - name: currency
            data_type: string
          - name: placement
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: attributed_sales_14d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: int64
          - name: attributed_conversions_14d_same_sku
            data_type: int64
          - name: attributed_order_rate_new_to_brand_14d
            data_type: numeric
          - name: attributed_detail_page_views_clicks_14d
            data_type: int64
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_percentage_14d
            data_type: numeric

      - name: campaign_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: vctr
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: dpv_14d
            data_type: int64
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: attributed_sales_14d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: video_5_second_view_rate
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: top_of_search_impression_share
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: int64
          - name: attributed_conversions_14d_same_sku
            data_type: int64
          - name: attributed_order_rate_new_to_brand_14d
            data_type: numeric
          - name: attributed_detail_page_views_clicks_14d
            data_type: int64
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: int64
          - name: attributed_sales_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_orders_new_to_brand_percentage_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_percentage_14d
            data_type: numeric

      - name: campaigns
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: budget
            data_type: numeric
          - name: outcome
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: budget_type
            data_type: string
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: brand_entity_id
            data_type: string
          - name: bidding_bid_optimization
            data_type: boolean
          - name: is_multi_ad_groups_enabled
            data_type: boolean
          - name: bidding_bid_optimization_strategy
            data_type: string

      - name: gross_and_invalid_traffic
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_status
            data_type: string
          - name: gross_impressions
            data_type: int64
          - name: invalid_impressions
            data_type: int64
          - name: gross_click_throughs
            data_type: int64
          - name: invalid_click_throughs
            data_type: int64
          - name: invalid_impression_rate
            data_type: numeric
          - name: invalid_click_through_rate
            data_type: numeric

      - name: portfolio_performance_summary_view
        columns:
          - name: date
            data_type: date
          - name: marketplace
            data_type: string
          - name: portfolio_name
            data_type: string
          - name: product_code
            data_type: string
          - name: currency
            data_type: string
          - name: cost
            data_type: numeric
          - name: units_sold
            data_type: int64
          - name: clicks
            data_type: int64
          - name: impressions
            data_type: int64
          - name: sales
            data_type: numeric

      - name: purchased_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: sales_14d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: orders_14d
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: product_name
            data_type: string
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchased_asin
            data_type: string
          - name: units_sold_14d
            data_type: int64
          - name: attribution_type
            data_type: string
          - name: product_category
            data_type: string
          - name: new_to_brand_sales_14d
            data_type: numeric
          - name: new_to_brand_purchases_14d
            data_type: int64
          - name: new_to_brand_units_sold_14d
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_sales_percentage_14d
            data_type: numeric
          - name: new_to_brand_purchases_percentage_14d
            data_type: numeric
          - name: new_to_brand_units_sold_percentage_14d
            data_type: numeric

      - name: search_term
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: search_term
            data_type: string
          - name: keyword_text
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: ad_keyword_status
            data_type: string
          - name: campaign_budget_type
            data_type: string
          - name: video_5_second_views
            data_type: int64
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: view_click_through_rate
            data_type: numeric
          - name: video_5_second_view_rate
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string

      - name: targeting
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: keyword_text
            data_type: string
          - name: keyword_type
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: sales_promoted
            data_type: numeric
          - name: targeting_text
            data_type: string
          - name: targeting_type
            data_type: string
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: detail_page_views
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: purchases_promoted
            data_type: int64
          - name: campaign_budget_type
            data_type: string
          - name: targeting_expression
            data_type: string
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: new_to_brand_purchases_rate
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_sales_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: top_of_search_impression_share
            data_type: numeric
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_purchases_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_units_sold_percentage
            data_type: numeric
          - name: new_to_brand_detail_page_views_clicks
            data_type: int64

[0m22:56:42.668325 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:56:42.671102 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 12.266753, "process_in_blocks": "0", "process_kernel_time": 1.111697, "process_mem_max_rss": "368345088", "process_out_blocks": "0", "process_user_time": 4.273238}
[0m22:56:42.671782 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:56:42.671633 after 12.27 seconds
[0m22:56:42.672230 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:56:42.672794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109aa1040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14837a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a1e390>]}
[0m22:56:42.673244 [debug] [MainThread]: Flushing usage events
[0m22:56:43.268987 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:58:30.352217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ad22a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105495220>]}


============================== 22:58:30.359567 | 1f931478-4698-45f5-a304-d50885575a23 ==============================
[0m22:58:30.359567 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:58:30.360476 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "sponsored_display", "database_name": "modern-sublime-383117", "generate_columns": true}', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'cache_selected_only': 'False', 'no_print': 'None', 'log_cache_events': 'False', 'log_format': 'default', 'quiet': 'False', 'static_parser': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'write_json': 'True', 'fail_fast': 'False'}
[0m22:58:33.773674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f931478-4698-45f5-a304-d50885575a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16098fdd0>]}
[0m22:58:33.853952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f931478-4698-45f5-a304-d50885575a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15ec7fb30>]}
[0m22:58:33.854900 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:58:34.333736 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:58:34.794253 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:58:34.795358 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/sponsored_display/sources.yml
[0m22:58:34.967329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f931478-4698-45f5-a304-d50885575a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163125cd0>]}
[0m22:58:35.173694 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:58:35.177619 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:58:35.216304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f931478-4698-45f5-a304-d50885575a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16321e750>]}
[0m22:58:35.216933 [info ] [MainThread]: Found 2 models, 4 data tests, 47 sources, 646 macros
[0m22:58:35.217295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f931478-4698-45f5-a304-d50885575a23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1605ce750>]}
[0m22:58:35.217844 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:58:35.295101 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.sponsored_display.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:58:35.295593 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:37.231284 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:7d62b106-f6c4-4a5e-80c4-582d2d5eae45&page=queryresults
[0m22:58:43.391579 [info ] [MainThread]: version: 2

sources:
  - name: sponsored_display
    tables:
      - name: adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: advertised_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: int64
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: promoted_sku
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: promoted_asin
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: numeric
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: advertised_product_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: vtr
            data_type: numeric
          - name: asin
            data_type: string
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: numeric
          - name: clicks
            data_type: numeric
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: numeric
          - name: campaign_id
            data_type: numeric
          - name: impressions
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: numeric
          - name: cumulative_reach
            data_type: numeric
          - name: view_impressions
            data_type: numeric
          - name: attributed_sales_1d
            data_type: numeric
          - name: attributed_sales_7d
            data_type: numeric
          - name: attributed_sales_14d
            data_type: numeric
          - name: attributed_sales_30d
            data_type: numeric
          - name: video_complete_views
            data_type: numeric
          - name: video_midpoint_views
            data_type: numeric
          - name: attributed_conversions_1d
            data_type: numeric
          - name: attributed_conversions_7d
            data_type: numeric
          - name: avg_impressions_frequency
            data_type: numeric
          - name: view_attributed_sales_14d
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: numeric
          - name: attributed_conversions_30d
            data_type: numeric
          - name: video_first_quartile_views
            data_type: numeric
          - name: video_third_quartile_views
            data_type: numeric
          - name: attributed_units_ordered_1d
            data_type: numeric
          - name: attributed_units_ordered_7d
            data_type: numeric
          - name: attributed_sales_1d_same_sku
            data_type: numeric
          - name: attributed_sales_7d_same_sku
            data_type: numeric
          - name: attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_units_ordered_30d
            data_type: numeric
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_sales_30d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: numeric
          - name: attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_conversions_14d
            data_type: numeric
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_conversions_1d_same_sku
            data_type: numeric
          - name: attributed_conversions_7d_same_sku
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_conversions_14d_same_sku
            data_type: numeric
          - name: attributed_conversions_30d_same_sku
            data_type: numeric
          - name: view_attributed_branded_searches_14d
            data_type: numeric
          - name: view_attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_new_to_brand_14d
            data_type: numeric

      - name: campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: campaign_console
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: budget
            data_type: int64
          - name: clicks
            data_type: int64
          - name: status
            data_type: string
          - name: currency
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: cost_per_click
            data_type: numeric
          - name: portfolio_name
            data_type: string
          - name: click_thru_rate
            data_type: numeric
          - name: _14_day_total_sales
            data_type: numeric
          - name: _14_day_total_units
            data_type: int64
          - name: _14_day_total_orders
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: _14_day_detail_page_views
            data_type: int64
          - name: _14_day_total_sales_click
            data_type: numeric
          - name: _14_day_total_units_click
            data_type: int64
          - name: _14_day_new_to_brand_sales
            data_type: numeric
          - name: _14_day_new_to_brand_units
            data_type: int64
          - name: _14_day_total_orders_click
            data_type: int64
          - name: _14_day_new_to_brand_orders
            data_type: int64
          - name: _14_day_new_to_brand_sales_click
            data_type: numeric
          - name: _14_day_new_to_brand_units_click
            data_type: int64
          - name: total_advertising_cost_of_sales
            data_type: numeric
          - name: _14_day_new_to_brand_orders_click
            data_type: int64
          - name: total_return_on_advertising_spend
            data_type: numeric
          - name: cost_per_1_000_viewable_impressions
            data_type: numeric
          - name: total_advertising_cost_of_sales_click
            data_type: numeric
          - name: total_return_on_advertising_spend_click
            data_type: numeric

      - name: campaign_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: clicks
            data_type: numeric
          - name: currency
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: numeric
          - name: impressions
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: numeric
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: cumulative_reach
            data_type: numeric
          - name: view_impressions
            data_type: numeric
          - name: attributed_sales_1d
            data_type: numeric
          - name: attributed_sales_7d
            data_type: numeric
          - name: attributed_sales_14d
            data_type: numeric
          - name: attributed_sales_30d
            data_type: numeric
          - name: video_complete_views
            data_type: numeric
          - name: video_midpoint_views
            data_type: numeric
          - name: attributed_conversions_1d
            data_type: numeric
          - name: attributed_conversions_7d
            data_type: numeric
          - name: avg_impressions_frequency
            data_type: numeric
          - name: view_attributed_sales_14d
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: numeric
          - name: attributed_conversions_30d
            data_type: numeric
          - name: video_first_quartile_views
            data_type: numeric
          - name: video_third_quartile_views
            data_type: numeric
          - name: attributed_units_ordered_1d
            data_type: numeric
          - name: attributed_units_ordered_7d
            data_type: numeric
          - name: attributed_sales_1d_same_sku
            data_type: numeric
          - name: attributed_sales_7d_same_sku
            data_type: numeric
          - name: attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_units_ordered_30d
            data_type: numeric
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_sales_30d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: numeric
          - name: attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_conversions_14d
            data_type: numeric
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_conversions_1d_same_sku
            data_type: numeric
          - name: attributed_conversions_7d_same_sku
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_conversions_14d_same_sku
            data_type: numeric
          - name: attributed_conversions_30d_same_sku
            data_type: numeric
          - name: view_attributed_branded_searches_14d
            data_type: numeric
          - name: view_attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_new_to_brand_14d
            data_type: numeric

      - name: campaigns
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: budget
            data_type: numeric
          - name: tactic
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: budget_type
            data_type: string
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: delivery_profile
            data_type: string

      - name: gross_and_invalid
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_status
            data_type: string
          - name: gross_impressions
            data_type: int64
          - name: invalid_impressions
            data_type: int64
          - name: gross_click_throughs
            data_type: int64
          - name: invalid_click_throughs
            data_type: int64
          - name: invalid_impression_rate
            data_type: numeric
          - name: invalid_click_through_rate
            data_type: numeric

      - name: matched_target_campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: numeric
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: matched_target_asin
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: int64
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64

      - name: portfolio_performance_summary_view
        columns:
          - name: date
            data_type: date
          - name: marketplace
            data_type: string
          - name: portfolio_name
            data_type: string
          - name: product_code
            data_type: string
          - name: currency
            data_type: string
          - name: cost
            data_type: numeric
          - name: units_sold
            data_type: numeric
          - name: clicks
            data_type: numeric
          - name: impressions
            data_type: numeric

      - name: targeting
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: targeting_text
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: targeting_expression
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: targeting_matched_asin
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: targeting_text
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: int64
          - name: branded_search_rate
            data_type: numeric
          - name: matched_target_asin
            data_type: string
          - name: targeting_expression
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: int64
          - name: purchases_promoted_clicks
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64

[0m22:58:43.416036 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:58:43.418861 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 13.154315, "process_in_blocks": "0", "process_kernel_time": 1.170812, "process_mem_max_rss": "367476736", "process_out_blocks": "0", "process_user_time": 4.450904}
[0m22:58:43.419551 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:58:43.419381 after 13.16 seconds
[0m22:58:43.420134 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:58:43.420515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d18c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16321eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16207d280>]}
[0m22:58:43.421123 [debug] [MainThread]: Flushing usage events
[0m22:58:43.953668 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:08.976834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861e4b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4ce90>]}


============================== 22:59:08.984559 | b9d7cf54-2322-42be-9037-363f7b8211af ==============================
[0m22:59:08.984559 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:59:08.985395 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'introspect': 'True', 'warn_error': 'None', 'cache_selected_only': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "sponsored_display", "database_name": "modern-sublime-383117", "generate_columns": true}', 'log_cache_events': 'False', 'partial_parse': 'True', 'log_format': 'default', 'quiet': 'False', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/cherry/.dbt', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'empty': 'None', 'target_path': 'None', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False'}
[0m22:59:12.503741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b9d7cf54-2322-42be-9037-363f7b8211af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a1d100>]}
[0m22:59:12.582213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b9d7cf54-2322-42be-9037-363f7b8211af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fa20cb0>]}
[0m22:59:12.583028 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:59:13.047118 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:59:13.527579 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:13.527998 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:13.598571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b9d7cf54-2322-42be-9037-363f7b8211af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fe689e0>]}
[0m22:59:13.803122 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:59:13.806821 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:59:13.844905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b9d7cf54-2322-42be-9037-363f7b8211af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15850aa80>]}
[0m22:59:13.845758 [info ] [MainThread]: Found 2 models, 4 data tests, 47 sources, 646 macros
[0m22:59:13.846302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b9d7cf54-2322-42be-9037-363f7b8211af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15859f4a0>]}
[0m22:59:13.847122 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m22:59:13.918805 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.sponsored_display.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m22:59:13.919707 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:15.955120 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:5098ed3e-58a7-41d9-b548-4cba7c9a4ad6&page=queryresults
[0m22:59:21.283952 [info ] [MainThread]: version: 2

sources:
  - name: sponsored_display
    tables:
      - name: adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: advertised_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: int64
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: promoted_sku
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: promoted_asin
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: numeric
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: advertised_product_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: sku
            data_type: string
          - name: vtr
            data_type: numeric
          - name: asin
            data_type: string
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: numeric
          - name: clicks
            data_type: numeric
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: numeric
          - name: campaign_id
            data_type: numeric
          - name: impressions
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: numeric
          - name: cumulative_reach
            data_type: numeric
          - name: view_impressions
            data_type: numeric
          - name: attributed_sales_1d
            data_type: numeric
          - name: attributed_sales_7d
            data_type: numeric
          - name: attributed_sales_14d
            data_type: numeric
          - name: attributed_sales_30d
            data_type: numeric
          - name: video_complete_views
            data_type: numeric
          - name: video_midpoint_views
            data_type: numeric
          - name: attributed_conversions_1d
            data_type: numeric
          - name: attributed_conversions_7d
            data_type: numeric
          - name: avg_impressions_frequency
            data_type: numeric
          - name: view_attributed_sales_14d
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: numeric
          - name: attributed_conversions_30d
            data_type: numeric
          - name: video_first_quartile_views
            data_type: numeric
          - name: video_third_quartile_views
            data_type: numeric
          - name: attributed_units_ordered_1d
            data_type: numeric
          - name: attributed_units_ordered_7d
            data_type: numeric
          - name: attributed_sales_1d_same_sku
            data_type: numeric
          - name: attributed_sales_7d_same_sku
            data_type: numeric
          - name: attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_units_ordered_30d
            data_type: numeric
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_sales_30d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: numeric
          - name: attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_conversions_14d
            data_type: numeric
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_conversions_1d_same_sku
            data_type: numeric
          - name: attributed_conversions_7d_same_sku
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_conversions_14d_same_sku
            data_type: numeric
          - name: attributed_conversions_30d_same_sku
            data_type: numeric
          - name: view_attributed_branded_searches_14d
            data_type: numeric
          - name: view_attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_new_to_brand_14d
            data_type: numeric

      - name: campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: cumulative_reach
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: impressions_frequency_average
            data_type: numeric
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: campaign_console
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: budget
            data_type: int64
          - name: clicks
            data_type: int64
          - name: status
            data_type: string
          - name: currency
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: cost_per_click
            data_type: numeric
          - name: portfolio_name
            data_type: string
          - name: click_thru_rate
            data_type: numeric
          - name: _14_day_total_sales
            data_type: numeric
          - name: _14_day_total_units
            data_type: int64
          - name: _14_day_total_orders
            data_type: int64
          - name: viewable_impressions
            data_type: int64
          - name: _14_day_detail_page_views
            data_type: int64
          - name: _14_day_total_sales_click
            data_type: numeric
          - name: _14_day_total_units_click
            data_type: int64
          - name: _14_day_new_to_brand_sales
            data_type: numeric
          - name: _14_day_new_to_brand_units
            data_type: int64
          - name: _14_day_total_orders_click
            data_type: int64
          - name: _14_day_new_to_brand_orders
            data_type: int64
          - name: _14_day_new_to_brand_sales_click
            data_type: numeric
          - name: _14_day_new_to_brand_units_click
            data_type: int64
          - name: total_advertising_cost_of_sales
            data_type: numeric
          - name: _14_day_new_to_brand_orders_click
            data_type: int64
          - name: total_return_on_advertising_spend
            data_type: numeric
          - name: cost_per_1_000_viewable_impressions
            data_type: numeric
          - name: total_advertising_cost_of_sales_click
            data_type: numeric
          - name: total_return_on_advertising_spend_click
            data_type: numeric

      - name: campaign_v2
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: vtr
            data_type: numeric
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: clicks
            data_type: numeric
          - name: currency
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: numeric
          - name: impressions
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: numeric
          - name: campaign_budget
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: cumulative_reach
            data_type: numeric
          - name: view_impressions
            data_type: numeric
          - name: attributed_sales_1d
            data_type: numeric
          - name: attributed_sales_7d
            data_type: numeric
          - name: attributed_sales_14d
            data_type: numeric
          - name: attributed_sales_30d
            data_type: numeric
          - name: video_complete_views
            data_type: numeric
          - name: video_midpoint_views
            data_type: numeric
          - name: attributed_conversions_1d
            data_type: numeric
          - name: attributed_conversions_7d
            data_type: numeric
          - name: avg_impressions_frequency
            data_type: numeric
          - name: view_attributed_sales_14d
            data_type: numeric
          - name: attributed_conversions_14d
            data_type: numeric
          - name: attributed_conversions_30d
            data_type: numeric
          - name: video_first_quartile_views
            data_type: numeric
          - name: video_third_quartile_views
            data_type: numeric
          - name: attributed_units_ordered_1d
            data_type: numeric
          - name: attributed_units_ordered_7d
            data_type: numeric
          - name: attributed_sales_1d_same_sku
            data_type: numeric
          - name: attributed_sales_7d_same_sku
            data_type: numeric
          - name: attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_units_ordered_30d
            data_type: numeric
          - name: attributed_sales_14d_same_sku
            data_type: numeric
          - name: attributed_sales_30d_same_sku
            data_type: numeric
          - name: attributed_branded_searches_14d
            data_type: numeric
          - name: attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_conversions_14d
            data_type: numeric
          - name: attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_14d
            data_type: numeric
          - name: attributed_conversions_1d_same_sku
            data_type: numeric
          - name: attributed_conversions_7d_same_sku
            data_type: numeric
          - name: attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_conversions_14d_same_sku
            data_type: numeric
          - name: attributed_conversions_30d_same_sku
            data_type: numeric
          - name: view_attributed_branded_searches_14d
            data_type: numeric
          - name: view_attributed_detail_page_view_14d
            data_type: numeric
          - name: view_attributed_sales_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_orders_new_to_brand_14d
            data_type: numeric
          - name: attributed_units_ordered_new_to_brand_14d
            data_type: numeric
          - name: view_attributed_units_ordered_new_to_brand_14d
            data_type: numeric

      - name: campaigns
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: budget
            data_type: numeric
          - name: tactic
            data_type: string
          - name: cost_type
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: budget_type
            data_type: string
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: delivery_profile
            data_type: string

      - name: gross_and_invalid
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_status
            data_type: string
          - name: gross_impressions
            data_type: int64
          - name: invalid_impressions
            data_type: int64
          - name: gross_click_throughs
            data_type: int64
          - name: invalid_click_throughs
            data_type: int64
          - name: invalid_impression_rate
            data_type: numeric
          - name: invalid_click_through_rate
            data_type: numeric

      - name: matched_target_campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: cost_type
            data_type: string
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: numeric
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: video_unmutes
            data_type: int64
          - name: campaign_status
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: bid_optimization
            data_type: string
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: viewability_rate
            data_type: numeric
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: matched_target_asin
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: video_midpoint_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: view_click_through_rate
            data_type: numeric
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: int64
          - name: purchases_promoted_clicks
            data_type: int64
          - name: video_first_quartile_views
            data_type: int64
          - name: video_third_quartile_views
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64

      - name: portfolio_performance_summary_view
        columns:
          - name: date
            data_type: date
          - name: marketplace
            data_type: string
          - name: portfolio_name
            data_type: string
          - name: product_code
            data_type: string
          - name: currency
            data_type: string
          - name: cost
            data_type: numeric
          - name: units_sold
            data_type: numeric
          - name: clicks
            data_type: numeric
          - name: impressions
            data_type: numeric

      - name: targeting
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: targeting_text
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: numeric
          - name: branded_search_rate
            data_type: numeric
          - name: targeting_expression
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: numeric
          - name: purchases_promoted_clicks
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_detail_page_views
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64
          - name: new_to_brand_ecpd_etail_page_view
            data_type: numeric
          - name: new_to_brand_detail_page_view_rate
            data_type: numeric
          - name: new_to_brand_detail_page_view_views
            data_type: int64
          - name: new_to_brand_detail_page_view_clicks
            data_type: int64

      - name: targeting_matched_asin
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: sales
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: purchases
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: units_sold
            data_type: int64
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: add_to_cart
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: sales_clicks
            data_type: numeric
          - name: targeting_id
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: targeting_text
            data_type: string
          - name: add_to_cart_rate
            data_type: numeric
          - name: branded_searches
            data_type: int64
          - name: e_cpa_dd_to_cart
            data_type: numeric
          - name: purchases_clicks
            data_type: int64
          - name: ad_keyword_status
            data_type: string
          - name: add_to_cart_views
            data_type: int64
          - name: detail_page_views
            data_type: int64
          - name: e_cpb_rand_search
            data_type: numeric
          - name: impressions_views
            data_type: int64
          - name: units_sold_clicks
            data_type: int64
          - name: add_to_cart_clicks
            data_type: int64
          - name: new_to_brand_sales
            data_type: int64
          - name: branded_search_rate
            data_type: numeric
          - name: matched_target_asin
            data_type: string
          - name: targeting_expression
            data_type: string
          - name: video_complete_views
            data_type: int64
          - name: sales_promoted_clicks
            data_type: numeric
          - name: branded_searches_views
            data_type: int64
          - name: new_to_brand_purchases
            data_type: int64
          - name: branded_searches_clicks
            data_type: int64
          - name: new_to_brand_units_sold
            data_type: int64
          - name: detail_page_views_clicks
            data_type: int64
          - name: new_to_brand_sales_clicks
            data_type: int64
          - name: purchases_promoted_clicks
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: new_to_brand_purchases_clicks
            data_type: int64
          - name: new_to_brand_units_sold_clicks
            data_type: int64

[0m22:59:21.302742 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:59:21.305815 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 12.427663, "process_in_blocks": "0", "process_kernel_time": 1.130198, "process_mem_max_rss": "372391936", "process_out_blocks": "0", "process_user_time": 4.374692}
[0m22:59:21.306626 [debug] [MainThread]: Command `dbt run-operation` succeeded at 22:59:21.306533 after 12.43 seconds
[0m22:59:21.307312 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m22:59:21.307810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15850b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15859df10>]}
[0m22:59:21.308236 [debug] [MainThread]: Flushing usage events
[0m22:59:21.783098 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:02:45.394235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103e76660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a0ef0>]}


============================== 23:02:45.402221 | 39face4a-eb15-43e5-81e2-8058999aa764 ==============================
[0m23:02:45.402221 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:02:45.403061 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'printer_width': '80', 'profiles_dir': '/Users/cherry/.dbt', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_format': 'default', 'target_path': 'None', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'version_check': 'True', 'use_colors': 'True', 'write_json': 'True', 'static_parser': 'True', 'no_print': 'None', 'debug': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'introspect': 'True', 'invocation_command': 'dbt run-operation generate_source --args {"schema_name": "sponsored_products", "database_name": "modern-sublime-383117", "generate_columns": true}'}
[0m23:02:48.774108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39face4a-eb15-43e5-81e2-8058999aa764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a040e90>]}
[0m23:02:48.858516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39face4a-eb15-43e5-81e2-8058999aa764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1af00>]}
[0m23:02:48.859452 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m23:02:49.284827 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:02:49.760100 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:02:49.760875 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/sponsored_products/sources.yml
[0m23:02:49.933614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39face4a-eb15-43e5-81e2-8058999aa764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13a262f30>]}
[0m23:02:50.163147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:02:50.167370 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:02:50.220279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39face4a-eb15-43e5-81e2-8058999aa764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac28740>]}
[0m23:02:50.221111 [info ] [MainThread]: Found 2 models, 4 data tests, 59 sources, 646 macros
[0m23:02:50.221649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39face4a-eb15-43e5-81e2-8058999aa764', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ae73bc0>]}
[0m23:02:50.222435 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_source'
[0m23:02:50.290686 [debug] [MainThread]: On macro_generate_source: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "macro_generate_source"} */


      
        
            select distinct
                table_schema,
                table_name,
                
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as `table_type`


            from `modern-sublime-383117`.sponsored_products.INFORMATION_SCHEMA.TABLES
            where lower(table_name) like lower ('%')
                and lower(table_name) not like lower ('')

            

        
    
[0m23:02:50.291260 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:52.442380 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:94f16b80-fdae-4690-93c3-e7c5b7c25abc&page=queryresults
[0m23:02:57.668167 [info ] [MainThread]: version: 2

sources:
  - name: sponsored_products
    tables:
      - name: adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: ad_status
            data_type: string
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: click_through_rate
            data_type: numeric
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: campaign_bidding_strategy
            data_type: string
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: advertised_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: ad_id
            data_type: int64
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: numeric
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: acos_clicks_7d
            data_type: numeric
          - name: advertised_sku
            data_type: string
          - name: cost_per_click
            data_type: numeric
          - name: roas_clicks_7d
            data_type: numeric
          - name: acos_clicks_14d
            data_type: numeric
          - name: advertised_asin
            data_type: string
          - name: campaign_status
            data_type: string
          - name: roas_clicks_14d
            data_type: numeric
          - name: click_through_rate
            data_type: numeric
          - name: sales_other_sku_7d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_other_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: campaign
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: click_through_rate
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: campaign_bidding_strategy
            data_type: string
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: top_of_search_impression_share
            data_type: numeric
          - name: campaign_rule_based_budget_amount
            data_type: numeric
          - name: campaign_applicable_budget_rule_id
            data_type: string
          - name: campaign_applicable_budget_rule_name
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: campaign_adgroup
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: ad_status
            data_type: string
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: click_through_rate
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: campaign_bidding_strategy
            data_type: string
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: campaign_rule_based_budget_amount
            data_type: numeric
          - name: campaign_applicable_budget_rule_id
            data_type: string
          - name: campaign_applicable_budget_rule_name
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: campaign_console
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: budget
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: status
            data_type: string
          - name: country
            data_type: string
          - name: currency
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_type
            data_type: string
          - name: cost_per_click
            data_type: numeric
          - name: portfolio_name
            data_type: string
          - name: targeting_type
            data_type: string
          - name: click_thru_rate
            data_type: numeric
          - name: last_year_spend
            data_type: numeric
          - name: bidding_strategy
            data_type: string
          - name: last_year_clicks
            data_type: numeric
          - name: _7_day_total_sales
            data_type: numeric
          - name: _7_day_total_orders
            data_type: int64
          - name: last_year_impressions
            data_type: numeric
          - name: last_year_cost_per_click
            data_type: numeric
          - name: total_advertising_cost_of_sales
            data_type: numeric
          - name: total_return_on_advertising_spend
            data_type: numeric

      - name: campaign_placement
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: spend
            data_type: numeric
          - name: clicks
            data_type: int64
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: cost_per_click
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: click_through_rate
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: placement_classification
            data_type: string
          - name: campaign_bidding_strategy
            data_type: string
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: campaign_rule_based_budget_amount
            data_type: numeric
          - name: campaign_applicable_budget_rule_id
            data_type: string
          - name: campaign_applicable_budget_rule_name
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: campaign_structures
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: end_date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: numeric
          - name: budget_budget
            data_type: numeric
          - name: targeting_type
            data_type: string
          - name: budget_budget_type
            data_type: string
          - name: dynamic_bidding_strategy
            data_type: string
          - name: dynamic_bidding_placement_bidding
            data_type: string

      - name: campaigns
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: name
            data_type: string
          - name: state
            data_type: string
          - name: end_date
            data_type: date
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: start_date
            data_type: date
          - name: updated_at
            data_type: datetime
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: portfolio_id
            data_type: numeric
          - name: budget_budget
            data_type: numeric
          - name: targeting_type
            data_type: string
          - name: budget_budget_type
            data_type: string
          - name: dynamic_bidding_strategy
            data_type: string
          - name: dynamic_bidding_placement_bidding
            data_type: string

      - name: gross_and_invalid_traffic
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: updated_at
            data_type: datetime
          - name: impressions
            data_type: int64
          - name: marketplace
            data_type: string
          - name: campaign_name
            data_type: string
          - name: campaign_status
            data_type: string
          - name: gross_impressions
            data_type: int64
          - name: invalid_impressions
            data_type: int64
          - name: gross_click_throughs
            data_type: int64
          - name: invalid_click_throughs
            data_type: int64
          - name: invalid_impression_rate
            data_type: numeric
          - name: invalid_click_through_rate
            data_type: numeric

      - name: portfolio_performance_summary_view
        columns:
          - name: date
            data_type: date
          - name: marketplace
            data_type: string
          - name: portfolio_name
            data_type: string
          - name: product_code
            data_type: string
          - name: currency
            data_type: string
          - name: total_cost
            data_type: numeric
          - name: total_units_sold_clicks_7d
            data_type: int64
          - name: total_clicks
            data_type: int64
          - name: total_impressions
            data_type: int64
          - name: sales_7d
            data_type: numeric
          - name: tenant_id
            data_type: int64

      - name: purchased_product
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: date
            data_type: date
          - name: keyword
            data_type: string
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: marketplace
            data_type: string
          - name: keyword_type
            data_type: string
          - name: portfolio_id
            data_type: int64
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: advertised_sku
            data_type: string
          - name: purchased_asin
            data_type: string
          - name: advertised_asin
            data_type: string
          - name: sales_other_sku_1d
            data_type: numeric
          - name: sales_other_sku_7d
            data_type: numeric
          - name: sales_other_sku_14d
            data_type: numeric
          - name: sales_other_sku_30d
            data_type: numeric
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: purchases_other_sku_1d
            data_type: int64
          - name: purchases_other_sku_7d
            data_type: int64
          - name: purchases_other_sku_14d
            data_type: int64
          - name: purchases_other_sku_30d
            data_type: int64
          - name: units_sold_other_sku_1d
            data_type: int64
          - name: units_sold_other_sku_7d
            data_type: int64
          - name: units_sold_other_sku_14d
            data_type: int64
          - name: units_sold_other_sku_30d
            data_type: int64
          - name: campaign_budget_currency_code
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: search_term
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: keyword
            data_type: string
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: targeting
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: search_term
            data_type: string
          - name: keyword_type
            data_type: string
          - name: portfolio_id
            data_type: numeric
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: acos_clicks_7d
            data_type: numeric
          - name: cost_per_click
            data_type: numeric
          - name: roas_clicks_7d
            data_type: numeric
          - name: acos_clicks_14d
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: roas_clicks_14d
            data_type: numeric
          - name: ad_keyword_status
            data_type: string
          - name: click_through_rate
            data_type: numeric
          - name: sales_other_sku_7d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_other_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

      - name: targeting
        columns:
          - name: _airbyte_raw_id
            data_type: string
          - name: _airbyte_extracted_at
            data_type: timestamp
          - name: _airbyte_meta
            data_type: json
          - name: _airbyte_generation_id
            data_type: int64
          - name: cost
            data_type: numeric
          - name: date
            data_type: date
          - name: clicks
            data_type: int64
          - name: keyword
            data_type: string
          - name: sales_1d
            data_type: numeric
          - name: sales_7d
            data_type: numeric
          - name: sales_14d
            data_type: numeric
          - name: sales_30d
            data_type: numeric
          - name: targeting
            data_type: string
          - name: tenant_id
            data_type: int64
          - name: created_at
            data_type: datetime
          - name: keyword_id
            data_type: int64
          - name: match_type
            data_type: string
          - name: updated_at
            data_type: datetime
          - name: ad_group_id
            data_type: int64
          - name: campaign_id
            data_type: int64
          - name: impressions
            data_type: int64
          - name: keyword_bid
            data_type: numeric
          - name: marketplace
            data_type: string
          - name: keyword_type
            data_type: string
          - name: portfolio_id
            data_type: numeric
          - name: purchases_1d
            data_type: int64
          - name: purchases_7d
            data_type: int64
          - name: ad_group_name
            data_type: string
          - name: campaign_name
            data_type: string
          - name: purchases_14d
            data_type: int64
          - name: purchases_30d
            data_type: int64
          - name: acos_clicks_7d
            data_type: numeric
          - name: cost_per_click
            data_type: numeric
          - name: roas_clicks_7d
            data_type: numeric
          - name: acos_clicks_14d
            data_type: numeric
          - name: campaign_status
            data_type: string
          - name: roas_clicks_14d
            data_type: numeric
          - name: ad_keyword_status
            data_type: string
          - name: click_through_rate
            data_type: numeric
          - name: sales_other_sku_7d
            data_type: numeric
          - name: campaign_budget_type
            data_type: string
          - name: units_sold_clicks_1d
            data_type: int64
          - name: units_sold_clicks_7d
            data_type: int64
          - name: purchases_same_sku_1d
            data_type: int64
          - name: purchases_same_sku_7d
            data_type: int64
          - name: units_sold_clicks_14d
            data_type: int64
          - name: units_sold_clicks_30d
            data_type: int64
          - name: campaign_budget_amount
            data_type: numeric
          - name: purchases_same_sku_14d
            data_type: int64
          - name: purchases_same_sku_30d
            data_type: int64
          - name: units_sold_same_sku_1d
            data_type: int64
          - name: units_sold_same_sku_7d
            data_type: int64
          - name: units_sold_other_sku_7d
            data_type: int64
          - name: units_sold_same_sku_14d
            data_type: int64
          - name: units_sold_same_sku_30d
            data_type: int64
          - name: search_term_impression_rank
            data_type: int64
          - name: attributed_sales_same_sku_1d
            data_type: numeric
          - name: attributed_sales_same_sku_7d
            data_type: numeric
          - name: attributed_sales_same_sku_14d
            data_type: numeric
          - name: attributed_sales_same_sku_30d
            data_type: numeric
          - name: campaign_budget_currency_code
            data_type: string
          - name: top_of_search_impression_share
            data_type: numeric
          - name: kindle_edition_normalized_pages_read_14d
            data_type: int64
          - name: kindle_edition_normalized_pages_royalties_14d
            data_type: int64

[0m23:02:57.687449 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m23:02:57.690417 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 12.3905325, "process_in_blocks": "0", "process_kernel_time": 1.113024, "process_mem_max_rss": "378847232", "process_out_blocks": "0", "process_user_time": 4.404373}
[0m23:02:57.691438 [debug] [MainThread]: Command `dbt run-operation` succeeded at 23:02:57.691163 after 12.39 seconds
[0m23:02:57.692031 [debug] [MainThread]: Connection 'macro_generate_source' was properly closed.
[0m23:02:57.692558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055a0e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac28590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ac16180>]}
[0m23:02:57.693108 [debug] [MainThread]: Flushing usage events
[0m23:02:58.219932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:05.999124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062953d0>]}


============================== 23:09:06.006494 | 01d1aa3b-6f02-4248-a62e-42e980c840b4 ==============================
[0m23:09:06.006494 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:09:06.007289 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'static_parser': 'True', 'quiet': 'False', 'target_path': 'None', 'fail_fast': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt source freshness', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'printer_width': '80', 'partial_parse': 'True', 'use_colors': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'no_print': 'None', 'log_cache_events': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'log_format': 'default'}
[0m23:09:09.440655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01d1aa3b-6f02-4248-a62e-42e980c840b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f825580>]}
[0m23:09:09.521799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01d1aa3b-6f02-4248-a62e-42e980c840b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f851fd0>]}
[0m23:09:09.522644 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m23:09:09.960623 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:09:10.473292 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:10.473670 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:10.550160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01d1aa3b-6f02-4248-a62e-42e980c840b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13eb29dc0>]}
[0m23:09:10.809195 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:09:10.813927 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:09:11.138462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01d1aa3b-6f02-4248-a62e-42e980c840b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13f825190>]}
[0m23:09:11.139016 [info ] [MainThread]: Found 2 models, 4 data tests, 72 sources, 646 macros
[0m23:09:11.139322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01d1aa3b-6f02-4248-a62e-42e980c840b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ff970b0>]}
[0m23:09:11.144508 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m23:09:11.337248 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:09:11.341268 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:09:11.344836 [debug] [MainThread]: Wrote artifact FreshnessResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/sources.json
[0m23:09:11.345512 [info ] [MainThread]: Done.
[0m23:09:11.348873 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 5.4414573, "process_in_blocks": "0", "process_kernel_time": 1.086768, "process_mem_max_rss": "379846656", "process_out_blocks": "0", "process_user_time": 4.489216}
[0m23:09:11.349462 [debug] [MainThread]: Command `dbt source freshness` succeeded at 23:09:11.349352 after 5.44 seconds
[0m23:09:11.349802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc7770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ff969c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x149ae9cd0>]}
[0m23:09:11.350300 [debug] [MainThread]: Flushing usage events
[0m23:09:11.883731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m02:58:13.962418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb69b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c095220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c094a10>]}


============================== 02:58:13.967547 | b4ee39e0-cba3-4730-b403-10a6c34085df ==============================
[0m02:58:13.967547 [info ] [MainThread]: Running with dbt=1.10.13
[0m02:58:13.968581 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'use_experimental_parser': 'False', 'empty': 'None', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'quiet': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'target_path': 'None', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'debug': 'False', 'profiles_dir': '/Users/cherry/.dbt'}
[0m02:58:14.090867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4ee39e0-cba3-4730-b403-10a6c34085df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c047e90>]}
[0m02:58:14.146024 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-2hrqe1_2'
[0m02:58:14.146741 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m02:58:14.373201 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m02:58:14.375705 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m02:58:14.466826 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m02:58:14.470893 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m02:58:14.569817 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m02:58:14.575228 [info ] [MainThread]: Installing dbt-labs/codegen
[0m02:58:14.913264 [info ] [MainThread]: Installed from version 0.13.1
[0m02:58:14.913531 [info ] [MainThread]: Up to date!
[0m02:58:14.913982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4ee39e0-cba3-4730-b403-10a6c34085df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1b46e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c383380>]}
[0m02:58:14.914344 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m02:58:15.300414 [info ] [MainThread]: Installed from version 1.3.1
[0m02:58:15.300681 [info ] [MainThread]: Up to date!
[0m02:58:15.300976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b4ee39e0-cba3-4730-b403-10a6c34085df', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c66c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3c64e0>]}
[0m02:58:15.304000 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4165422, "process_in_blocks": "0", "process_kernel_time": 0.347943, "process_mem_max_rss": "115097600", "process_out_blocks": "0", "process_user_time": 1.16898}
[0m02:58:15.304577 [debug] [MainThread]: Command `cli deps` succeeded at 02:58:15.304493 after 1.42 seconds
[0m02:58:15.304802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c095040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a43aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c15dcd0>]}
[0m02:58:15.304998 [debug] [MainThread]: Flushing usage events
[0m02:58:15.883614 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:28:20.224289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078124e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a12b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a0fe0>]}


============================== 21:28:20.228958 | 1549b992-90d3-47b8-9bf8-4fbccecb1bc3 ==============================
[0m21:28:20.228958 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:28:20.229781 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'invocation_command': 'dbt ', 'log_cache_events': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'warn_error': 'None', 'no_print': 'None', 'write_json': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'fail_fast': 'False', 'quiet': 'False', 'empty': 'None', 'static_parser': 'True', 'indirect_selection': 'eager'}
[0m21:28:20.343528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1549b992-90d3-47b8-9bf8-4fbccecb1bc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6afc0>]}
[0m21:28:20.394949 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-0g6nz91o'
[0m21:28:20.395244 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:28:20.623164 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:28:20.625330 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:28:20.712065 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:28:20.715618 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:28:20.805635 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:28:20.810909 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:28:21.137573 [info ] [MainThread]: Installed from version 0.13.1
[0m21:28:21.137934 [info ] [MainThread]: Up to date!
[0m21:28:21.138158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1549b992-90d3-47b8-9bf8-4fbccecb1bc3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a4acf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a98200>]}
[0m21:28:21.138396 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:28:21.528290 [info ] [MainThread]: Installed from version 1.3.1
[0m21:28:21.528620 [info ] [MainThread]: Up to date!
[0m21:28:21.528904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '1549b992-90d3-47b8-9bf8-4fbccecb1bc3', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117220f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b7f50>]}
[0m21:28:21.530836 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.3785546, "process_in_blocks": "0", "process_kernel_time": 0.332509, "process_mem_max_rss": "115605504", "process_out_blocks": "0", "process_user_time": 1.13915}
[0m21:28:21.531138 [debug] [MainThread]: Command `cli deps` succeeded at 21:28:21.531083 after 1.38 seconds
[0m21:28:21.531331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119308f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111746690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a0ad0>]}
[0m21:28:21.531509 [debug] [MainThread]: Flushing usage events
[0m21:28:22.075934 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:35:56.195275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120223560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e21f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e94b00>]}


============================== 21:35:56.200883 | 254ff4c4-798e-43d9-b990-1eea853953e0 ==============================
[0m21:35:56.200883 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:35:56.201785 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'empty': 'None', 'target_path': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'write_json': 'True', 'invocation_command': 'dbt ', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True'}
[0m21:35:56.337215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '254ff4c4-798e-43d9-b990-1eea853953e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120ca3380>]}
[0m21:35:56.392930 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-z66wyg_g'
[0m21:35:56.393236 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m21:35:56.558755 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m21:35:56.560606 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m21:35:56.741162 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m21:35:56.744423 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m21:35:56.840624 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m21:35:56.846743 [info ] [MainThread]: Installing dbt-labs/codegen
[0m21:35:57.142529 [info ] [MainThread]: Installed from version 0.13.1
[0m21:35:57.143019 [info ] [MainThread]: Up to date!
[0m21:35:57.143518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '254ff4c4-798e-43d9-b990-1eea853953e0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121710b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12417a1b0>]}
[0m21:35:57.143854 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m21:35:57.547808 [info ] [MainThread]: Installed from version 1.3.1
[0m21:35:57.548198 [info ] [MainThread]: Up to date!
[0m21:35:57.549014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '254ff4c4-798e-43d9-b990-1eea853953e0', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104baad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12417a720>]}
[0m21:35:57.551197 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.4365301, "process_in_blocks": "0", "process_kernel_time": 0.365762, "process_mem_max_rss": "115621888", "process_out_blocks": "0", "process_user_time": 1.201081}
[0m21:35:57.551816 [debug] [MainThread]: Command `cli deps` succeeded at 21:35:57.551732 after 1.44 seconds
[0m21:35:57.552049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e951f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123e220c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123f62c60>]}
[0m21:35:57.552243 [debug] [MainThread]: Flushing usage events
[0m21:35:58.130956 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m01:59:54.229256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11136e000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a0dd0>]}


============================== 01:59:54.233992 | d0e97a40-4198-4279-8e7d-f88e95d22c55 ==============================
[0m01:59:54.233992 [info ] [MainThread]: Running with dbt=1.10.13
[0m01:59:54.234716 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_colors': 'True', 'quiet': 'False', 'debug': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'log_cache_events': 'False', 'target_path': 'None', 'printer_width': '80', 'static_parser': 'True', 'write_json': 'True', 'partial_parse': 'True', 'empty': 'None', 'version_check': 'True', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt ', 'use_experimental_parser': 'False'}
[0m01:59:54.355327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0e97a40-4198-4279-8e7d-f88e95d22c55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11201ef00>]}
[0m01:59:54.438239 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-w3xkfks7'
[0m01:59:54.438625 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m01:59:54.747275 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m01:59:54.750111 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m01:59:54.873800 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m01:59:54.878547 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m01:59:54.991406 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m01:59:54.998441 [info ] [MainThread]: Installing dbt-labs/codegen
[0m01:59:55.368285 [info ] [MainThread]: Installed from version 0.13.1
[0m01:59:55.368706 [info ] [MainThread]: Up to date!
[0m01:59:55.369413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0e97a40-4198-4279-8e7d-f88e95d22c55', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112130890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112071b80>]}
[0m01:59:55.370177 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m01:59:55.886172 [info ] [MainThread]: Installed from version 1.3.1
[0m01:59:55.886508 [info ] [MainThread]: Up to date!
[0m01:59:55.887159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd0e97a40-4198-4279-8e7d-f88e95d22c55', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11221cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11227fad0>]}
[0m01:59:55.900262 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.7385491, "process_in_blocks": "0", "process_kernel_time": 0.385671, "process_mem_max_rss": "115539968", "process_out_blocks": "0", "process_user_time": 1.164107}
[0m01:59:55.901031 [debug] [MainThread]: Command `cli deps` succeeded at 01:59:55.900872 after 1.74 seconds
[0m01:59:55.901434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120a0f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112130890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112133bf0>]}
[0m01:59:55.901799 [debug] [MainThread]: Flushing usage events
[0m01:59:56.563429 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:53.631493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110195400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110195130>]}


============================== 17:45:53.637185 | e8821c11-ebbd-4059-ad20-cd190c90438e ==============================
[0m17:45:53.637185 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:45:53.637888 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'use_colors': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'debug': 'False', 'printer_width': '80', 'version_check': 'True', 'introspect': 'True', 'quiet': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'fail_fast': 'False', 'partial_parse': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'warn_error': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["int_join_orders_and_order_items", "int_calculate_fields_for_joined_orders", "int_get_prime_exclusive_price_for_new_orders", "int_add_fields_to_joined_orders", "int_aggregate_joined_orders_with_added_fields"]}', 'log_format': 'default'}
[0m17:45:56.139277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8821c11-ebbd-4059-ad20-cd190c90438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1435dbec0>]}
[0m17:45:56.193611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8821c11-ebbd-4059-ad20-cd190c90438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143652720>]}
[0m17:45:56.194057 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:45:56.510822 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:45:56.843772 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:56.844165 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:56.897084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8821c11-ebbd-4059-ad20-cd190c90438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791a990>]}
[0m17:45:57.076604 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m17:45:57.079904 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m17:45:57.136768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8821c11-ebbd-4059-ad20-cd190c90438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144c987a0>]}
[0m17:45:57.137801 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m17:45:57.138495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8821c11-ebbd-4059-ad20-cd190c90438e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143c53770>]}
[0m17:45:57.139344 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m17:45:57.160097 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_model_yaml
[0m17:45:57.161019 [debug] [MainThread]: BigQuery adapter: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m17:45:57.161261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:58.085614 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m17:45:58.091623 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 24, in macro
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 98, in macro
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 349, in __call__
    return self.resolve(name, package, version)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 621, in resolve
    return self.create_relation(target_model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 687, in create_relation
    raise OperationsCannotRefEphemeralNodesError(target_model.name, node=self.model)
dbt.exceptions.OperationsCannotRefEphemeralNodesError: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>

[0m17:45:58.102944 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m17:45:58.106440 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.5418525, "process_in_blocks": "0", "process_kernel_time": 0.859898, "process_mem_max_rss": "372850688", "process_out_blocks": "0", "process_user_time": 3.050072}
[0m17:45:58.107621 [debug] [MainThread]: Command `dbt run-operation` failed at 17:45:58.107551 after 4.54 seconds
[0m17:45:58.108049 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m17:45:58.108611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110195220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143cc54c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145947cb0>]}
[0m17:45:58.109006 [debug] [MainThread]: Flushing usage events
[0m17:45:58.667796 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:19.925560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1022190a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104856b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10413ffb0>]}


============================== 17:53:19.932118 | a3c35f98-5d4b-416d-a78a-860d7a7d7845 ==============================
[0m17:53:19.932118 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:53:19.932816 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name": "stg_orders__amazon_order_items"}', 'log_cache_events': 'False', 'target_path': 'None', 'log_format': 'default', 'static_parser': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'use_colors': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'quiet': 'False', 'introspect': 'True', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'printer_width': '80', 'version_check': 'True', 'no_print': 'None', 'use_experimental_parser': 'False', 'warn_error': 'None'}
[0m17:53:22.738330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a3c35f98-5d4b-416d-a78a-860d7a7d7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1613e5c70>]}
[0m17:53:22.797188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a3c35f98-5d4b-416d-a78a-860d7a7d7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161490cb0>]}
[0m17:53:22.797949 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:53:23.191360 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:53:23.683587 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:23.684239 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:23.778039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a3c35f98-5d4b-416d-a78a-860d7a7d7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161665700>]}
[0m17:53:24.058767 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m17:53:24.083107 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m17:53:24.152454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a3c35f98-5d4b-416d-a78a-860d7a7d7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1629fb410>]}
[0m17:53:24.153206 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m17:53:24.153556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a3c35f98-5d4b-416d-a78a-860d7a7d7845', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163143bc0>]}
[0m17:53:24.154143 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m17:53:24.159956 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_model_yaml
[0m17:53:24.160670 [debug] [MainThread]: BigQuery adapter: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'
[0m17:53:24.161158 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:24.942813 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'
[0m17:53:24.947281 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 418, in exception_handler
    yield
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 393, in call_macro
    with self.exception_handler():
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 420, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'

[0m17:53:24.957914 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m17:53:24.960305 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 5.111169, "process_in_blocks": "0", "process_kernel_time": 0.96868, "process_mem_max_rss": "365592576", "process_out_blocks": "0", "process_user_time": 3.360815}
[0m17:53:24.960822 [debug] [MainThread]: Command `dbt run-operation` failed at 17:53:24.960752 after 5.11 seconds
[0m17:53:24.961136 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m17:53:24.961469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162c53ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16123b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161665670>]}
[0m17:53:24.961779 [debug] [MainThread]: Flushing usage events
[0m17:53:25.495368 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:22.668642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10920d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096951c0>]}


============================== 17:55:22.676932 | 49469fe2-a0c3-4251-bac7-2b1184e5c3a6 ==============================
[0m17:55:22.676932 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:55:22.677698 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'no_print': 'None', 'printer_width': '80', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'use_colors': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'partial_parse': 'True', 'quiet': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'profiles_dir': '/Users/cherry/.dbt', 'log_format': 'default', 'target_path': 'None', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_name": "stg_orders__amazon_order_items"}'}
[0m17:55:28.742150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '49469fe2-a0c3-4251-bac7-2b1184e5c3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109670d70>]}
[0m17:55:28.858824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '49469fe2-a0c3-4251-bac7-2b1184e5c3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b07b950>]}
[0m17:55:28.860890 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:55:29.556358 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:55:30.127144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:30.127746 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:30.218998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '49469fe2-a0c3-4251-bac7-2b1184e5c3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b7c27e0>]}
[0m17:55:30.534858 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m17:55:30.540097 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m17:55:30.618545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '49469fe2-a0c3-4251-bac7-2b1184e5c3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d25e6c0>]}
[0m17:55:30.625289 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m17:55:30.633155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '49469fe2-a0c3-4251-bac7-2b1184e5c3a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b18deb0>]}
[0m17:55:30.651497 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m17:55:30.717315 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_model_yaml
[0m17:55:30.718855 [debug] [MainThread]: BigQuery adapter: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'
[0m17:55:30.725161 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:33.097068 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'
[0m17:55:33.102652 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 418, in exception_handler
    yield
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 759, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 393, in call_macro
    with self.exception_handler():
         ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Cellar/python@3.12/3.12.11/Frameworks/Python.framework/Versions/3.12/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 420, in exception_handler
    raise CaughtMacroErrorWithNodeError(exc=e, node=self.macro)
dbt_common.exceptions.macros.CaughtMacroErrorWithNodeError: Compilation Error
  macro 'dbt_macro__generate_model_yaml' takes no keyword argument 'model_name'

[0m17:55:33.114577 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m17:55:33.123175 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 10.559851, "process_in_blocks": "0", "process_kernel_time": 1.31968, "process_mem_max_rss": "364396544", "process_out_blocks": "0", "process_user_time": 4.953949}
[0m17:55:33.123930 [debug] [MainThread]: Command `dbt run-operation` failed at 17:55:33.123840 after 10.56 seconds
[0m17:55:33.124287 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m17:55:33.124600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109694bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13b3c44a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d49bf20>]}
[0m17:55:33.124865 [debug] [MainThread]: Flushing usage events
[0m17:55:33.735111 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:56:35.551317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023c58b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105795430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105795130>]}


============================== 17:56:35.559487 | cc2862bb-c4b7-4bce-acab-2eb38caff05c ==============================
[0m17:56:35.559487 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:56:35.560384 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'warn_error': 'None', 'log_format': 'default', 'log_cache_events': 'False', 'empty': 'None', 'version_check': 'True', 'no_print': 'None', 'use_colors': 'True', 'introspect': 'True', 'fail_fast': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'write_json': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["stg_orders__amazon_order_items"]}', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'partial_parse': 'True'}
[0m17:56:39.266384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc2862bb-c4b7-4bce-acab-2eb38caff05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160f911c0>]}
[0m17:56:39.363976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cc2862bb-c4b7-4bce-acab-2eb38caff05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160e130b0>]}
[0m17:56:39.364765 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:56:39.865412 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:56:40.397212 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:56:40.397756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:56:40.490084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc2862bb-c4b7-4bce-acab-2eb38caff05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f7b4d0>]}
[0m17:56:40.793500 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m17:56:40.798304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m17:56:40.867725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cc2862bb-c4b7-4bce-acab-2eb38caff05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a70650>]}
[0m17:56:40.868765 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m17:56:40.869390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cc2862bb-c4b7-4bce-acab-2eb38caff05c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160e69bb0>]}
[0m17:56:40.870269 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m17:56:40.894087 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:56:42.594466 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_staging/tables/stg_orders__amazon_order_items?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_staging
[0m17:56:42.595498 [info ] [MainThread]: version: 2

models:
  - name: stg_orders__amazon_order_items
    description: ""
    columns:
[0m17:56:42.611309 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m17:56:42.614813 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 7.177686, "process_in_blocks": "0", "process_kernel_time": 1.250265, "process_mem_max_rss": "375750656", "process_out_blocks": "0", "process_user_time": 4.687766}
[0m17:56:42.615523 [debug] [MainThread]: Command `dbt run-operation` succeeded at 17:56:42.615266 after 7.18 seconds
[0m17:56:42.615991 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m17:56:42.616622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105795220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1614611f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104942000>]}
[0m17:56:42.617274 [debug] [MainThread]: Flushing usage events
[0m17:56:43.072708 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:59:49.775363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cd8fbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d1950a0>]}


============================== 17:59:49.784755 | 19733b86-4003-4ca0-8a79-8309c30f7366 ==============================
[0m17:59:49.784755 [info ] [MainThread]: Running with dbt=1.10.13
[0m17:59:49.785899 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'target_path': 'None', 'partial_parse': 'True', 'indirect_selection': 'eager', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'printer_width': '80', 'profiles_dir': '/Users/cherry/.dbt', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_colors': 'True', 'empty': 'None', 'quiet': 'False', 'log_cache_events': 'False', 'log_format': 'default', 'write_json': 'True', 'no_print': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["obt_orders_per_asin_and_date"]}', 'send_anonymous_usage_stats': 'True'}
[0m17:59:53.433330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19733b86-4003-4ca0-8a79-8309c30f7366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1652c4800>]}
[0m17:59:53.519336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19733b86-4003-4ca0-8a79-8309c30f7366', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165225f40>]}
[0m17:59:53.520535 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m17:59:54.012907 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m17:59:54.548804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:59:54.550268 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/amazon_sp_api/orders/schema.yml
[0m17:59:54.647583 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models/staging/amazon_sp_api/orders/schema.yml @ models: {'name': 'stg_orders__amazon_order_items', 'description': 'Handles nulls in some columns', 'columns': None, 'original_file_path': 'models/staging/amazon_sp_api/orders/schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_project'} - at path ['columns']: None is not of type 'array'
[0m17:59:54.652160 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 4.985212, "process_in_blocks": "0", "process_kernel_time": 1.143737, "process_mem_max_rss": "372293632", "process_out_blocks": "0", "process_user_time": 4.353229}
[0m17:59:54.652806 [debug] [MainThread]: Command `dbt run-operation` failed at 17:59:54.652730 after 4.99 seconds
[0m17:59:54.653634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cb3de80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165b60d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11c5c01d0>]}
[0m17:59:54.654035 [debug] [MainThread]: Flushing usage events
[0m17:59:55.188088 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:05:59.434566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046acd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b215e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d292b0>]}


============================== 18:05:59.442381 | 42d91e00-c368-4328-b10d-ad10b5322567 ==============================
[0m18:05:59.442381 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:05:59.443450 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'log_format': 'default', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'quiet': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'empty': 'None', 'target_path': 'None', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["obt_orders_per_asin_and_date"]}', 'static_parser': 'True', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'fail_fast': 'False', 'warn_error': 'None'}
[0m18:06:03.190460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '42d91e00-c368-4328-b10d-ad10b5322567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160f27b00>]}
[0m18:06:03.298370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '42d91e00-c368-4328-b10d-ad10b5322567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f03d40>]}
[0m18:06:03.299752 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:06:03.810084 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:06:04.323479 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:04.324141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:04.419161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '42d91e00-c368-4328-b10d-ad10b5322567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1612c2d80>]}
[0m18:06:04.726048 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m18:06:04.730878 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m18:06:04.790220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '42d91e00-c368-4328-b10d-ad10b5322567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624fe6c0>]}
[0m18:06:04.791147 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m18:06:04.791830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '42d91e00-c368-4328-b10d-ad10b5322567', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1626dd280>]}
[0m18:06:04.792854 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m18:06:04.816426 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:06:06.610358 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_marts/tables/obt_orders_per_asin_and_date?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_marts
[0m18:06:06.611557 [info ] [MainThread]: version: 2

models:
  - name: obt_orders_per_asin_and_date
    description: ""
    columns:
[0m18:06:06.627165 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m18:06:06.630530 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 7.3059416, "process_in_blocks": "0", "process_kernel_time": 1.249586, "process_mem_max_rss": "373915648", "process_out_blocks": "0", "process_user_time": 4.766826}
[0m18:06:06.631470 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:06:06.631264 after 7.31 seconds
[0m18:06:06.631994 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m18:06:06.632539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104beda60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd4fb0>]}
[0m18:06:06.633173 [debug] [MainThread]: Flushing usage events
[0m18:06:07.166752 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:09:46.811265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050a76e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a954c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a950d0>]}


============================== 18:09:46.818873 | c2655e93-fd74-432c-9d79-3925f16179a3 ==============================
[0m18:09:46.818873 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:09:46.819720 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'empty': 'None', 'log_format': 'default', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'log_cache_events': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'use_colors': 'True', 'version_check': 'True', 'quiet': 'False', 'fail_fast': 'False', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'printer_width': '80', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["int_join_orders_and_order_items", "int_calculate_fields_for_joined_orders", "int_get_prime_exclusive_price_for_new_orders", "int_add_fields_to_joined_orders", "int_aggregate_joined_orders_with_added_fields"]}', 'profiles_dir': '/Users/cherry/.dbt'}
[0m18:09:50.777286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2655e93-fd74-432c-9d79-3925f16179a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1615aff80>]}
[0m18:09:50.877467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2655e93-fd74-432c-9d79-3925f16179a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160677500>]}
[0m18:09:50.878625 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:09:51.411353 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:09:51.958064 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:51.958775 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:52.051884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c2655e93-fd74-432c-9d79-3925f16179a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161861cd0>]}
[0m18:09:52.393968 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m18:09:52.400695 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m18:09:52.464633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c2655e93-fd74-432c-9d79-3925f16179a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622d5e50>]}
[0m18:09:52.465273 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m18:09:52.466094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c2655e93-fd74-432c-9d79-3925f16179a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622ecfe0>]}
[0m18:09:52.467011 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m18:09:52.489805 [debug] [MainThread]: BigQuery adapter: Unhandled error while running:
macro generate_model_yaml
[0m18:09:52.490682 [debug] [MainThread]: BigQuery adapter: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m18:09:52.491445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:53.581443 [error] [MainThread]: Encountered an error while running operation: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>
[0m18:09:53.587708 [debug] [MainThread]: Traceback (most recent call last):
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 64, in run
    self._run_unsafe(package_name, macro_name)
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/task/run_operation.py", line 45, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1294, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 427, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 24, in macro
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 395, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 98, in macro
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 349, in __call__
    return self.resolve(name, package, version)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 621, in resolve
    return self.create_relation(target_model)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/lib/python3.12/site-packages/dbt/context/providers.py", line 687, in create_relation
    raise OperationsCannotRefEphemeralNodesError(target_model.name, node=self.model)
dbt.exceptions.OperationsCannotRefEphemeralNodesError: Compilation Error
  Operations can not ref() ephemeral nodes, but int_join_orders_and_order_items is ephemeral
  
  > in macro default__generate_model_yaml (macros/generate_model_yaml.sql)
  > called by macro generate_model_yaml (macros/generate_model_yaml.sql)
  > called by <Unknown>

[0m18:09:53.602289 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m18:09:53.605458 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 6.898558, "process_in_blocks": "0", "process_kernel_time": 1.303116, "process_mem_max_rss": "376389632", "process_out_blocks": "0", "process_user_time": 4.557174}
[0m18:09:53.606405 [debug] [MainThread]: Command `dbt run-operation` failed at 18:09:53.606248 after 6.90 seconds
[0m18:09:53.607471 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m18:09:53.608257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622d6000>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162305760>]}
[0m18:09:53.609072 [debug] [MainThread]: Flushing usage events
[0m18:09:54.186200 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:16:18.349157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10541b920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069950d0>]}


============================== 18:16:18.354645 | df22054d-07d2-4fa4-bf84-295f22d70397 ==============================
[0m18:16:18.354645 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:16:18.355183 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run-operation generate_model_yaml --args {"model_names": ["int_join_orders_and_order_items", "int_calculate_fields_for_joined_orders", "int_get_prime_exclusive_price_for_new_orders", "int_add_fields_to_joined_orders", "int_aggregate_joined_orders_with_added_fields"]}', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'log_format': 'default', 'partial_parse': 'True', 'static_parser': 'True', 'no_print': 'None', 'cache_selected_only': 'False', 'debug': 'False', 'quiet': 'False', 'target_path': 'None', 'empty': 'None', 'warn_error': 'None', 'fail_fast': 'False', 'introspect': 'True', 'write_json': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80'}
[0m18:16:21.975406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df22054d-07d2-4fa4-bf84-295f22d70397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16206a750>]}
[0m18:16:22.108336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df22054d-07d2-4fa4-bf84-295f22d70397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13026c950>]}
[0m18:16:22.109857 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m18:16:22.688139 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m18:16:23.201366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:16:23.201977 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:16:23.294181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df22054d-07d2-4fa4-bf84-295f22d70397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1625c7a10>]}
[0m18:16:23.590880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m18:16:23.596772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m18:16:23.659960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df22054d-07d2-4fa4-bf84-295f22d70397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1643d5910>]}
[0m18:16:23.661171 [info ] [MainThread]: Found 9 models, 4 data tests, 72 sources, 646 macros
[0m18:16:23.661855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df22054d-07d2-4fa4-bf84-295f22d70397', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1644054f0>]}
[0m18:16:23.662847 [debug] [MainThread]: Acquiring new bigquery connection 'macro_generate_model_yaml'
[0m18:16:23.684821 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:16:25.192590 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_intermediate/tables/int_join_orders_and_order_items?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_intermediate
[0m18:16:25.520592 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_intermediate/tables/int_calculate_fields_for_joined_orders?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_intermediate
[0m18:16:25.799645 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_intermediate/tables/int_get_prime_exclusive_price_for_new_orders?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_intermediate
[0m18:16:26.131120 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_intermediate/tables/int_add_fields_to_joined_orders?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_intermediate
[0m18:16:26.991238 [debug] [MainThread]: BigQuery adapter: get_columns_in_relation error: 404 GET https://bigquery.googleapis.com/bigquery/v2/projects/modern-sublime-383117/datasets/dev_dev_intermediate/tables/int_aggregate_joined_orders_with_added_fields?prettyPrint=false: Not found: Dataset modern-sublime-383117:dev_dev_intermediate
[0m18:16:26.998437 [info ] [MainThread]: version: 2

models:
  - name: int_join_orders_and_order_items
    description: ""
    columns:
  - name: int_calculate_fields_for_joined_orders
    description: ""
    columns:
  - name: int_get_prime_exclusive_price_for_new_orders
    description: ""
    columns:
  - name: int_add_fields_to_joined_orders
    description: ""
    columns:
  - name: int_aggregate_joined_orders_with_added_fields
    description: ""
    columns:
[0m18:16:27.088340 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m18:16:27.092880 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": true, "command_wall_clock_time": 8.823247, "process_in_blocks": "0", "process_kernel_time": 1.053054, "process_mem_max_rss": "364953600", "process_out_blocks": "0", "process_user_time": 4.911196}
[0m18:16:27.094036 [debug] [MainThread]: Command `dbt run-operation` succeeded at 18:16:27.093778 after 8.82 seconds
[0m18:16:27.094786 [debug] [MainThread]: Connection 'macro_generate_model_yaml' was properly closed.
[0m18:16:27.095552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10627b650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1625c4e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105941ee0>]}
[0m18:16:27.096353 [debug] [MainThread]: Flushing usage events
[0m18:16:27.712693 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:23:06.678837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106747260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d595e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa0ef0>]}


============================== 18:23:06.687604 | e7ae3256-3ff4-48d8-9c48-e2741fe85919 ==============================
[0m18:23:06.687604 [info ] [MainThread]: Running with dbt=1.10.13
[0m18:23:06.688611 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'None', 'profiles_dir': '/Users/cherry/.dbt', 'introspect': 'True', 'invocation_command': 'dbt ', 'log_cache_events': 'False', 'no_print': 'None', 'write_json': 'True', 'fail_fast': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'log_format': 'default', 'quiet': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'static_parser': 'True', 'partial_parse': 'True', 'use_colors': 'True', 'target_path': 'None', 'indirect_selection': 'eager'}
[0m18:23:06.880851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e7ae3256-3ff4-48d8-9c48-e2741fe85919', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077112e0>]}
[0m18:23:06.946500 [debug] [MainThread]: Set downloads directory='/var/folders/j2/rnvpl6l502lgkpvw3k1qg4hc0000gn/T/dbt-downloads-cxanufmp'
[0m18:23:06.947326 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m18:23:07.236161 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m18:23:07.239395 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json
[0m18:23:07.389126 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/codegen.json 200
[0m18:23:07.394726 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m18:23:07.543652 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m18:23:07.552287 [info ] [MainThread]: Installing dbt-labs/codegen
[0m18:23:07.860111 [info ] [MainThread]: Installed from version 0.13.1
[0m18:23:07.860845 [info ] [MainThread]: Up to date!
[0m18:23:07.861428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7ae3256-3ff4-48d8-9c48-e2741fe85919', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1201ba180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200b41d0>]}
[0m18:23:07.861717 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m18:23:08.245231 [info ] [MainThread]: Installed from version 1.3.1
[0m18:23:08.245911 [info ] [MainThread]: Updated version available: 1.3.2
[0m18:23:08.246665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e7ae3256-3ff4-48d8-9c48-e2741fe85919', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120150860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120022ed0>]}
[0m18:23:08.247316 [info ] [MainThread]: 
[0m18:23:08.247842 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m18:23:08.251239 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.6756011, "process_in_blocks": "0", "process_kernel_time": 0.485399, "process_mem_max_rss": "116752384", "process_out_blocks": "0", "process_user_time": 1.74751}
[0m18:23:08.252127 [debug] [MainThread]: Command `cli deps` succeeded at 18:23:08.251939 after 1.68 seconds
[0m18:23:08.252803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077112e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa0fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107fa1130>]}
[0m18:23:08.253294 [debug] [MainThread]: Flushing usage events
[0m18:23:08.806771 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:57:17.114510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056fb3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064950d0>]}


============================== 19:57:17.122884 | ec4a01c4-8f50-4503-84e5-e5095bd1090f ==============================
[0m19:57:17.122884 [info ] [MainThread]: Running with dbt=1.10.13
[0m19:57:17.123670 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'write_json': 'True', 'indirect_selection': 'eager', 'quiet': 'False', 'log_format': 'default', 'printer_width': '80', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'profiles_dir': '/Users/cherry/.dbt', 'use_colors': 'True', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'empty': 'None', 'use_experimental_parser': 'False'}
[0m19:57:17.146307 [info ] [MainThread]: dbt version: 1.10.13
[0m19:57:17.147055 [info ] [MainThread]: python version: 3.12.11
[0m19:57:17.147753 [info ] [MainThread]: python path: /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt-env/bin/python
[0m19:57:17.148100 [info ] [MainThread]: os info: macOS-15.3.1-arm64-arm-64bit
[0m19:57:20.737378 [info ] [MainThread]: Using profiles dir at /Users/cherry/.dbt
[0m19:57:20.738807 [info ] [MainThread]: Using profiles.yml file at /Users/cherry/.dbt/profiles.yml
[0m19:57:20.739209 [info ] [MainThread]: Using dbt_project.yml file at /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/dbt_project.yml
[0m19:57:20.739837 [info ] [MainThread]: adapter type: bigquery
[0m19:57:20.740174 [info ] [MainThread]: adapter version: 1.10.2
[0m19:57:20.910787 [info ] [MainThread]: Configuration:
[0m19:57:20.911459 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m19:57:20.912364 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m19:57:20.912908 [info ] [MainThread]: Required dependencies:
[0m19:57:20.913552 [debug] [MainThread]: Executing "git --help"
[0m19:57:20.941540 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m19:57:20.943484 [debug] [MainThread]: STDERR: "b''"
[0m19:57:20.943913 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m19:57:20.944735 [info ] [MainThread]: Connection:
[0m19:57:20.945528 [info ] [MainThread]:   method: oauth
[0m19:57:20.946355 [info ] [MainThread]:   database: modern-sublime-383117
[0m19:57:20.946834 [info ] [MainThread]:   execution_project: modern-sublime-383117
[0m19:57:20.947057 [info ] [MainThread]:   schema: dev
[0m19:57:20.947566 [info ] [MainThread]:   location: US
[0m19:57:20.948124 [info ] [MainThread]:   priority: interactive
[0m19:57:20.948746 [info ] [MainThread]:   maximum_bytes_billed: 1000000000
[0m19:57:20.949495 [info ] [MainThread]:   impersonate_service_account: None
[0m19:57:20.949980 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m19:57:20.950605 [info ] [MainThread]:   job_retries: 1
[0m19:57:20.951168 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m19:57:20.952056 [info ] [MainThread]:   job_execution_timeout_seconds: 300
[0m19:57:20.952588 [info ] [MainThread]:   timeout_seconds: 300
[0m19:57:20.953271 [info ] [MainThread]:   client_id: None
[0m19:57:20.953835 [info ] [MainThread]:   token_uri: None
[0m19:57:20.954508 [info ] [MainThread]:   compute_region: None
[0m19:57:20.954833 [info ] [MainThread]:   dataproc_cluster_name: None
[0m19:57:20.954996 [info ] [MainThread]:   gcs_bucket: None
[0m19:57:20.955199 [info ] [MainThread]:   dataproc_batch: None
[0m19:57:20.956617 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m19:57:21.424435 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m19:57:21.425563 [debug] [MainThread]: On debug: select 1 as id
[0m19:57:21.426329 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:57:23.838690 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c44d76d6-6a38-4768-99c1-fcf31cd934d1&page=queryresults
[0m19:57:24.445789 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m19:57:24.446523 [info ] [MainThread]: [32mAll checks passed![0m
[0m19:57:24.450150 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 7.452491, "process_in_blocks": "0", "process_kernel_time": 1.151113, "process_mem_max_rss": "357826560", "process_out_blocks": "0", "process_user_time": 3.91859}
[0m19:57:24.451086 [debug] [MainThread]: Command `dbt debug` succeeded at 19:57:24.450865 after 7.45 seconds
[0m19:57:24.451708 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m19:57:24.452461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106495220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104780e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x139dbe840>]}
[0m19:57:24.452996 [debug] [MainThread]: Flushing usage events
[0m19:57:24.985947 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:58:59.954115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029a3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055955e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105595310>]}


============================== 20:58:59.962725 | dfccd8ae-9922-4212-914e-f029fcb00475 ==============================
[0m20:58:59.962725 [info ] [MainThread]: Running with dbt=1.10.13
[0m20:58:59.963585 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'introspect': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'target_path': 'None', 'log_format': 'default', 'debug': 'False', 'write_json': 'True', 'version_check': 'True', 'invocation_command': 'dbt compile', 'indirect_selection': 'eager', 'printer_width': '80', 'log_cache_events': 'False', 'partial_parse': 'True', 'warn_error': 'None', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'use_experimental_parser': 'False', 'static_parser': 'True', 'empty': 'False'}
[0m20:59:03.842666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135283bf0>]}
[0m20:59:03.934074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x135f37470>]}
[0m20:59:03.934992 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m20:59:04.440852 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m20:59:04.965778 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:59:04.966743 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:59:04.977344 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_project.example
[0m20:59:05.040405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1301fc980>]}
[0m20:59:05.331722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m20:59:05.337179 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m20:59:05.401715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136a07aa0>]}
[0m20:59:05.402635 [info ] [MainThread]: Found 7 models, 72 sources, 646 macros
[0m20:59:05.403112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136db8ad0>]}
[0m20:59:05.407283 [info ] [MainThread]: 
[0m20:59:05.407874 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:59:05.408077 [info ] [MainThread]: 
[0m20:59:05.408921 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:59:05.416074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_staging'
[0m20:59:05.416593 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_intermediate'
[0m20:59:05.417037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:05.417690 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_marts'
[0m20:59:05.418123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:05.418957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:59:07.325295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dfccd8ae-9922-4212-914e-f029fcb00475', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x133fb40b0>]}
[0m20:59:07.326401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:59:07.328755 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m20:59:07.329640 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.dbt_project.stg_orders__amazon_order_items'
[0m20:59:07.330513 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m20:59:07.344250 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m20:59:07.345782 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m20:59:07.346250 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:59:07.346981 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m20:59:07.348078 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m20:59:07.348791 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m20:59:07.349497 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_project.int_get_prime_exclusive_price_for_new_orders'
[0m20:59:07.350185 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m20:59:07.350492 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m20:59:07.350799 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m20:59:07.357265 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m20:59:07.371190 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m20:59:07.371656 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:59:07.372987 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m20:59:07.373519 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_join_orders_and_order_items
[0m20:59:07.373797 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:59:07.374453 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m20:59:07.375522 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m20:59:07.376034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m20:59:07.376838 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m20:59:07.381449 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m20:59:07.382665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:59:07.383782 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m20:59:07.384357 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m20:59:07.384964 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m20:59:07.385353 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m20:59:07.411175 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m20:59:07.412513 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m20:59:07.413021 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m20:59:07.414076 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m20:59:07.414971 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m20:59:07.415505 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields'
[0m20:59:07.415924 [debug] [Thread-2 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m20:59:07.420956 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m20:59:07.422414 [debug] [Thread-2 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m20:59:07.423220 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:59:07.424361 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m20:59:07.425013 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m20:59:07.425407 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.obt_orders_per_asin_and_date)
[0m20:59:07.425862 [debug] [Thread-4 (]: Began compiling node model.dbt_project.obt_orders_per_asin_and_date
[0m20:59:07.430152 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.obt_orders_per_asin_and_date"
[0m20:59:07.431277 [debug] [Thread-4 (]: Began executing node model.dbt_project.obt_orders_per_asin_and_date
[0m20:59:07.432214 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m20:59:07.433544 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m20:59:07.434655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:59:07.435011 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dev_dev_staging' was properly closed.
[0m20:59:07.435565 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dev_dev_intermediate' was properly closed.
[0m20:59:07.436062 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dev_dev_marts' was properly closed.
[0m20:59:07.436409 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m20:59:07.436870 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m20:59:07.437161 [debug] [MainThread]: Connection 'model.dbt_project.obt_orders_per_asin_and_date' was properly closed.
[0m20:59:07.437643 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m20:59:07.439365 [debug] [MainThread]: Command end result
[0m20:59:07.850586 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m20:59:07.855448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m20:59:07.865852 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m20:59:07.868613 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.025179, "process_in_blocks": "0", "process_kernel_time": 1.3882, "process_mem_max_rss": "378781696", "process_out_blocks": "0", "process_user_time": 5.07165}
[0m20:59:07.869289 [debug] [MainThread]: Command `dbt compile` succeeded at 20:59:07.869220 after 8.03 seconds
[0m20:59:07.869965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x136835e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1365ab530>]}
[0m20:59:07.870565 [debug] [MainThread]: Flushing usage events
[0m20:59:08.390691 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:00:08.240833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084ff5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b958e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b95610>]}


============================== 21:00:08.248054 | eee9aa44-758a-4a24-bbaf-0714c0e6364f ==============================
[0m21:00:08.248054 [info ] [MainThread]: Running with dbt=1.10.13
[0m21:00:08.249188 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/cherry/.dbt', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'log_format': 'default', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt compile', 'quiet': 'False', 'write_json': 'True', 'static_parser': 'True', 'debug': 'False', 'introspect': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'log_cache_events': 'False', 'no_print': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m21:00:12.186818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144bf6030>]}
[0m21:00:12.290896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b96420>]}
[0m21:00:12.292145 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m21:00:12.761286 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m21:00:13.293498 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:00:13.294112 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:00:13.371203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1451fa7b0>]}
[0m21:00:13.674402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m21:00:13.680754 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m21:00:13.743864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1460983e0>]}
[0m21:00:13.744992 [info ] [MainThread]: Found 7 models, 72 sources, 646 macros
[0m21:00:13.745669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1462ab5c0>]}
[0m21:00:13.750521 [info ] [MainThread]: 
[0m21:00:13.751113 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:00:13.751670 [info ] [MainThread]: 
[0m21:00:13.752476 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:00:13.759013 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_staging'
[0m21:00:13.759490 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:13.760106 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_marts'
[0m21:00:13.760590 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dev_dev_intermediate'
[0m21:00:13.761365 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:13.761955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:00:16.136629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eee9aa44-758a-4a24-bbaf-0714c0e6364f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ca3770>]}
[0m21:00:16.137664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:00:16.142520 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m21:00:16.143032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dev_dev_staging, now model.dbt_project.stg_orders__amazon_order_items)
[0m21:00:16.150666 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m21:00:16.165735 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m21:00:16.167095 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m21:00:16.167471 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:16.168963 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m21:00:16.170077 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m21:00:16.170735 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m21:00:16.171199 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dev_dev_intermediate, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m21:00:16.171953 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m21:00:16.172502 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m21:00:16.173187 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m21:00:16.180050 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m21:00:16.186376 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m21:00:16.187776 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:16.188313 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_join_orders_and_order_items
[0m21:00:16.189555 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m21:00:16.190120 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m21:00:16.191382 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m21:00:16.192178 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m21:00:16.192769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m21:00:16.193369 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m21:00:16.197754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m21:00:16.198814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:00:16.199779 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m21:00:16.200634 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m21:00:16.201360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m21:00:16.201899 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m21:00:16.225015 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m21:00:16.226369 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m21:00:16.226873 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m21:00:16.228274 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m21:00:16.229213 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m21:00:16.229581 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dev_dev_marts, now model.dbt_project.int_aggregate_joined_orders_with_added_fields)
[0m21:00:16.230225 [debug] [Thread-2 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m21:00:16.236110 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m21:00:16.237474 [debug] [Thread-2 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m21:00:16.238112 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m21:00:16.239269 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m21:00:16.240080 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m21:00:16.240678 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.obt_orders_per_asin_and_date)
[0m21:00:16.241191 [debug] [Thread-4 (]: Began compiling node model.dbt_project.obt_orders_per_asin_and_date
[0m21:00:16.248407 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.obt_orders_per_asin_and_date"
[0m21:00:16.249897 [debug] [Thread-4 (]: Began executing node model.dbt_project.obt_orders_per_asin_and_date
[0m21:00:16.250495 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m21:00:16.251727 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m21:00:16.253083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:00:16.253619 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m21:00:16.253997 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m21:00:16.254456 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m21:00:16.254958 [debug] [MainThread]: Connection 'model.dbt_project.obt_orders_per_asin_and_date' was properly closed.
[0m21:00:16.256734 [debug] [MainThread]: Command end result
[0m21:00:16.652076 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m21:00:16.657747 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m21:00:16.670479 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m21:00:16.673957 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 8.540116, "process_in_blocks": "0", "process_kernel_time": 1.345543, "process_mem_max_rss": "376733696", "process_out_blocks": "0", "process_user_time": 5.101963}
[0m21:00:16.674938 [debug] [MainThread]: Command `dbt compile` succeeded at 21:00:16.674628 after 8.54 seconds
[0m21:00:16.675628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b95850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146265220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144d17530>]}
[0m21:00:16.676431 [debug] [MainThread]: Flushing usage events
[0m21:00:17.124625 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:13:25.757405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d878f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073955e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b953a0>]}


============================== 22:13:25.765223 | 510981d5-2daa-42ff-acfe-7ef83483cca6 ==============================
[0m22:13:25.765223 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:13:25.766282 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'write_json': 'True', 'log_format': 'default', 'profiles_dir': '/Users/cherry/.dbt', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'partial_parse': 'True', 'empty': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'no_print': 'None', 'invocation_command': 'dbt run', 'introspect': 'True', 'printer_width': '80', 'debug': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'cache_selected_only': 'False'}
[0m22:13:29.449886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106968ce0>]}
[0m22:13:29.543186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107668260>]}
[0m22:13:29.544302 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:13:29.965905 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:13:30.502687 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:13:30.503505 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:13:30.601375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163193680>]}
[0m22:13:30.915089 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:13:30.921122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:13:30.989629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640c3dd0>]}
[0m22:13:30.990461 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:13:30.991352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640af740>]}
[0m22:13:30.996248 [info ] [MainThread]: 
[0m22:13:30.996714 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:30.997256 [info ] [MainThread]: 
[0m22:13:30.998158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:13:31.004994 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:13:31.005873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:13:31.006549 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:31.007296 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:31.008277 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:13:31.010113 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:33.318652 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now create_modern-sublime-383117_dbt_cherry_marts)
[0m22:13:33.319689 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now create_modern-sublime-383117_dbt_cherry_intermediate)
[0m22:13:33.320072 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now create_modern-sublime-383117_dbt_cherry_staging)
[0m22:13:33.320684 [debug] [ThreadPool]: Creating schema "database: "modern-sublime-383117"
schema: "dbt_cherry_marts"
"
[0m22:13:33.321400 [debug] [ThreadPool]: Creating schema "database: "modern-sublime-383117"
schema: "dbt_cherry_intermediate"
"
[0m22:13:33.321958 [debug] [ThreadPool]: Creating schema "database: "modern-sublime-383117"
schema: "dbt_cherry_staging"
"
[0m22:13:33.351422 [debug] [ThreadPool]: On create_modern-sublime-383117_dbt_cherry_intermediate: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_modern-sublime-383117_dbt_cherry_intermediate"} */
create schema if not exists `modern-sublime-383117`.`dbt_cherry_intermediate`
  
[0m22:13:33.352453 [debug] [ThreadPool]: On create_modern-sublime-383117_dbt_cherry_marts: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_modern-sublime-383117_dbt_cherry_marts"} */
create schema if not exists `modern-sublime-383117`.`dbt_cherry_marts`
  
[0m22:13:33.355762 [debug] [ThreadPool]: On create_modern-sublime-383117_dbt_cherry_staging: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "create_modern-sublime-383117_dbt_cherry_staging"} */
create schema if not exists `modern-sublime-383117`.`dbt_cherry_staging`
  
[0m22:13:33.356531 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:33.357024 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:33.357466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:13:33.832098 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:04ff2007-d599-4827-a4dc-9f1d8238550f&page=queryresults
[0m22:13:34.184933 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:22ba4a8c-8fd8-4f36-ad5b-dab84fd62539&page=queryresults
[0m22:13:34.237208 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:f7978a66-ed3d-4b39-b98c-a3cce2e8686e&page=queryresults
[0m22:13:35.123590 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m22:13:35.124211 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:35.125176 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m22:13:35.125770 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m22:13:35.126138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:35.126967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:35.526469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bf6ae0>]}
[0m22:13:35.541155 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:13:35.549428 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:13:35.550207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:13:35.551028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:36.330641 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:0a917394-cd9c-42d4-8af9-b508087d0387&page=queryresults
[0m22:13:37.187038 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.66s]
[0m22:13:37.187686 [info ] [MainThread]: 
[0m22:13:37.195466 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:13:37.196341 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:13:37.197296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:13:37.198251 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:13:37.204295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:13:37.206070 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:13:37.242778 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:13:37.244453 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:13:37.244905 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:37.772162 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:8a7db21b-bb4b-4252-8a80-917b78833a49&page=queryresults
[0m22:13:38.673744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12e96da30>]}
[0m22:13:38.675178 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.47s]
[0m22:13:38.676189 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:13:38.677213 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:13:38.677756 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:13:38.678144 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:13:38.683693 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:13:38.684392 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:13:38.685761 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:13:38.686229 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:13:38.693403 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:13:38.693004 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:13:38.694812 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:13:38.695707 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:13:38.696726 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:13:38.697586 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:13:38.698296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:13:38.698995 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:13:38.723744 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:13:38.725296 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:13:38.726764 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:13:38.727732 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:13:38.728502 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:13:38.729405 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:13:38.729977 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:13:38.756216 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:13:38.757658 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:13:38.763412 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:13:38.765384 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        t1.amazon_order_id,
        t2.order_item_id,
        t1.marketplace,
        t1.sales_channel,
        t2.asin,
        t2.seller_sku,
        t1.order_status,
        t2.quantity_ordered,
        t2.promotion_ids,
        t2.product_info_number_of_items,
        t1.is_replacement_order,
        t2.item_price_amount,
        t2.item_price_currency_code,
        t2.item_tax_amount,
        t2.item_tax_currency_code,
        t2.promotion_discount_tax_amount,
        t2.promotion_discount_tax_currency_code,
        t2.promotion_discount_amount,
        t2.promotion_discount_currency_code,
        t2.tax_collection_model,
        t2.tax_collection_responsible_party,
        t1.is_prime,
        t1.replaced_order_id,
        t2.is_gift,
        t1.tenant_id,
        t1.purchase_date,
        t2.shipping_price_amount,
        t2.shipping_price_currency_code,
        t2.shipping_discount_amount,
        t2.shipping_discount_currency_code,
        t2.buyer_info_gift_wrap_price_amount,
        t2.buyer_info_gift_wrap_price_currency_code

    from orders as t1

    left join order_items as t2
        on t1.amazon_order_id = t2.amazon_order_id

    order by t1.purchase_date desc, t1.tenant_id asc, t1.marketplace desc, t2.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then t2.item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

t3 as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        t1.amazon_order_id,
        t2.order_item_id,

        case
            when
                t1.order_status in ('Pending')
                and t2.item_price_amount is null
                and t1.is_replacement_order = false
                then
                    CAST(t3.prime_price as numeric) * t2.quantity_ordered
            else t2.item_price_amount
        end as item_price_amount

    from orders as t1

    left join order_items as t2
        on t1.amazon_order_id = t2.amazon_order_id

    left join t3
        on
            t2.asin = t3.asin
            and t2.marketplace = t3.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        t1.amazon_order_id,
        t1.order_item_id,
        t2.purchase_datetime,
        t2.purchase_date,
        t1.marketplace,
        t1.sales_channel,
        t1.asin,
        t1.seller_sku,
        t1.order_status,
        t1.quantity_ordered,
        t1.promotion_ids,
        t1.product_info_number_of_items,
        t1.item_price_currency_code,
        t3.item_price_amount,
        t1.item_tax_amount,
        t1.promotion_discount_tax_currency_code,
        t2.output_vat,
        t1.item_tax_currency_code,
        t1.promotion_discount_tax_amount,
        t1.promotion_discount_currency_code,
        t1.promotion_discount_amount,
        t2.coupon_fee,
        t1.tax_collection_model,
        t1.tax_collection_responsible_party,
        t1.is_prime,
        t1.is_replacement_order,
        t1.replaced_order_id,
        t1.is_gift,
        t2.is_vine,
        t1.tenant_id,
        t1.shipping_price_amount,
        t1.shipping_price_currency_code,
        t1.shipping_discount_amount,
        t1.shipping_discount_currency_code,
        t1.buyer_info_gift_wrap_price_amount,
        t1.buyer_info_gift_wrap_price_currency_code

    from joined_orders as t1

    left join fields_to_add as t2
        on t1.order_item_id = t2.order_item_id

    left join with_prime_exclusive_price as t3
        on t1.order_item_id = t3.order_item_id

    order by t1.purchase_datetime desc, t1.tenant_id asc, t1.marketplace desc, t1.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:13:38.766125 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:13:39.391925 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:78a0e456-8e7f-4e6d-9e5a-74605fb5d479&page=queryresults
[0m22:13:39.590755 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:78a0e456-8e7f-4e6d-9e5a-74605fb5d479&page=queryresults
[0m22:13:39.606338 [debug] [Thread-3 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:13:39.607088 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '510981d5-2daa-42ff-acfe-7ef83483cca6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f6150>]}
[0m22:13:39.608192 [error] [Thread-3 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 0.88s]
[0m22:13:39.609081 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:13:39.609923 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:13:39.611939 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:13:39.612966 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:13:39.613613 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:13:39.614591 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:13:39.615367 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:13:39.615843 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:13:39.617413 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:13:39.618265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:39.618721 [debug] [MainThread]: Connection 'create_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:13:39.619103 [debug] [MainThread]: Connection 'create_modern-sublime-383117_dbt_cherry_intermediate' was properly closed.
[0m22:13:39.619529 [debug] [MainThread]: Connection 'create_modern-sublime-383117_dbt_cherry_marts' was properly closed.
[0m22:13:39.620084 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:13:39.620495 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_intermediate' was properly closed.
[0m22:13:39.621056 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:13:39.621443 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:13:39.622058 [info ] [MainThread]: 
[0m22:13:39.622590 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 8.62 seconds (8.62s).
[0m22:13:39.624189 [debug] [MainThread]: Command end result
[0m22:13:40.041009 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:13:40.045610 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:13:40.055141 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:13:40.055782 [info ] [MainThread]: 
[0m22:13:40.056416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:13:40.056976 [info ] [MainThread]: 
[0m22:13:40.057672 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:13:40.058391 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:13:40.058909 [info ] [MainThread]: 
[0m22:13:40.059347 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:13:40.059723 [info ] [MainThread]: 
[0m22:13:40.060296 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:13:40.063390 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 14.408941, "process_in_blocks": "0", "process_kernel_time": 1.353623, "process_mem_max_rss": "380960768", "process_out_blocks": "0", "process_user_time": 5.451571}
[0m22:13:40.064219 [debug] [MainThread]: Command `dbt run` failed at 22:13:40.064080 after 14.41 seconds
[0m22:13:40.064851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162ec78f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1623a7b00>]}
[0m22:13:40.065620 [debug] [MainThread]: Flushing usage events
[0m22:13:40.555462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:25:47.033048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f5c380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077952b0>]}


============================== 22:25:47.041276 | 14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2 ==============================
[0m22:25:47.041276 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:25:47.042515 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'partial_parse': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'cache_selected_only': 'False', 'log_format': 'default', 'empty': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'version_check': 'True', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'debug': 'False', 'profiles_dir': '/Users/cherry/.dbt'}
[0m22:25:51.296008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143769d30>]}
[0m22:25:51.395867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1433a1a00>]}
[0m22:25:51.397067 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:25:51.891503 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:25:52.416614 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:25:52.417632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:25:52.517351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144b80230>]}
[0m22:25:52.828315 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:25:52.833386 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:25:52.902951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144ae7440>]}
[0m22:25:52.904031 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:25:52.904583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x145ebeb70>]}
[0m22:25:52.909637 [info ] [MainThread]: 
[0m22:25:52.910266 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:25:52.910755 [info ] [MainThread]: 
[0m22:25:52.911533 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:25:52.917262 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:25:52.918373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:52.920375 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:25:52.921016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:53.079185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:25:53.083383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:56.581298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_staging)
[0m22:25:56.582202 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_intermediate)
[0m22:25:56.582667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:56.583330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_marts)
[0m22:25:56.583951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:56.584870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:57.817951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10725cb00>]}
[0m22:25:57.833423 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:25:57.840365 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:25:57.841266 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:25:57.841971 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:26:00.812023 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:6c68bd22-ae5b-4224-a968-e3778d782d0f&page=queryresults
[0m22:26:01.330209 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 3.51s]
[0m22:26:01.330833 [info ] [MainThread]: 
[0m22:26:01.336998 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:26:01.338026 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:26:01.338713 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:26:01.339215 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:26:01.346471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:26:01.348010 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:26:01.398710 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:26:01.402075 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:26:01.403078 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:02.016497 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:d44febc5-fdc9-44a6-92a3-5cabf60bda40&page=queryresults
[0m22:26:04.848843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14629baa0>]}
[0m22:26:04.849873 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 3.51s]
[0m22:26:04.850708 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:26:04.851892 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:26:04.852543 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:26:04.853291 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:26:04.853619 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:26:04.854142 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:26:04.861519 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:26:04.862412 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:26:04.869514 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:26:04.870678 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:26:04.872053 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:26:04.873004 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:26:04.874025 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:26:04.874755 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:26:04.875008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:26:04.875245 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:26:04.895760 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:26:04.897056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:26:04.898239 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:26:04.899353 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:26:04.900122 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:26:04.900716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:26:04.901169 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:26:04.927860 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:26:04.929396 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:26:04.937623 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:26:04.938778 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        t1.amazon_order_id,
        t2.order_item_id,
        t1.marketplace,
        t1.sales_channel,
        t2.asin,
        t2.seller_sku,
        t1.order_status,
        t2.quantity_ordered,
        t2.promotion_ids,
        t2.product_info_number_of_items,
        t1.is_replacement_order,
        t2.item_price_amount,
        t2.item_price_currency_code,
        t2.item_tax_amount,
        t2.item_tax_currency_code,
        t2.promotion_discount_tax_amount,
        t2.promotion_discount_tax_currency_code,
        t2.promotion_discount_amount,
        t2.promotion_discount_currency_code,
        t2.tax_collection_model,
        t2.tax_collection_responsible_party,
        t1.is_prime,
        t1.replaced_order_id,
        t2.is_gift,
        t1.tenant_id,
        t1.purchase_date,
        t2.shipping_price_amount,
        t2.shipping_price_currency_code,
        t2.shipping_discount_amount,
        t2.shipping_discount_currency_code,
        t2.buyer_info_gift_wrap_price_amount,
        t2.buyer_info_gift_wrap_price_currency_code

    from orders as t1

    left join order_items as t2
        on t1.amazon_order_id = t2.amazon_order_id

    order by t1.purchase_date desc, t1.tenant_id asc, t1.marketplace desc, t2.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then t2.item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        orders.amazon_order_id,
        order_items.order_item_id,

        case
            when
                orders.order_status in ('Pending')
                and order_items.item_price_amount is null
                and orders.is_replacement_order = false
                then
                    CAST(prime_prices.prime_price as numeric) * order_items.quantity_ordered
            else order_items.item_price_amount
        end as item_price_amount

    from orders

    left join order_items
        on orders.amazon_order_id = order_items.amazon_order_id

    left join prime_prices
        on
            order_items.asin = prime_prices.asin
            and order_items.marketplace = prime_prices.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        t1.amazon_order_id,
        t1.order_item_id,
        t2.purchase_datetime,
        t2.purchase_date,
        t1.marketplace,
        t1.sales_channel,
        t1.asin,
        t1.seller_sku,
        t1.order_status,
        t1.quantity_ordered,
        t1.promotion_ids,
        t1.product_info_number_of_items,
        t1.item_price_currency_code,
        t3.item_price_amount,
        t1.item_tax_amount,
        t1.promotion_discount_tax_currency_code,
        t2.output_vat,
        t1.item_tax_currency_code,
        t1.promotion_discount_tax_amount,
        t1.promotion_discount_currency_code,
        t1.promotion_discount_amount,
        t2.coupon_fee,
        t1.tax_collection_model,
        t1.tax_collection_responsible_party,
        t1.is_prime,
        t1.is_replacement_order,
        t1.replaced_order_id,
        t1.is_gift,
        t2.is_vine,
        t1.tenant_id,
        t1.shipping_price_amount,
        t1.shipping_price_currency_code,
        t1.shipping_discount_amount,
        t1.shipping_discount_currency_code,
        t1.buyer_info_gift_wrap_price_amount,
        t1.buyer_info_gift_wrap_price_currency_code

    from joined_orders as t1

    left join fields_to_add as t2
        on t1.order_item_id = t2.order_item_id

    left join with_prime_exclusive_price as t3
        on t1.order_item_id = t3.order_item_id

    order by t1.purchase_datetime desc, t1.tenant_id asc, t1.marketplace desc, t1.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:26:04.939810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:26:06.519777 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:48d4ad0b-b597-4797-ad3b-21c744bb8769&page=queryresults
[0m22:26:06.721165 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:48d4ad0b-b597-4797-ad3b-21c744bb8769&page=queryresults
[0m22:26:06.736239 [debug] [Thread-3 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:26:06.737016 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14a0a0b6-b597-4e6c-9f73-1b9aef93f1e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146780050>]}
[0m22:26:06.738176 [error] [Thread-3 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 1.84s]
[0m22:26:06.738772 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:26:06.739699 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:26:06.741311 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:26:06.741753 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:26:06.742367 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:26:06.743018 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:26:06.743631 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:26:06.744311 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:26:06.745352 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:26:06.746055 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:26:06.746667 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:26:06.747105 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_intermediate' was properly closed.
[0m22:26:06.747501 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:26:06.747841 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:26:06.748543 [info ] [MainThread]: 
[0m22:26:06.749011 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 13.84 seconds (13.84s).
[0m22:26:06.750479 [debug] [MainThread]: Command end result
[0m22:26:07.193864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:26:07.198617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:26:07.207858 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:26:07.208328 [info ] [MainThread]: 
[0m22:26:07.209070 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:26:07.209568 [info ] [MainThread]: 
[0m22:26:07.210325 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:26:07.210994 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:26:07.211489 [info ] [MainThread]: 
[0m22:26:07.211942 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:26:07.212280 [info ] [MainThread]: 
[0m22:26:07.212704 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:26:07.216504 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.29691, "process_in_blocks": "0", "process_kernel_time": 1.422532, "process_mem_max_rss": "369901568", "process_out_blocks": "0", "process_user_time": 5.70933}
[0m22:26:07.217453 [debug] [MainThread]: Command `dbt run` failed at 22:26:07.217278 after 20.30 seconds
[0m22:26:07.218141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077953d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13fff2420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x144a21a30>]}
[0m22:26:07.218703 [debug] [MainThread]: Flushing usage events
[0m22:26:07.729251 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:30:36.119744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109100e00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099957c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099954f0>]}


============================== 22:30:36.128114 | ab460eca-cc5f-42d3-aa79-3daccd4d22ca ==============================
[0m22:30:36.128114 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:30:36.129000 [debug] [MainThread]: running dbt with arguments {'profiles_dir': '/Users/cherry/.dbt', 'cache_selected_only': 'False', 'introspect': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'fail_fast': 'False', 'invocation_command': 'dbt run', 'use_colors': 'True', 'partial_parse': 'True', 'write_json': 'True', 'empty': 'False', 'quiet': 'False', 'printer_width': '80', 'indirect_selection': 'eager', 'debug': 'False', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'version_check': 'True', 'log_cache_events': 'False', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'target_path': 'None'}
[0m22:30:39.799327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d2e1850>]}
[0m22:30:39.897166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cf66570>]}
[0m22:30:39.898180 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:30:40.436668 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:30:40.956483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:30:40.956947 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:30:41.050821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13d668d70>]}
[0m22:30:41.363380 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:30:41.368546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:30:41.441816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13dbcc6b0>]}
[0m22:30:41.442575 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:30:41.443218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13cfbe510>]}
[0m22:30:41.447003 [info ] [MainThread]: 
[0m22:30:41.447369 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:30:41.448016 [info ] [MainThread]: 
[0m22:30:41.448853 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:30:41.455697 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:30:41.456622 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:30:41.457245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:41.457954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:41.458702 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:30:41.459670 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:43.323420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m22:30:43.324479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:43.325051 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m22:30:43.326317 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m22:30:43.327287 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:43.327859 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:30:43.816883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13db2c320>]}
[0m22:30:43.832682 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:30:43.840373 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:30:43.841215 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:30:43.841504 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:30:44.282744 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:f6b02de4-5ae1-4096-80d9-db93a4ebea0f&page=queryresults
[0m22:30:44.786049 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 0.97s]
[0m22:30:44.786841 [info ] [MainThread]: 
[0m22:30:44.793134 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:30:44.794117 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:30:44.794913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:30:44.795470 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:30:44.801946 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:30:44.803171 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:30:44.851869 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:30:44.853526 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:30:44.854514 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:45.361366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:b265e722-ea6e-4d2d-85f6-daa26893b9ac&page=queryresults
[0m22:30:45.926732 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e869ca0>]}
[0m22:30:45.927960 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m22:30:45.928671 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:30:45.929718 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:30:45.930373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:30:45.930916 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:30:45.931410 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:30:45.931983 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:30:45.938401 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:30:45.939080 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:30:45.945269 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:30:45.946585 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:45.947546 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:30:45.948056 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:30:45.949490 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:30:45.950503 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:30:45.951335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:30:45.952018 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:30:45.976339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:30:45.977872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:30:45.979240 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:30:45.980370 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:30:45.981285 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:30:45.981943 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:30:45.982331 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:30:46.008040 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:30:46.009250 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:30:46.018448 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:30:46.020166 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        t1.amazon_order_id,
        t2.order_item_id,
        t1.marketplace,
        t1.sales_channel,
        t2.asin,
        t2.seller_sku,
        t1.order_status,
        t2.quantity_ordered,
        t2.promotion_ids,
        t2.product_info_number_of_items,
        t1.is_replacement_order,
        t2.item_price_amount,
        t2.item_price_currency_code,
        t2.item_tax_amount,
        t2.item_tax_currency_code,
        t2.promotion_discount_tax_amount,
        t2.promotion_discount_tax_currency_code,
        t2.promotion_discount_amount,
        t2.promotion_discount_currency_code,
        t2.tax_collection_model,
        t2.tax_collection_responsible_party,
        t1.is_prime,
        t1.replaced_order_id,
        t2.is_gift,
        t1.tenant_id,
        t1.purchase_date,
        t2.shipping_price_amount,
        t2.shipping_price_currency_code,
        t2.shipping_discount_amount,
        t2.shipping_discount_currency_code,
        t2.buyer_info_gift_wrap_price_amount,
        t2.buyer_info_gift_wrap_price_currency_code

    from orders as t1

    left join order_items as t2
        on t1.amazon_order_id = t2.amazon_order_id

    order by t1.purchase_date desc, t1.tenant_id asc, t1.marketplace desc, t2.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then t2.item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        orders.amazon_order_id,
        order_items.order_item_id,

        case
            when
                orders.order_status in ('Pending')
                and order_items.item_price_amount is null
                and orders.is_replacement_order = false
                then
                    CAST(prime_prices.prime_price as numeric) * order_items.quantity_ordered
            else order_items.item_price_amount
        end as item_price_amount

    from orders

    left join order_items
        on orders.amazon_order_id = order_items.amazon_order_id

    left join prime_prices
        on
            order_items.asin = prime_prices.asin
            and order_items.marketplace = prime_prices.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        t1.amazon_order_id,
        t1.order_item_id,
        t2.purchase_datetime,
        t2.purchase_date,
        t1.marketplace,
        t1.sales_channel,
        t1.asin,
        t1.seller_sku,
        t1.order_status,
        t1.quantity_ordered,
        t1.promotion_ids,
        t1.product_info_number_of_items,
        t1.item_price_currency_code,
        t3.item_price_amount,
        t1.item_tax_amount,
        t1.promotion_discount_tax_currency_code,
        t2.output_vat,
        t1.item_tax_currency_code,
        t1.promotion_discount_tax_amount,
        t1.promotion_discount_currency_code,
        t1.promotion_discount_amount,
        t2.coupon_fee,
        t1.tax_collection_model,
        t1.tax_collection_responsible_party,
        t1.is_prime,
        t1.is_replacement_order,
        t1.replaced_order_id,
        t1.is_gift,
        t2.is_vine,
        t1.tenant_id,
        t1.shipping_price_amount,
        t1.shipping_price_currency_code,
        t1.shipping_discount_amount,
        t1.shipping_discount_currency_code,
        t1.buyer_info_gift_wrap_price_amount,
        t1.buyer_info_gift_wrap_price_currency_code

    from joined_orders as t1

    left join fields_to_add as t2
        on t1.order_item_id = t2.order_item_id

    left join with_prime_exclusive_price as t3
        on t1.order_item_id = t3.order_item_id

    order by t1.purchase_datetime desc, t1.tenant_id asc, t1.marketplace desc, t1.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:30:46.021108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:30:46.686655 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:83402e0a-30ce-42c4-be25-31a021cecbfc&page=queryresults
[0m22:30:46.892161 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:83402e0a-30ce-42c4-be25-31a021cecbfc&page=queryresults
[0m22:30:46.906875 [debug] [Thread-3 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:30:46.907766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab460eca-cc5f-42d3-aa79-3daccd4d22ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ef8e300>]}
[0m22:30:46.908724 [error] [Thread-3 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 0.93s]
[0m22:30:46.909784 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:30:46.910812 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:30:46.912746 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:30:46.913374 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:30:46.913916 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:30:46.914627 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:30:46.915208 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:30:46.915872 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:30:46.917260 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:30:46.918161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:30:46.918636 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:30:46.919048 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:30:46.919486 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:30:46.919947 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:30:46.920327 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:30:46.920661 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:30:46.921077 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:30:46.921898 [info ] [MainThread]: 
[0m22:30:46.922456 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 5.47 seconds (5.47s).
[0m22:30:46.924202 [debug] [MainThread]: Command end result
[0m22:30:47.337892 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:30:47.342377 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:30:47.351956 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:30:47.352483 [info ] [MainThread]: 
[0m22:30:47.353200 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:30:47.353709 [info ] [MainThread]: 
[0m22:30:47.354122 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:30:47.354469 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:30:47.355066 [info ] [MainThread]: 
[0m22:30:47.355645 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:30:47.356168 [info ] [MainThread]: 
[0m22:30:47.356616 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:30:47.359586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 11.353661, "process_in_blocks": "0", "process_kernel_time": 1.377833, "process_mem_max_rss": "382189568", "process_out_blocks": "0", "process_user_time": 5.378521}
[0m22:30:47.360373 [debug] [MainThread]: Command `dbt run` failed at 22:30:47.360211 after 11.35 seconds
[0m22:30:47.361105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099955e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091e3c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ed66f30>]}
[0m22:30:47.361528 [debug] [MainThread]: Flushing usage events
[0m22:30:47.916107 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:33:55.743268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11026dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b95730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b95460>]}


============================== 22:33:55.751432 | 9b264f34-d517-4e95-ae9c-845cca215b51 ==============================
[0m22:33:55.751432 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:33:55.752288 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'write_json': 'True', 'static_parser': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True', 'empty': 'False', 'use_experimental_parser': 'False', 'target_path': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs'}
[0m22:33:59.878821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cd6180>]}
[0m22:33:59.983590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110768080>]}
[0m22:33:59.984734 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:34:00.504476 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:34:01.032653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:34:01.033332 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:34:01.131321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eabd70>]}
[0m22:34:01.447055 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:34:01.452389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:34:01.524040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164c59040>]}
[0m22:34:01.524895 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:34:01.525746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x163bbede0>]}
[0m22:34:01.530594 [info ] [MainThread]: 
[0m22:34:01.531366 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:34:01.531892 [info ] [MainThread]: 
[0m22:34:01.532828 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:34:01.539389 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:34:01.540138 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:34:01.540373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:01.540663 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:34:01.541158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:01.541697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:34:03.699710 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_intermediate)
[0m22:34:03.700659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:03.701368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_staging)
[0m22:34:03.702654 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_marts)
[0m22:34:03.703910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:03.704605 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:34:04.032844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110bfab10>]}
[0m22:34:04.051139 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:34:04.059323 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:34:04.060421 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:34:04.061311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:34:04.599808 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:1f0a3fea-098c-4444-9dc7-42b0b9826641&page=queryresults
[0m22:34:05.059009 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.02s]
[0m22:34:05.059647 [info ] [MainThread]: 
[0m22:34:05.068070 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:34:05.069730 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:34:05.071000 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:34:05.071970 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:34:05.080082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:34:05.081801 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:34:05.139627 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:34:05.141129 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:34:05.141987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:05.789351 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:e39f839d-1ff1-46c6-8683-1215ec4df10d&page=queryresults
[0m22:34:06.347268 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164864620>]}
[0m22:34:06.348451 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.27s]
[0m22:34:06.349451 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:34:06.350783 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:34:06.351176 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:34:06.351717 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:34:06.352816 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:34:06.353349 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:34:06.353707 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:34:06.360968 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:34:06.366571 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:34:06.367619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:06.368035 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:34:06.369327 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:34:06.370179 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:34:06.371038 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:34:06.371595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:34:06.372293 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:34:06.396017 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:34:06.397238 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:34:06.398330 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:34:06.399097 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:34:06.399773 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:34:06.400428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:34:06.400696 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:34:06.426441 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:34:06.427497 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:34:06.436367 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:34:06.438362 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        t1.amazon_order_id,
        t2.order_item_id,
        t1.marketplace,
        t1.sales_channel,
        t2.asin,
        t2.seller_sku,
        t1.order_status,
        t2.quantity_ordered,
        t2.promotion_ids,
        t2.product_info_number_of_items,
        t1.is_replacement_order,
        t2.item_price_amount,
        t2.item_price_currency_code,
        t2.item_tax_amount,
        t2.item_tax_currency_code,
        t2.promotion_discount_tax_amount,
        t2.promotion_discount_tax_currency_code,
        t2.promotion_discount_amount,
        t2.promotion_discount_currency_code,
        t2.tax_collection_model,
        t2.tax_collection_responsible_party,
        t1.is_prime,
        t1.replaced_order_id,
        t2.is_gift,
        t1.tenant_id,
        t1.purchase_date,
        t2.shipping_price_amount,
        t2.shipping_price_currency_code,
        t2.shipping_discount_amount,
        t2.shipping_discount_currency_code,
        t2.buyer_info_gift_wrap_price_amount,
        t2.buyer_info_gift_wrap_price_currency_code

    from orders as t1

    left join order_items as t2
        on t1.amazon_order_id = t2.amazon_order_id

    order by t1.purchase_date desc, t1.tenant_id asc, t1.marketplace desc, t2.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then t2.item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        orders.amazon_order_id,
        order_items.order_item_id,

        case
            when
                orders.order_status in ('Pending')
                and order_items.item_price_amount is null
                and orders.is_replacement_order = false
                then
                    CAST(prime_prices.prime_price as numeric) * order_items.quantity_ordered
            else order_items.item_price_amount
        end as item_price_amount

    from orders

    left join order_items
        on orders.amazon_order_id = order_items.amazon_order_id

    left join prime_prices
        on
            order_items.asin = prime_prices.asin
            and order_items.marketplace = prime_prices.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        joined_orders.amazon_order_id,
        joined_orders.order_item_id,
        fields_to_add.purchase_datetime,
        fields_to_add.purchase_date,
        joined_orders.marketplace,
        joined_orders.sales_channel,
        joined_orders.asin,
        joined_orders.seller_sku,
        joined_orders.order_status,
        joined_orders.quantity_ordered,
        joined_orders.promotion_ids,
        joined_orders.product_info_number_of_items,
        joined_orders.item_price_currency_code,
        prime.item_price_amount,
        joined_orders.item_tax_amount,
        joined_orders.promotion_discount_tax_currency_code,
        fields_to_add.output_vat,
        joined_orders.item_tax_currency_code,
        joined_orders.promotion_discount_tax_amount,
        joined_orders.promotion_discount_currency_code,
        joined_orders.promotion_discount_amount,
        fields_to_add.coupon_fee,
        joined_orders.tax_collection_model,
        joined_orders.tax_collection_responsible_party,
        joined_orders.is_prime,
        joined_orders.is_replacement_order,
        joined_orders.replaced_order_id,
        joined_orders.is_gift,
        fields_to_add.is_vine,
        joined_orders.tenant_id,
        joined_orders.shipping_price_amount,
        joined_orders.shipping_price_currency_code,
        joined_orders.shipping_discount_amount,
        joined_orders.shipping_discount_currency_code,
        joined_orders.buyer_info_gift_wrap_price_amount,
        joined_orders.buyer_info_gift_wrap_price_currency_code

    from joined_orders

    left join fields_to_add
        on joined_orders.order_item_id = fields_to_add.order_item_id

    left join with_prime_exclusive_price as prime
        on joined_orders.order_item_id = prime.order_item_id

    order by joined_orders.purchase_datetime desc, joined_orders.tenant_id asc, joined_orders.marketplace desc, joined_orders.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:34:06.439810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:34:07.161638 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:2f123cc5-bcfc-4cdb-a9ab-a71d57c99cd6&page=queryresults
[0m22:34:07.391031 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:2f123cc5-bcfc-4cdb-a9ab-a71d57c99cd6&page=queryresults
[0m22:34:07.405958 [debug] [Thread-3 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:34:07.406898 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9b264f34-d517-4e95-ae9c-845cca215b51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165b894c0>]}
[0m22:34:07.407966 [error] [Thread-3 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 1.01s]
[0m22:34:07.408874 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:34:07.409580 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:34:07.411420 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:34:07.412233 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:34:07.412862 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:34:07.413317 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:34:07.413977 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:34:07.414780 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:34:07.416185 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:34:07.416809 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:34:07.417479 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:34:07.418015 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:34:07.418533 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:34:07.418903 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:34:07.419445 [info ] [MainThread]: 
[0m22:34:07.420016 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m22:34:07.421766 [debug] [MainThread]: Command end result
[0m22:34:07.870469 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:34:07.876228 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:34:07.887191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:34:07.887822 [info ] [MainThread]: 
[0m22:34:07.888174 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:34:07.889061 [info ] [MainThread]: 
[0m22:34:07.889918 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:34:07.890502 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: t2 at [102:22]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:34:07.891020 [info ] [MainThread]: 
[0m22:34:07.891533 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:34:07.892080 [info ] [MainThread]: 
[0m22:34:07.892890 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:34:07.896605 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.298934, "process_in_blocks": "0", "process_kernel_time": 1.395157, "process_mem_max_rss": "378126336", "process_out_blocks": "0", "process_user_time": 5.651676}
[0m22:34:07.897485 [debug] [MainThread]: Command `dbt run` failed at 22:34:07.897304 after 12.30 seconds
[0m22:34:07.898027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b95520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c687d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x165042ab0>]}
[0m22:34:07.898438 [debug] [MainThread]: Flushing usage events
[0m22:34:08.428802 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:54:28.551472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e43dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a095e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f95340>]}


============================== 22:54:28.560201 | fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1 ==============================
[0m22:54:28.560201 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:54:28.561378 [debug] [MainThread]: running dbt with arguments {'use_experimental_parser': 'False', 'version_check': 'True', 'static_parser': 'True', 'use_colors': 'True', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'partial_parse': 'True', 'quiet': 'False', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'profiles_dir': '/Users/cherry/.dbt', 'log_format': 'default', 'no_print': 'None', 'warn_error': 'None', 'debug': 'False', 'printer_width': '80'}
[0m22:54:32.209623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161191430>]}
[0m22:54:32.304115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee28b60>]}
[0m22:54:32.305188 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:54:32.785209 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:54:33.306552 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:54:33.307427 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:54:33.403040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1612c2930>]}
[0m22:54:33.730094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:54:33.735644 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:54:33.804323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1619c4b90>]}
[0m22:54:33.805406 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:54:33.805969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1600291c0>]}
[0m22:54:33.810490 [info ] [MainThread]: 
[0m22:54:33.810874 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:33.811407 [info ] [MainThread]: 
[0m22:54:33.812314 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:54:33.820938 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:54:33.822133 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:54:33.822631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:33.823489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:54:33.824121 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:33.825051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:35.731440 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m22:54:35.732267 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m22:54:35.732800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:35.733703 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m22:54:35.734123 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:35.735736 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:36.087627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105818b60>]}
[0m22:54:36.102988 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:54:36.110932 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:54:36.111664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:54:36.112186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:36.830876 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:1ccfad32-84c6-4357-873b-27b8ba7ca5ad&page=queryresults
[0m22:54:37.304746 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.22s]
[0m22:54:37.305233 [info ] [MainThread]: 
[0m22:54:37.311291 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:54:37.311774 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:54:37.312469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:54:37.312961 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:54:37.319985 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:54:37.321377 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:54:37.368578 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:54:37.369922 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:54:37.370749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:37.924545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:2268c27f-b390-42c5-a2f0-4e60cee7b23d&page=queryresults
[0m22:54:39.287916 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13ee65fa0>]}
[0m22:54:39.289026 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.97s]
[0m22:54:39.290215 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:54:39.291622 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:54:39.292239 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:54:39.292827 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:54:39.293525 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:54:39.294182 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:54:39.300737 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:54:39.301551 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:54:39.307295 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:54:39.307990 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:39.308959 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:54:39.309645 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:54:39.310632 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:54:39.311399 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:54:39.311840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:54:39.312439 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:54:39.335769 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:54:39.336773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:54:39.338028 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:54:39.339004 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:54:39.339541 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:54:39.340337 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:54:39.340677 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:54:39.365387 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:54:39.366916 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:54:39.374727 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:54:39.376411 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on joined_orders.order_item_id = fields_to_add.order_item_id

    left join with_prime_exclusive_price as prime
        on joined_orders.order_item_id = prime.order_item_id

    order by joined_orders.purchase_datetime desc, joined_orders.tenant_id asc, joined_orders.marketplace desc, joined_orders.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:54:39.377627 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:54:40.161434 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c380d6a8-1e86-4723-acb5-d2250d6270a5&page=queryresults
[0m22:54:40.381258 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c380d6a8-1e86-4723-acb5-d2250d6270a5&page=queryresults
[0m22:54:40.397243 [debug] [Thread-3 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: joined_orders at [274:12]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:54:40.398196 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcda8195-2e6d-49aa-a8ca-3faa4fc9a8c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x162d92db0>]}
[0m22:54:40.399220 [error] [Thread-3 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 1.06s]
[0m22:54:40.400111 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:54:40.401083 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: joined_orders at [274:12]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:54:40.402145 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:54:40.402926 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:54:40.403837 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:54:40.404517 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:54:40.404807 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:54:40.405846 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:54:40.407280 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:54:40.408082 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:40.408293 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:54:40.408656 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:54:40.409096 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:54:40.409511 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:54:40.409687 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:54:40.410075 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:54:40.410488 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:54:40.411085 [info ] [MainThread]: 
[0m22:54:40.411617 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 6.60 seconds (6.60s).
[0m22:54:40.413276 [debug] [MainThread]: Command end result
[0m22:54:40.795524 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:54:40.799360 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:54:40.808060 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:54:40.808486 [info ] [MainThread]: 
[0m22:54:40.808847 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:54:40.809101 [info ] [MainThread]: 
[0m22:54:40.809636 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:54:40.810374 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: joined_orders at [274:12]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:54:40.810642 [info ] [MainThread]: 
[0m22:54:40.811237 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:54:40.811711 [info ] [MainThread]: 
[0m22:54:40.812294 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:54:40.815421 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.370733, "process_in_blocks": "0", "process_kernel_time": 1.335853, "process_mem_max_rss": "382091264", "process_out_blocks": "0", "process_user_time": 5.354251}
[0m22:54:40.816173 [debug] [MainThread]: Command `dbt run` failed at 22:54:40.816047 after 12.37 seconds
[0m22:54:40.816772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050c7920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160bc03e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1611e7a10>]}
[0m22:54:40.817350 [debug] [MainThread]: Flushing usage events
[0m22:54:41.365465 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:55:40.860663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e87950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059956d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059953d0>]}


============================== 22:55:40.941493 | f999ced9-6c51-4b20-9665-eb06c85d89d7 ==============================
[0m22:55:40.941493 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:55:40.948709 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'introspect': 'True', 'log_format': 'default', 'fail_fast': 'False', 'static_parser': 'True', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_colors': 'True', 'quiet': 'False', 'empty': 'False', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'write_json': 'True', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False'}
[0m22:55:44.795877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f4835f0>]}
[0m22:55:44.893738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f59f740>]}
[0m22:55:44.894769 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:55:45.377787 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:55:45.889712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:55:45.890551 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:55:45.981565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151e66060>]}
[0m22:55:46.301598 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:55:46.307390 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:55:46.372398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533c4ad0>]}
[0m22:55:46.373226 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:55:46.373983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1536d2f90>]}
[0m22:55:46.378288 [info ] [MainThread]: 
[0m22:55:46.378937 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:46.379398 [info ] [MainThread]: 
[0m22:55:46.380153 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:55:46.388892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:55:46.389556 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:46.400161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:55:46.402547 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:55:46.403072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:46.403886 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:48.014012 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m22:55:48.015033 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m22:55:48.016048 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:48.017080 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m22:55:48.017764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:48.018620 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:49.950119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1533c4ad0>]}
[0m22:55:49.969968 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:55:49.981283 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:55:49.982609 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:55:49.983890 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:50.626982 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:56a9e31d-39ac-4f4d-a6cb-bd541bfdcb3b&page=queryresults
[0m22:55:51.089579 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.14s]
[0m22:55:51.090577 [info ] [MainThread]: 
[0m22:55:51.097840 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:55:51.098879 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:55:51.099591 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:55:51.100141 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:55:51.109640 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:55:51.111213 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:55:51.165702 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:55:51.168040 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:55:51.169057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:51.829243 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c1e669a1-4351-4191-9a89-5668e4666e26&page=queryresults
[0m22:55:52.314292 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x13c2660c0>]}
[0m22:55:52.315071 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.21s]
[0m22:55:52.316134 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:55:52.317318 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:55:52.317890 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:55:52.318801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:55:52.319732 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:55:52.320306 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:55:52.321284 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:55:52.328737 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:55:52.336031 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:55:52.336595 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:55:52.337159 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:55:52.337844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:55:52.338680 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:55:52.339677 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:55:52.340377 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:55:52.341072 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:55:52.364801 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:55:52.365804 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:55:52.367099 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:55:52.368096 [debug] [Thread-4 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:55:52.368971 [info ] [Thread-4 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:55:52.369720 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:55:52.371019 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:55:52.398882 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:55:52.400262 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:55:52.409384 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:55:52.411310 [debug] [Thread-4 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on jo.order_item_id = fields_to_add.order_item_id

    left join with_prime_exclusive_price as prime
        on jo.order_item_id = prime.order_item_id

    order by jo.purchase_datetime desc, jo.tenant_id asc, jo.marketplace desc, jo.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:55:52.413023 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:55:53.569854 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:54af2daf-18bc-4b99-8cb6-e2dd498b2577&page=queryresults
[0m22:55:53.827604 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:54af2daf-18bc-4b99-8cb6-e2dd498b2577&page=queryresults
[0m22:55:53.839588 [debug] [Thread-4 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: fields_to_add at [274:31]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:55:53.840631 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f999ced9-6c51-4b20-9665-eb06c85d89d7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x153f8b110>]}
[0m22:55:53.841652 [error] [Thread-4 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 1.47s]
[0m22:55:53.842726 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:55:53.843548 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: fields_to_add at [274:31]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:55:53.845475 [debug] [Thread-3 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:55:53.846315 [info ] [Thread-3 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:55:53.847075 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:55:53.847756 [debug] [Thread-2 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:55:53.848205 [info ] [Thread-2 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:55:53.848828 [debug] [Thread-2 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:55:53.850356 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:55:53.851125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:53.851628 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:55:53.852106 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:55:53.852343 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m22:55:53.852652 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:55:53.853228 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:55:53.853682 [debug] [MainThread]: Connection 'model.dbt_project.int_get_prime_exclusive_price_for_new_orders' was properly closed.
[0m22:55:53.854028 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:55:53.854891 [info ] [MainThread]: 
[0m22:55:53.855537 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 7.47 seconds (7.47s).
[0m22:55:53.857005 [debug] [MainThread]: Command end result
[0m22:55:54.333942 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:55:54.339166 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:55:54.349322 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:55:54.350108 [info ] [MainThread]: 
[0m22:55:54.350962 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:55:54.351543 [info ] [MainThread]: 
[0m22:55:54.352148 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:55:54.352945 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Unrecognized name: fields_to_add at [274:31]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:55:54.353453 [info ] [MainThread]: 
[0m22:55:54.354380 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:55:54.354922 [info ] [MainThread]: 
[0m22:55:54.355523 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:55:54.359910 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.639611, "process_in_blocks": "0", "process_kernel_time": 1.319477, "process_mem_max_rss": "375783424", "process_out_blocks": "0", "process_user_time": 5.751543}
[0m22:55:54.360953 [debug] [MainThread]: Command `dbt run` failed at 22:55:54.360760 after 13.64 seconds
[0m22:55:54.361614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059954c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151baeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x151c9a420>]}
[0m22:55:54.362178 [debug] [MainThread]: Flushing usage events
[0m22:55:54.820445 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:57:44.635283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059952e0>]}


============================== 22:57:44.643649 | 9402aaa2-bcaa-42de-b719-2c299d1b47de ==============================
[0m22:57:44.643649 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:57:44.644847 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'introspect': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'fail_fast': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'write_json': 'True', 'log_format': 'default', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/Users/cherry/.dbt', 'target_path': 'None', 'log_cache_events': 'False', 'use_colors': 'True', 'debug': 'False', 'printer_width': '80', 'cache_selected_only': 'False', 'no_print': 'None', 'partial_parse': 'True'}
[0m22:57:48.693430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10291a3f0>]}
[0m22:57:48.809868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10238de20>]}
[0m22:57:48.811124 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:57:49.338576 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:57:50.183121 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:57:50.185082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:57:50.334886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161a8f8f0>]}
[0m22:57:50.679702 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:57:50.685335 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:57:50.765471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624c6d80>]}
[0m22:57:50.766236 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:57:50.767060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161cc12b0>]}
[0m22:57:50.770538 [info ] [MainThread]: 
[0m22:57:50.771364 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:50.772657 [info ] [MainThread]: 
[0m22:57:50.773011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:57:50.779924 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:57:50.780582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:50.781897 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:57:50.782427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:50.797918 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:57:50.800302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:52.760394 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_marts)
[0m22:57:52.761458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_staging)
[0m22:57:52.762123 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_intermediate)
[0m22:57:52.762707 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:52.763202 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:52.763582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:57:53.847703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x161c99ca0>]}
[0m22:57:53.865245 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:57:53.874234 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:57:53.875041 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:57:53.875621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:54.323508 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:4616c28e-2614-4461-9d43-ffe2658f86d3&page=queryresults
[0m22:57:54.812984 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 0.96s]
[0m22:57:54.813859 [info ] [MainThread]: 
[0m22:57:54.821233 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:57:54.822381 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:57:54.823119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:57:54.824214 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:57:54.832064 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:57:54.833641 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:57:54.889011 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:57:54.891181 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:57:54.892568 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:55.445554 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c657ba0e-a1f0-44e0-8dce-2eb37051df1b&page=queryresults
[0m22:57:55.950866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14f065e20>]}
[0m22:57:55.952030 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.13s]
[0m22:57:55.952877 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:57:55.953846 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:57:55.954413 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:57:55.955092 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:57:55.955938 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:57:55.956685 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:57:55.957119 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:57:55.963801 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:57:55.970284 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:57:55.971108 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:57:55.972566 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:57:55.973335 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:57:55.974460 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:57:55.975084 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:57:55.975778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:57:55.976168 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:57:55.999856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:57:56.001064 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:57:56.002487 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:57:56.003237 [debug] [Thread-4 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:57:56.003539 [info ] [Thread-4 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:57:56.004126 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:57:56.004696 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:57:56.027777 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:57:56.029167 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:57:56.038072 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:57:56.039656 [debug] [Thread-4 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on jo.order_item_id = fta.order_item_id

    left join with_prime_exclusive_price as prime
        on jo.order_item_id = prime.order_item_id

    order by jo.purchase_datetime desc, jo.tenant_id asc, jo.marketplace desc, jo.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:57:56.040543 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m22:57:57.396214 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:1ded36d5-6706-441c-b84b-75af15e281c3&page=queryresults
[0m22:57:57.608566 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:1ded36d5-6706-441c-b84b-75af15e281c3&page=queryresults
[0m22:57:57.622783 [debug] [Thread-4 (]: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Name purchase_datetime not found inside jo at [279:17]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:57:57.623274 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9402aaa2-bcaa-42de-b719-2c299d1b47de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16307e3f0>]}
[0m22:57:57.624011 [error] [Thread-4 (]: 2 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[31mERROR[0m in 1.62s]
[0m22:57:57.625096 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:57:57.626028 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_add_fields_to_joined_orders' to be skipped because of status 'error'.  Reason: Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Name purchase_datetime not found inside jo at [279:17]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql.
[0m22:57:57.628447 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:57:57.629131 [info ] [Thread-2 (]: 3 of 4 SKIP relation dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[33mSKIP[0m]
[0m22:57:57.629741 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:57:57.630304 [debug] [Thread-3 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:57:57.631391 [info ] [Thread-3 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:57:57.632219 [debug] [Thread-3 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:57:57.633411 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:57:57.634259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:57.634889 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:57:57.635553 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_staging' was properly closed.
[0m22:57:57.635964 [debug] [MainThread]: Connection 'model.dbt_project.int_get_prime_exclusive_price_for_new_orders' was properly closed.
[0m22:57:57.636340 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:57:57.636819 [info ] [MainThread]: 
[0m22:57:57.637539 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m22:57:57.638719 [debug] [MainThread]: Command end result
[0m22:57:58.147800 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:57:58.154204 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:57:58.166193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:57:58.167212 [info ] [MainThread]: 
[0m22:57:58.168016 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:57:58.168627 [info ] [MainThread]: 
[0m22:57:58.169266 [error] [MainThread]: [31mFailure in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)[0m
[0m22:57:58.169912 [error] [MainThread]:   Database Error in model int_add_fields_to_joined_orders (models/intermediate/sales/int_add_fields_to_joined_orders.sql)
  Name purchase_datetime not found inside jo at [279:17]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:57:58.170492 [info ] [MainThread]: 
[0m22:57:58.171311 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_add_fields_to_joined_orders.sql
[0m22:57:58.171790 [info ] [MainThread]: 
[0m22:57:58.172279 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=5
[0m22:57:58.180887 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 13.663622, "process_in_blocks": "0", "process_kernel_time": 1.431795, "process_mem_max_rss": "378454016", "process_out_blocks": "0", "process_user_time": 5.663511}
[0m22:57:58.181768 [debug] [MainThread]: Command `dbt run` failed at 22:57:58.181611 after 13.66 seconds
[0m22:57:58.182356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059953a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15f473bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x160aadc40>]}
[0m22:57:58.183141 [debug] [MainThread]: Flushing usage events
[0m22:57:58.726391 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:59:14.094593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10631f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95430>]}


============================== 22:59:14.102852 | fa1addd9-c1cb-4fab-843b-dae219605318 ==============================
[0m22:59:14.102852 [info ] [MainThread]: Running with dbt=1.10.13
[0m22:59:14.103853 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'quiet': 'False', 'printer_width': '80', 'fail_fast': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'write_json': 'True', 'introspect': 'True', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'no_print': 'None', 'log_format': 'default', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'use_colors': 'True', 'empty': 'False', 'profiles_dir': '/Users/cherry/.dbt', 'indirect_selection': 'eager'}
[0m22:59:18.018448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1622e59d0>]}
[0m22:59:18.123294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048c1040>]}
[0m22:59:18.124509 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m22:59:18.653854 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m22:59:19.175132 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:59:19.175812 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:59:19.277093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1624c00b0>]}
[0m22:59:19.613241 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:59:19.619236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:59:19.690703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640c3e00>]}
[0m22:59:19.691692 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m22:59:19.692229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640ac6b0>]}
[0m22:59:19.697401 [info ] [MainThread]: 
[0m22:59:19.697990 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:19.698524 [info ] [MainThread]: 
[0m22:59:19.699356 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m22:59:19.707019 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:59:19.707957 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:19.708978 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:59:19.709370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:19.710309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m22:59:19.711872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:21.517226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_intermediate)
[0m22:59:21.519389 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_marts)
[0m22:59:21.520037 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_staging)
[0m22:59:21.520915 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:21.521437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:21.522331 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:59:21.953594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640c3dd0>]}
[0m22:59:21.972425 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m22:59:21.981195 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m22:59:21.982272 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m22:59:21.982928 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:22.430359 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:655b4925-43de-48e8-a6fb-b8a84df1435f&page=queryresults
[0m22:59:22.901975 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 0.95s]
[0m22:59:22.902680 [info ] [MainThread]: 
[0m22:59:22.911700 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m22:59:22.912657 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m22:59:22.913800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.stg_orders__amazon_order_items)
[0m22:59:22.914625 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m22:59:22.921679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:59:22.923004 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m22:59:22.974687 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m22:59:22.977030 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m22:59:22.977510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:23.450203 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:6febd23a-17fd-4ef9-9b97-653c52cbdaf3&page=queryresults
[0m22:59:23.934625 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106700bf0>]}
[0m22:59:23.935640 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.02s]
[0m22:59:23.936735 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m22:59:23.938080 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:59:23.938651 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m22:59:23.938991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m22:59:23.939928 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m22:59:23.940566 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:59:23.940971 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m22:59:23.947397 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m22:59:23.954687 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m22:59:23.955642 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:59:23.956323 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:59:23.957329 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m22:59:23.958335 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m22:59:23.959673 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:59:23.960410 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m22:59:23.961169 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:59:23.984768 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m22:59:23.985350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:59:23.986527 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m22:59:23.987748 [debug] [Thread-3 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:59:23.988395 [info ] [Thread-3 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m22:59:23.988709 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m22:59:23.989390 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m22:59:24.014493 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:59:24.015709 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m22:59:24.023626 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m22:59:24.025698 [debug] [Thread-3 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on jo.order_item_id = fta.order_item_id

    left join with_prime_exclusive_price as prime
        on jo.order_item_id = prime.order_item_id

    order by fta.purchase_datetime desc, jo.tenant_id asc, jo.marketplace desc, jo.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m22:59:24.027062 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m22:59:24.690088 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:e2887c42-7059-4cc5-9900-c67f8a0ab319&page=queryresults
[0m22:59:25.151650 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1640659a0>]}
[0m22:59:25.152938 [info ] [Thread-3 (]: 2 of 4 OK created sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m22:59:25.153542 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m22:59:25.154386 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:59:25.154890 [info ] [Thread-2 (]: 3 of 4 START sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [RUN]
[0m22:59:25.155452 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.int_aggregate_joined_orders_with_added_fields)
[0m22:59:25.156148 [debug] [Thread-2 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:59:25.162040 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m22:59:25.164125 [debug] [Thread-2 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:59:25.167389 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m22:59:25.168377 [debug] [Thread-2 (]: On model.dbt_project.int_aggregate_joined_orders_with_added_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_aggregate_joined_orders_with_added_fields"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_aggregate_joined_orders_with_added_fields`
  OPTIONS()
  as -- int_aggregate_joined_orders_with_added_fields.sql



with

joined_orders_with_added_fields as (

    select * from `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`

),

aggregate_joined_orders_with_added_fields as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id,
        REGEXP_EXTRACT(seller_sku, r'[^_]+$') as product_code,
        SUM(quantity_ordered) as quantity_ordered,
        SUM(item_price_amount) as item_price_amount,
        SUM(promotion_discount_amount) as promotion_discount_amount,
        SUM(item_tax_amount) as item_tax_amount,
        SUM(output_vat) as output_vat,
        SUM(coupon_fee) as coupon_fee,

        -- Sales Price per unit, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    ROUND(
                        SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat), SUM(quantity_ordered)
                        ), 2
                    )
            else
                ROUND(
                    SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee), SUM(quantity_ordered)
                    ), 2
                )
        end as net_item_price_per_unit,

        -- Sales Price per order, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat)
            else
                SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee)
        end as net_item_price_amount,

        -- Estimated Referral Fee Percentage
        case
            when tenant_id = 1
                then 0.15
            when tenant_id = 2
                then
                    case
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_CALF-SLEEV*') -- Calf Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_GRIP-SOCKS*') -- Grip Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_COMP-SOCKS*') -- Compression Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_PF-SOCKS*') -- Plantar Socks
                            then
                                case
                                    when marketplace = 'US'
                                        then 0.05
                                    when marketplace = 'UK'
                                        then 0.08
                                end
                        when (
                            REGEXP_CONTAINS(seller_sku, r'^R_KNEE-SLE*') -- Knee Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_ELBO-SLE*') -- Elbow Sleeves
                        )
                        and (
                            marketplace = 'US'
                            or marketplace = 'UK'
                        )
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_2PC_*')
                                        then 0.15
                                    else 0.08
                                end
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_HIKE-SOC*') -- Merino Wool Hiking Socks
                            and marketplace = 'UK'
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_3PR_*')
                                        then 0.15
                                    else 0.08
                                end
                    end
        end as referral_fee_pct,
        -- SUM(item_price_amount) * 0.15 as referral_fees, -- old formula for Bare Barrel only
        referral_fee_pct * (net_item_price_amount + SUM(shipping_price_amount) - SUM(shipping_discount_amount) + SUM(buyer_info_gift_wrap_price_amount))
            as referral_fees

    from joined_orders_with_added_fields

    group by purchase_date, marketplace, asin, seller_sku, item_price_currency_code, is_vine, is_replacement_order, tenant_id, order_status

    order by purchase_date desc, marketplace desc, quantity_ordered desc
)

select * from aggregate_joined_orders_with_added_fields;


[0m22:59:25.168928 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m22:59:25.834541 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:99d5a91e-a9d9-41f6-92d0-03e85291a997&page=queryresults
[0m22:59:26.030691 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:99d5a91e-a9d9-41f6-92d0-03e85291a997&page=queryresults
[0m22:59:26.046038 [debug] [Thread-2 (]: Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  Unrecognized name: referral_fee_pct at [107:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m22:59:26.047074 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa1addd9-c1cb-4fab-843b-dae219605318', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1648afb30>]}
[0m22:59:26.048182 [error] [Thread-2 (]: 3 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[31mERROR[0m in 0.89s]
[0m22:59:26.049176 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m22:59:26.050165 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' to be skipped because of status 'error'.  Reason: Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  Unrecognized name: referral_fee_pct at [107:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql.
[0m22:59:26.052030 [debug] [Thread-4 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:59:26.052637 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m22:59:26.053169 [debug] [Thread-4 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m22:59:26.054240 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m22:59:26.055395 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:26.055822 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m22:59:26.056160 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m22:59:26.056636 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m22:59:26.057114 [debug] [MainThread]: Connection 'model.dbt_project.int_join_orders_and_order_items' was properly closed.
[0m22:59:26.057520 [info ] [MainThread]: 
[0m22:59:26.057782 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 6.36 seconds (6.36s).
[0m22:59:26.059408 [debug] [MainThread]: Command end result
[0m22:59:26.470233 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m22:59:26.475003 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m22:59:26.484505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m22:59:26.485204 [info ] [MainThread]: 
[0m22:59:26.485791 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m22:59:26.486364 [info ] [MainThread]: 
[0m22:59:26.486966 [error] [MainThread]: [31mFailure in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)[0m
[0m22:59:26.487623 [error] [MainThread]:   Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  Unrecognized name: referral_fee_pct at [107:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m22:59:26.488161 [info ] [MainThread]: 
[0m22:59:26.488666 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m22:59:26.489183 [info ] [MainThread]: 
[0m22:59:26.489693 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m22:59:26.493267 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.5149765, "process_in_blocks": "0", "process_kernel_time": 1.338674, "process_mem_max_rss": "379256832", "process_out_blocks": "0", "process_user_time": 5.904649}
[0m22:59:26.494136 [debug] [MainThread]: Command `dbt run` failed at 22:59:26.493940 after 12.52 seconds
[0m22:59:26.494693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b95040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104600b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053eb0e0>]}
[0m22:59:26.495362 [debug] [MainThread]: Flushing usage events
[0m22:59:27.058547 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:08:22.282541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d1f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295310>]}


============================== 23:08:22.290603 | be5f8793-fff7-4302-88d9-3aa72152b7c4 ==============================
[0m23:08:22.290603 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:08:22.291690 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'printer_width': '80', 'introspect': 'True', 'empty': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/cherry/.dbt', 'partial_parse': 'True', 'invocation_command': 'dbt run', 'use_colors': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'target_path': 'None', 'write_json': 'True', 'fail_fast': 'False', 'version_check': 'True', 'debug': 'False', 'no_print': 'None', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs'}
[0m23:08:26.212793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14072ab40>]}
[0m23:08:26.323801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1438f4920>]}
[0m23:08:26.324701 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m23:08:26.834195 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:08:27.371270 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:08:27.372160 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:08:27.464498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143a6bd70>]}
[0m23:08:27.783011 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:08:27.788570 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:08:27.855913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x147dc8950>]}
[0m23:08:27.856862 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m23:08:27.857519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14785dc10>]}
[0m23:08:27.861589 [info ] [MainThread]: 
[0m23:08:27.862183 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:08:27.862840 [info ] [MainThread]: 
[0m23:08:27.863614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:08:27.870118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:08:27.870781 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:08:27.871516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:27.872002 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:08:27.872679 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:27.873553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:08:29.648120 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_staging)
[0m23:08:29.649310 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_intermediate)
[0m23:08:29.650033 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_modern-sublime-383117, now list_modern-sublime-383117_dbt_cherry_marts)
[0m23:08:29.650654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:29.651326 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:29.651882 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:08:30.005428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x14785dc10>]}
[0m23:08:30.026754 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m23:08:30.035302 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m23:08:30.036365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m23:08:30.037082 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:08:30.516737 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:710e84cf-d3bc-4928-8f98-661405c770ff&page=queryresults
[0m23:08:31.030747 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.02s]
[0m23:08:31.031595 [info ] [MainThread]: 
[0m23:08:31.039547 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m23:08:31.040670 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m23:08:31.041712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now model.dbt_project.stg_orders__amazon_order_items)
[0m23:08:31.042363 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m23:08:31.049675 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m23:08:31.050900 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m23:08:31.104942 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m23:08:31.107046 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m23:08:31.107698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:31.652020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:77199427-e012-4ec0-89ed-8400b31d2454&page=queryresults
[0m23:08:32.133713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105340a10>]}
[0m23:08:32.134806 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.09s]
[0m23:08:32.135834 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m23:08:32.137105 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:08:32.137788 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m23:08:32.138344 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m23:08:32.139106 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m23:08:32.139617 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:08:32.140196 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m23:08:32.147319 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m23:08:32.154375 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m23:08:32.155450 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:08:32.156102 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:08:32.157390 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m23:08:32.158398 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:08:32.159129 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:08:32.159607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m23:08:32.160205 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:08:32.185047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m23:08:32.186167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:08:32.187230 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:08:32.187923 [debug] [Thread-4 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m23:08:32.188789 [info ] [Thread-4 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m23:08:32.189439 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.int_add_fields_to_joined_orders)
[0m23:08:32.190315 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m23:08:32.215962 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m23:08:32.217702 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m23:08:32.226531 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m23:08:32.228670 [debug] [Thread-4 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on jo.order_item_id = fta.order_item_id

    left join with_prime_exclusive_price as prime
        on jo.order_item_id = prime.order_item_id

    order by fta.purchase_datetime desc, jo.tenant_id asc, jo.marketplace desc, jo.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m23:08:32.229872 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:08:32.993674 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:4492e895-3fa2-49a6-aca3-f629d4d75c4d&page=queryresults
[0m23:08:33.577022 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164888140>]}
[0m23:08:33.577966 [info ] [Thread-4 (]: 2 of 4 OK created sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m23:08:33.578730 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m23:08:33.579705 [debug] [Thread-3 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:08:33.580616 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [RUN]
[0m23:08:33.581428 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_aggregate_joined_orders_with_added_fields)
[0m23:08:33.582078 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:08:33.588194 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m23:08:33.589397 [debug] [Thread-3 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:08:33.593429 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m23:08:33.594989 [debug] [Thread-3 (]: On model.dbt_project.int_aggregate_joined_orders_with_added_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_aggregate_joined_orders_with_added_fields"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_aggregate_joined_orders_with_added_fields`
  OPTIONS()
  as -- int_aggregate_joined_orders_with_added_fields.sql



with

joined_orders_with_added_fields as (

    select * from `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`

),

aggregate_joined_orders_with_added_fields as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id,
        shipping_price_amount,
        shipping_discount_amount,
        buyer_info_gift_wrap_price_amount,
        REGEXP_EXTRACT(seller_sku, r'[^_]+$') as product_code,
        SUM(quantity_ordered) as quantity_ordered,
        SUM(item_price_amount) as item_price_amount,
        SUM(promotion_discount_amount) as promotion_discount_amount,
        SUM(item_tax_amount) as item_tax_amount,
        SUM(output_vat) as output_vat,
        SUM(coupon_fee) as coupon_fee,

        -- Sales Price per unit, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    ROUND(
                        SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat), SUM(quantity_ordered)
                        ), 2
                    )
            else
                ROUND(
                    SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee), SUM(quantity_ordered)
                    ), 2
                )
        end as net_item_price_per_unit,

        -- Sales Price per order, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat)
            else
                SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee)
        end as net_item_price_amount,

        -- Estimated Referral Fee Percentage
        case
            when tenant_id = 1
                then 0.15
            when tenant_id = 2
                then
                    case
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_CALF-SLEEV*') -- Calf Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_GRIP-SOCKS*') -- Grip Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_COMP-SOCKS*') -- Compression Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_PF-SOCKS*') -- Plantar Socks
                            then
                                case
                                    when marketplace = 'US'
                                        then 0.05
                                    when marketplace = 'UK'
                                        then 0.08
                                end
                        when (
                            REGEXP_CONTAINS(seller_sku, r'^R_KNEE-SLE*') -- Knee Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_ELBO-SLE*') -- Elbow Sleeves
                        )
                        and (
                            marketplace = 'US'
                            or marketplace = 'UK'
                        )
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_2PC_*')
                                        then 0.15
                                    else 0.08
                                end
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_HIKE-SOC*') -- Merino Wool Hiking Socks
                            and marketplace = 'UK'
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_3PR_*')
                                        then 0.15
                                    else 0.08
                                end
                    end
        end as referral_fee_pct
        -- SUM(item_price_amount) * 0.15 as referral_fees, -- old formula for Bare Barrel only

    from joined_orders_with_added_fields

    group by purchase_date, marketplace, asin, seller_sku, item_price_currency_code, is_vine, is_replacement_order, tenant_id, order_status

    order by purchase_date desc, marketplace desc, quantity_ordered desc
),

add_referral_fees as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id,
        product_code,
        quantity_ordered,
        item_price_amount,
        promotion_discount_amount,
        item_tax_amount,
        output_vat,
        coupon_fee,
        net_item_price_per_unit,
        net_item_price_amount,
        referral_fee_pct,
        referral_fee_pct * (net_item_price_amount + SUM(shipping_price_amount) - SUM(shipping_discount_amount) + SUM(buyer_info_gift_wrap_price_amount))
            as referral_fees
    from aggregate_joined_orders_with_added_fields
)

select * from add_referral_fees;


[0m23:08:33.595646 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:08:34.250590 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:460807a1-98ad-40e4-b90b-518213483d55&page=queryresults
[0m23:08:34.480206 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:460807a1-98ad-40e4-b90b-518213483d55&page=queryresults
[0m23:08:34.492578 [debug] [Thread-3 (]: Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  SELECT list expression references column shipping_price_amount which is neither grouped nor aggregated at [30:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m23:08:34.493508 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be5f8793-fff7-4302-88d9-3aa72152b7c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1643e6150>]}
[0m23:08:34.493993 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[31mERROR[0m in 0.91s]
[0m23:08:34.495422 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:08:34.496309 [debug] [Thread-7 (]: Marking all children of 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' to be skipped because of status 'error'.  Reason: Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  SELECT list expression references column shipping_price_amount which is neither grouped nor aggregated at [30:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql.
[0m23:08:34.498175 [debug] [Thread-2 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m23:08:34.499035 [info ] [Thread-2 (]: 4 of 4 SKIP relation dbt_cherry_marts.obt_orders_per_asin_and_date ............. [[33mSKIP[0m]
[0m23:08:34.499723 [debug] [Thread-2 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m23:08:34.500945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:08:34.501829 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:08:34.502200 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m23:08:34.502358 [debug] [MainThread]: Connection 'list_modern-sublime-383117_dbt_cherry_intermediate' was properly closed.
[0m23:08:34.502528 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m23:08:34.503058 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m23:08:34.503645 [info ] [MainThread]: 
[0m23:08:34.504421 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 6.64 seconds (6.64s).
[0m23:08:34.505763 [debug] [MainThread]: Command end result
[0m23:08:34.917604 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:08:34.922256 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:08:34.931618 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m23:08:34.932407 [info ] [MainThread]: 
[0m23:08:34.933163 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:08:34.933706 [info ] [MainThread]: 
[0m23:08:34.934335 [error] [MainThread]: [31mFailure in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)[0m
[0m23:08:34.934872 [error] [MainThread]:   Database Error in model int_aggregate_joined_orders_with_added_fields (models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql)
  SELECT list expression references column shipping_price_amount which is neither grouped nor aggregated at [30:9]
  compiled code at target/run/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m23:08:34.935337 [info ] [MainThread]: 
[0m23:08:34.935878 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/intermediate/sales/int_aggregate_joined_orders_with_added_fields.sql
[0m23:08:34.936403 [info ] [MainThread]: 
[0m23:08:34.936990 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=5
[0m23:08:34.940005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 12.779345, "process_in_blocks": "0", "process_kernel_time": 1.411039, "process_mem_max_rss": "380583936", "process_out_blocks": "0", "process_user_time": 5.886911}
[0m23:08:34.940743 [debug] [MainThread]: Command `dbt run` failed at 23:08:34.940578 after 12.78 seconds
[0m23:08:34.941478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106295580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143dad4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10330bfb0>]}
[0m23:08:34.941820 [debug] [MainThread]: Flushing usage events
[0m23:08:35.512219 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:11:02.261687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10524d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105995730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105995460>]}


============================== 23:11:02.268237 | a76dd663-72e2-4928-8b73-c2372e8b4cf6 ==============================
[0m23:11:02.268237 [info ] [MainThread]: Running with dbt=1.10.13
[0m23:11:02.268962 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'cache_selected_only': 'False', 'no_print': 'None', 'target_path': 'None', 'write_json': 'True', 'quiet': 'False', 'introspect': 'True', 'version_check': 'True', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/Users/cherry/.dbt', 'indirect_selection': 'eager', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'printer_width': '80', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'log_cache_events': 'False', 'empty': 'False'}
[0m23:11:06.218375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x159527890>]}
[0m23:11:06.325431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1594c1fd0>]}
[0m23:11:06.325962 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m23:11:06.851445 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m23:11:07.375337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:11:07.375978 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:11:07.474469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9c31a0>]}
[0m23:11:07.784482 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:11:07.789783 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:11:07.856560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b19c3e0>]}
[0m23:11:07.857151 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m23:11:07.857820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x146456480>]}
[0m23:11:07.861996 [info ] [MainThread]: 
[0m23:11:07.862904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:11:07.863415 [info ] [MainThread]: 
[0m23:11:07.864329 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m23:11:07.872151 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:11:07.873093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:07.874062 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:11:07.874485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:07.875296 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117'
[0m23:11:07.876031 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.523751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m23:11:09.525299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.527465 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m23:11:09.528431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m23:11:09.528781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.530343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:11:09.984516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059b8b00>]}
[0m23:11:10.003033 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m23:11:10.010257 [info ] [MainThread]: 1 of 1 START hook: dbt_project.on-run-start.0 .................................. [RUN]
[0m23:11:10.011167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "connection_name": "master"} */
create schema if not exists dbt_cherry
[0m23:11:10.011836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:11:10.772028 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:d0fbbac5-3159-4806-934e-7b8d06c471fd&page=queryresults
[0m23:11:11.250884 [info ] [MainThread]: 1 of 1 OK hook: dbt_project.on-run-start.0 ..................................... [[32mOK[0m in 1.26s]
[0m23:11:11.251659 [info ] [MainThread]: 
[0m23:11:11.258639 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m23:11:11.259619 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_cherry_staging.stg_orders__amazon_order_items .. [RUN]
[0m23:11:11.260402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m23:11:11.261178 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m23:11:11.268339 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m23:11:11.270168 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m23:11:11.323988 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_orders__amazon_order_items"
[0m23:11:11.325333 [debug] [Thread-1 (]: On model.dbt_project.stg_orders__amazon_order_items: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.stg_orders__amazon_order_items"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`
  OPTIONS()
  as -- stg_orders__amazon_order_items.sql

with

source as (

    select * from `modern-sublime-383117`.`orders`.`amazon_order_items`

),

handle_nulls as (

    select
        -- ids
        asin,
        tenant_id,
        order_item_id,
        promotion_ids,
        amazon_order_id,

        -- strings
        title,
        seller_sku,
        marketplace,
        tax_collection_model,
        item_tax_currency_code,
        item_price_currency_code,
        shipping_tax_currency_code,
        shipping_price_currency_code,
        shipping_discount_currency_code,
        promotion_discount_currency_code,
        tax_collection_responsible_party,
        shipping_discount_tax_currency_code,
        promotion_discount_tax_currency_code,
        buyer_info_gift_wrap_tax_currency_code,
        buyer_info_gift_wrap_price_currency_code,

        -- numerics
        quantity_ordered,
        quantity_shipped,
        shipping_tax_amount,
        shipping_price_amount,
        shipping_discount_amount,
        product_info_number_of_items,
        shipping_discount_tax_amount,
        buyer_info_gift_wrap_tax_amount,
        buyer_info_gift_wrap_price_amount,

        -- booleans
        is_gift,
        is_transparency,

        -- dates and timestamps
        created_at,
        updated_at,

        COALESCE(item_tax_amount, 0) as item_tax_amount,
        COALESCE(item_price_amount, 0) as item_price_amount,
        COALESCE(promotion_discount_amount, 0) as promotion_discount_amount,
        COALESCE(promotion_discount_tax_amount, 0) as promotion_discount_tax_amount

    from source

)

select * from handle_nulls;


[0m23:11:11.326170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:11.854115 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:c3e7010d-f134-4108-a274-b45716d732ce&page=queryresults
[0m23:11:12.851157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x143f65e80>]}
[0m23:11:12.852517 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_cherry_staging.stg_orders__amazon_order_items  [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m23:11:12.853426 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m23:11:12.854888 [debug] [Thread-3 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:11:12.855421 [debug] [Thread-4 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m23:11:12.855853 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.int_get_prime_exclusive_price_for_new_orders)
[0m23:11:12.856911 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_join_orders_and_order_items'
[0m23:11:12.857402 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:11:12.857983 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m23:11:12.865886 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m23:11:12.872321 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m23:11:12.873502 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:11:12.874949 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m23:11:12.875648 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:11:12.876767 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m23:11:12.877098 [debug] [Thread-1 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:11:12.877334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m23:11:12.877555 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:11:12.894627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m23:11:12.895722 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:11:12.896205 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m23:11:12.897401 [debug] [Thread-4 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m23:11:12.897808 [info ] [Thread-4 (]: 2 of 4 START sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [RUN]
[0m23:11:12.898208 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.int_add_fields_to_joined_orders)
[0m23:11:12.898505 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m23:11:12.915282 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m23:11:12.916949 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m23:11:12.922727 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m23:11:12.924417 [debug] [Thread-4 (]: On model.dbt_project.int_add_fields_to_joined_orders: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_add_fields_to_joined_orders"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`
  OPTIONS()
  as -- int_add_fields_to_joined_orders.sql
-- same as amazon_order_items_detailed_view



with

 __dbt__cte__int_join_orders_and_order_items as (
-- int_join_orders_and_order_items.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

join_orders_and_order_items as (
    select
        o.amazon_order_id,
        oi.order_item_id,
        o.marketplace,
        o.sales_channel,
        oi.asin,
        oi.seller_sku,
        o.order_status,
        oi.quantity_ordered,
        oi.promotion_ids,
        oi.product_info_number_of_items,
        o.is_replacement_order,
        oi.item_price_amount,
        oi.item_price_currency_code,
        oi.item_tax_amount,
        oi.item_tax_currency_code,
        oi.promotion_discount_tax_amount,
        oi.promotion_discount_tax_currency_code,
        oi.promotion_discount_amount,
        oi.promotion_discount_currency_code,
        oi.tax_collection_model,
        oi.tax_collection_responsible_party,
        o.is_prime,
        o.replaced_order_id,
        oi.is_gift,
        o.tenant_id,
        o.purchase_date,
        oi.shipping_price_amount,
        oi.shipping_price_currency_code,
        oi.shipping_discount_amount,
        oi.shipping_discount_currency_code,
        oi.buyer_info_gift_wrap_price_amount,
        oi.buyer_info_gift_wrap_price_currency_code

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    order by o.purchase_date desc, o.tenant_id asc, o.marketplace desc, oi.seller_sku asc

)

select * from join_orders_and_order_items
),  __dbt__cte__int_calculate_fields_for_joined_orders as (
-- int_calculate_fields_for_joined_orders.sql



with

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

calculate_fields as (

    select
        order_item_id,

        -- purchase_date
        purchase_date as purchase_datetime,
        DATE(purchase_date) as purchase_date,

        -- UK VAT of 20%
        case
            when marketplace = 'UK' and item_tax_amount > 0
                then item_tax_amount
            when marketplace = 'UK' and item_tax_amount = 0
                then (item_price_amount / 1.20) * 0.20
            else 0
        end as output_vat,

        -- Coupon Fee
        case
            when
                promotion_ids like '%VPC%'
                and marketplace in ('US', 'CA')
                then 0.6
            when
                promotion_ids like '%VPC%'
                and marketplace = 'UK'
                then 0.45
            when promotion_ids like '%PLM%'
                then item_price_amount * 0.025
            else 0
        end as coupon_fee,

        -- Determines if Vine order
        case
            when
                order_status not in ('Pending', 'Canceled')
                and item_price_amount is null
                and is_replacement_order = false
                and quantity_ordered > 0
                then true
            when
                promotion_ids like '%vine%'
                then true
            else false
        end as is_vine

    from joined_orders

)

select * from calculate_fields
),  __dbt__cte__int_get_prime_exclusive_price_for_new_orders as (
-- int_get_prime_exclusive_price_for_new_orders.sql



with

orders as (

    select * from `modern-sublime-383117`.`orders`.`amazon_orders`

),

order_items as (

    select * from `modern-sublime-383117`.`dbt_cherry_staging`.`stg_orders__amazon_order_items`

),

competitive_pricing as (

    select * from `modern-sublime-383117`.`product_pricing`.`competitive_pricing`

),

prime_prices as (
    select
        asin,
        marketplace,
        (ARRAY_AGG(
            JSON_EXTRACT_SCALAR(
                product_competitive_pricing_competitive_prices,
                '$[0].Price.ListingPrice.Amount'
            ) order by date desc limit 1
        ))[OFFSET(0)] as prime_price
    from competitive_pricing
    where
        customer_type = 'Business'
        and product_competitive_pricing_competitive_prices != '[]'
    group by asin, marketplace
),

get_prime_exclusive_price as (

    select
        o.amazon_order_id,
        oi.order_item_id,

        case
            when
                o.order_status in ('Pending')
                and oi.item_price_amount is null
                and o.is_replacement_order = false
                then
                    CAST(pp.prime_price as numeric) * oi.quantity_ordered
            else oi.item_price_amount
        end as item_price_amount

    from orders as o

    left join order_items as oi
        on o.amazon_order_id = oi.amazon_order_id

    left join prime_prices as pp
        on
            oi.asin = pp.asin
            and oi.marketplace = pp.marketplace

)

select * from get_prime_exclusive_price
), fields_to_add as (

    select * from __dbt__cte__int_calculate_fields_for_joined_orders

),

with_prime_exclusive_price as (

    select * from __dbt__cte__int_get_prime_exclusive_price_for_new_orders

),

joined_orders as (

    select * from __dbt__cte__int_join_orders_and_order_items

),

add_fields_to_joined_orders as (

    select
        jo.amazon_order_id,
        jo.order_item_id,
        fta.purchase_datetime,
        fta.purchase_date,
        jo.marketplace,
        jo.sales_channel,
        jo.asin,
        jo.seller_sku,
        jo.order_status,
        jo.quantity_ordered,
        jo.promotion_ids,
        jo.product_info_number_of_items,
        jo.item_price_currency_code,
        prime.item_price_amount,
        jo.item_tax_amount,
        jo.promotion_discount_tax_currency_code,
        fta.output_vat,
        jo.item_tax_currency_code,
        jo.promotion_discount_tax_amount,
        jo.promotion_discount_currency_code,
        jo.promotion_discount_amount,
        fta.coupon_fee,
        jo.tax_collection_model,
        jo.tax_collection_responsible_party,
        jo.is_prime,
        jo.is_replacement_order,
        jo.replaced_order_id,
        jo.is_gift,
        fta.is_vine,
        jo.tenant_id,
        jo.shipping_price_amount,
        jo.shipping_price_currency_code,
        jo.shipping_discount_amount,
        jo.shipping_discount_currency_code,
        jo.buyer_info_gift_wrap_price_amount,
        jo.buyer_info_gift_wrap_price_currency_code

    from joined_orders as jo

    left join fields_to_add as fta
        on jo.order_item_id = fta.order_item_id

    left join with_prime_exclusive_price as prime
        on jo.order_item_id = prime.order_item_id

    order by fta.purchase_datetime desc, jo.tenant_id asc, jo.marketplace desc, jo.seller_sku asc
)

select * from add_fields_to_joined_orders;


[0m23:11:12.925674 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:11:13.763812 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:a59ba811-1a32-4376-a06f-385b3cd742fe&page=queryresults
[0m23:11:14.256869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c78eed0>]}
[0m23:11:14.258166 [info ] [Thread-4 (]: 2 of 4 OK created sql view model dbt_cherry_intermediate.int_add_fields_to_joined_orders  [[32mCREATE VIEW (0 processed)[0m in 1.36s]
[0m23:11:14.259530 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m23:11:14.260647 [debug] [Thread-2 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:11:14.261570 [info ] [Thread-2 (]: 3 of 4 START sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [RUN]
[0m23:11:14.262104 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now model.dbt_project.int_aggregate_joined_orders_with_added_fields)
[0m23:11:14.262557 [debug] [Thread-2 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:11:14.269678 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m23:11:14.271533 [debug] [Thread-2 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:11:14.276055 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m23:11:14.277802 [debug] [Thread-2 (]: On model.dbt_project.int_aggregate_joined_orders_with_added_fields: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.int_aggregate_joined_orders_with_added_fields"} */


  create or replace view `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_aggregate_joined_orders_with_added_fields`
  OPTIONS()
  as -- int_aggregate_joined_orders_with_added_fields.sql



with

joined_orders_with_added_fields as (

    select * from `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_add_fields_to_joined_orders`

),

aggregate_joined_orders_with_added_fields as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id,
        REGEXP_EXTRACT(seller_sku, r'[^_]+$') as product_code,
        SUM(quantity_ordered) as quantity_ordered,
        SUM(item_price_amount) as item_price_amount,
        SUM(promotion_discount_amount) as promotion_discount_amount,
        SUM(item_tax_amount) as item_tax_amount,
        SUM(shipping_price_amount) as shipping_price_amount,
        SUM(shipping_discount_amount) as shipping_discount_amount,
        SUM(buyer_info_gift_wrap_price_amount) as buyer_info_gift_wrap_price_amount,
        SUM(output_vat) as output_vat,
        SUM(coupon_fee) as coupon_fee,

        -- Sales Price per unit, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    ROUND(
                        SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat), SUM(quantity_ordered)
                        ), 2
                    )
            else
                ROUND(
                    SAFE_DIVIDE(SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee), SUM(quantity_ordered)
                    ), 2
                )
        end as net_item_price_per_unit,

        -- Sales Price per order, UK Sales have 20% VAT included
        case
            when marketplace = 'UK'
                then
                    SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee) - SUM(output_vat)
            else
                SUM(item_price_amount) - SUM(promotion_discount_amount) - SUM(coupon_fee)
        end as net_item_price_amount,

        -- Estimated Referral Fee Percentage
        case
            when tenant_id = 1
                then 0.15
            when tenant_id = 2
                then
                    case
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_CALF-SLEEV*') -- Calf Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_GRIP-SOCKS*') -- Grip Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_COMP-SOCKS*') -- Compression Socks
                            or REGEXP_CONTAINS(seller_sku, r'^R_PF-SOCKS*') -- Plantar Socks
                            then
                                case
                                    when marketplace = 'US'
                                        then 0.05
                                    when marketplace = 'UK'
                                        then 0.08
                                end
                        when (
                            REGEXP_CONTAINS(seller_sku, r'^R_KNEE-SLE*') -- Knee Sleeves
                            or REGEXP_CONTAINS(seller_sku, r'^R_ELBO-SLE*') -- Elbow Sleeves
                        )
                        and (
                            marketplace = 'US'
                            or marketplace = 'UK'
                        )
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_2PC_*')
                                        then 0.15
                                    else 0.08
                                end
                        when
                            REGEXP_CONTAINS(seller_sku, r'^R_HIKE-SOC*') -- Merino Wool Hiking Socks
                            and marketplace = 'UK'
                            then
                                case
                                    when REGEXP_CONTAINS(seller_sku, r'^*_3PR_*')
                                        then 0.15
                                    else 0.08
                                end
                    end
        end as referral_fee_pct
        -- SUM(item_price_amount) * 0.15 as referral_fees, -- old formula for Bare Barrel only

    from joined_orders_with_added_fields

    group by purchase_date, marketplace, asin, seller_sku, item_price_currency_code, is_vine, is_replacement_order, tenant_id, order_status

    order by purchase_date desc, marketplace desc, quantity_ordered desc
),

add_referral_fees as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id,
        product_code,
        quantity_ordered,
        item_price_amount,
        promotion_discount_amount,
        item_tax_amount,
        output_vat,
        coupon_fee,
        net_item_price_per_unit,
        net_item_price_amount,
        referral_fee_pct,
        referral_fee_pct * (net_item_price_amount + shipping_price_amount - shipping_discount_amount + buyer_info_gift_wrap_price_amount)
            as referral_fees
    from aggregate_joined_orders_with_added_fields
)

select * from add_referral_fees;


[0m23:11:14.278686 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m23:11:16.847690 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:e9924fac-f962-4e89-887f-fa7b6dd15809&page=queryresults
[0m23:11:17.311338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c2a8fe0>]}
[0m23:11:17.312218 [info ] [Thread-2 (]: 3 of 4 OK created sql view model dbt_cherry_intermediate.int_aggregate_joined_orders_with_added_fields  [[32mCREATE VIEW (0 processed)[0m in 3.05s]
[0m23:11:17.313347 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m23:11:17.314216 [debug] [Thread-3 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m23:11:17.314842 [info ] [Thread-3 (]: 4 of 4 START sql table model dbt_cherry_marts.obt_orders_per_asin_and_date ..... [RUN]
[0m23:11:17.315579 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.obt_orders_per_asin_and_date)
[0m23:11:17.316352 [debug] [Thread-3 (]: Began compiling node model.dbt_project.obt_orders_per_asin_and_date
[0m23:11:17.321742 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.obt_orders_per_asin_and_date"
[0m23:11:17.323807 [debug] [Thread-3 (]: Began executing node model.dbt_project.obt_orders_per_asin_and_date
[0m23:11:17.375208 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.obt_orders_per_asin_and_date"
[0m23:11:17.377105 [debug] [Thread-3 (]: On model.dbt_project.obt_orders_per_asin_and_date: /* {"app": "dbt", "dbt_version": "1.10.13", "profile_name": "dbt_project", "target_name": "dev", "node_id": "model.dbt_project.obt_orders_per_asin_and_date"} */

  
    

    create or replace table `modern-sublime-383117`.`dbt_cherry_marts`.`obt_orders_per_asin_and_date`
      
    
    

    
    OPTIONS()
    as (
      -- obt_orders_per_asin_and_date.sql
-- same as amazon_orders_summary_view

with

aggregated_joined_orders as (

    select * from `modern-sublime-383117`.`dbt_cherry_intermediate`.`int_aggregate_joined_orders_with_added_fields`

),

reorder_fields as (

    select
        purchase_date,
        marketplace,
        order_status,
        asin,
        seller_sku,
        product_code,
        quantity_ordered,
        net_item_price_per_unit,
        item_price_amount,
        promotion_discount_amount,
        item_tax_amount,
        output_vat,
        net_item_price_amount,
        referral_fees,
        coupon_fee,
        item_price_currency_code,
        is_vine,
        is_replacement_order,
        tenant_id

    from aggregated_joined_orders

    order by purchase_date desc, marketplace desc, quantity_ordered desc
)

select * from reorder_fields
    );
  
[0m23:11:17.377679 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:11:19.458670 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=modern-sublime-383117&j=bq:US:33c5969e-bb35-40af-b764-cb05bce1b55b&page=queryresults
[0m23:11:24.326722 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a76dd663-72e2-4928-8b73-c2372e8b4cf6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15c78aa20>]}
[0m23:11:24.327725 [info ] [Thread-3 (]: 4 of 4 OK created sql table model dbt_cherry_marts.obt_orders_per_asin_and_date  [[32mCREATE TABLE (150.7k rows, 186.2 MiB processed)[0m in 7.01s]
[0m23:11:24.328633 [debug] [Thread-3 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m23:11:24.330024 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:11:24.330538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:11:24.331134 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m23:11:24.331613 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m23:11:24.332061 [debug] [MainThread]: Connection 'list_modern-sublime-383117' was properly closed.
[0m23:11:24.332536 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m23:11:24.332705 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m23:11:24.333215 [debug] [MainThread]: Connection 'model.dbt_project.obt_orders_per_asin_and_date' was properly closed.
[0m23:11:24.333628 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m23:11:24.334263 [info ] [MainThread]: 
[0m23:11:24.334745 [info ] [MainThread]: Finished running 1 project hook, 1 table model, 3 view models in 0 hours 0 minutes and 16.47 seconds (16.47s).
[0m23:11:24.336801 [debug] [MainThread]: Command end result
[0m23:11:24.783799 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m23:11:24.789240 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m23:11:24.799606 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m23:11:24.800223 [info ] [MainThread]: 
[0m23:11:24.800748 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:11:24.801288 [info ] [MainThread]: 
[0m23:11:24.802196 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m23:11:24.806981 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.642239, "process_in_blocks": "0", "process_kernel_time": 1.353748, "process_mem_max_rss": "377503744", "process_out_blocks": "0", "process_user_time": 5.866807}
[0m23:11:24.807824 [debug] [MainThread]: Command `dbt run` succeeded at 23:11:24.807701 after 22.64 seconds
[0m23:11:24.808343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053e4470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15b642fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x15a9784d0>]}
[0m23:11:24.808849 [debug] [MainThread]: Flushing usage events
[0m23:11:25.339977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:05:01.732297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e35f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1957f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b195520>]}


============================== 14:05:01.741388 | feeb08f7-3aa9-4ef5-ac6c-413f32d08601 ==============================
[0m14:05:01.741388 [info ] [MainThread]: Running with dbt=1.10.13
[0m14:05:01.742484 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'fail_fast': 'False', 'no_print': 'None', 'version_check': 'True', 'invocation_command': 'dbt compile', 'use_colors': 'True', 'static_parser': 'True', 'warn_error': 'None', 'empty': 'False', 'log_format': 'default', 'indirect_selection': 'eager', 'target_path': 'None', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/cherry/.dbt', 'log_cache_events': 'False', 'debug': 'False', 'partial_parse': 'True', 'introspect': 'True', 'log_path': '/Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'quiet': 'False', 'use_experimental_parser': 'False'}
[0m14:05:07.372291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16698c6b0>]}
[0m14:05:07.518856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x164ba2780>]}
[0m14:05:07.519825 [info ] [MainThread]: Registered adapter: bigquery=1.10.2
[0m14:05:08.181325 [debug] [MainThread]: checksum: 9f0c81e2574b4ff463f3d16d080df83c6982fc0372c9feeacae0504ac9ea3ffe, vars: {}, profile: , target: , version: 1.10.13
[0m14:05:08.805472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:05:08.806494 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:05:08.915039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x166c9dd30>]}
[0m14:05:09.284053 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m14:05:09.290132 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m14:05:09.370704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1669336b0>]}
[0m14:05:09.371802 [info ] [MainThread]: Found 7 models, 1 operation, 72 sources, 646 macros
[0m14:05:09.372205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167fcd040>]}
[0m14:05:09.377545 [info ] [MainThread]: 
[0m14:05:09.378145 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:09.378548 [info ] [MainThread]: 
[0m14:05:09.379336 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:05:09.389092 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_marts'
[0m14:05:09.390426 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_staging'
[0m14:05:09.391074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.392041 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_modern-sublime-383117_dbt_cherry_intermediate'
[0m14:05:09.392674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:09.393633 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:11.802487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'feeb08f7-3aa9-4ef5-ac6c-413f32d08601', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071dd190>]}
[0m14:05:11.803751 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:11.808704 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_orders__amazon_order_items
[0m14:05:11.809173 [debug] [Thread-2 (]: Began running node operation.dbt_project.dbt_project-on-run-start-0
[0m14:05:11.809900 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_marts, now model.dbt_project.stg_orders__amazon_order_items)
[0m14:05:11.811008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_staging, now operation.dbt_project.dbt_project-on-run-start-0)
[0m14:05:11.811383 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_orders__amazon_order_items
[0m14:05:11.811734 [debug] [Thread-2 (]: Began compiling node operation.dbt_project.dbt_project-on-run-start-0
[0m14:05:11.839254 [debug] [Thread-2 (]: Writing injected SQL for node "operation.dbt_project.dbt_project-on-run-start-0"
[0m14:05:11.839998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_orders__amazon_order_items"
[0m14:05:11.842458 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_orders__amazon_order_items
[0m14:05:11.843169 [debug] [Thread-2 (]: Began executing node operation.dbt_project.dbt_project-on-run-start-0
[0m14:05:11.843677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:11.844034 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:11.845264 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_orders__amazon_order_items
[0m14:05:11.846398 [debug] [Thread-2 (]: Finished running node operation.dbt_project.dbt_project-on-run-start-0
[0m14:05:11.847972 [debug] [Thread-4 (]: Began running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m14:05:11.848622 [debug] [Thread-3 (]: Began running node model.dbt_project.int_join_orders_and_order_items
[0m14:05:11.849581 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_project.int_get_prime_exclusive_price_for_new_orders'
[0m14:05:11.850141 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_modern-sublime-383117_dbt_cherry_intermediate, now model.dbt_project.int_join_orders_and_order_items)
[0m14:05:11.850694 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m14:05:11.851167 [debug] [Thread-3 (]: Began compiling node model.dbt_project.int_join_orders_and_order_items
[0m14:05:11.857007 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_get_prime_exclusive_price_for_new_orders"
[0m14:05:11.864102 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.int_join_orders_and_order_items"
[0m14:05:11.865347 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:05:11.866229 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:11.867239 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_get_prime_exclusive_price_for_new_orders
[0m14:05:11.868570 [debug] [Thread-3 (]: Finished running node model.dbt_project.int_join_orders_and_order_items
[0m14:05:11.869626 [debug] [Thread-2 (]: Began running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m14:05:11.870255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly operation.dbt_project.dbt_project-on-run-start-0, now model.dbt_project.int_calculate_fields_for_joined_orders)
[0m14:05:11.870849 [debug] [Thread-2 (]: Began compiling node model.dbt_project.int_calculate_fields_for_joined_orders
[0m14:05:11.897002 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.int_calculate_fields_for_joined_orders"
[0m14:05:11.898586 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:05:11.899981 [debug] [Thread-2 (]: Finished running node model.dbt_project.int_calculate_fields_for_joined_orders
[0m14:05:11.900891 [debug] [Thread-4 (]: Began running node model.dbt_project.int_add_fields_to_joined_orders
[0m14:05:11.901548 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_get_prime_exclusive_price_for_new_orders, now model.dbt_project.int_add_fields_to_joined_orders)
[0m14:05:11.902194 [debug] [Thread-4 (]: Began compiling node model.dbt_project.int_add_fields_to_joined_orders
[0m14:05:11.932685 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.int_add_fields_to_joined_orders"
[0m14:05:11.934182 [debug] [Thread-4 (]: Began executing node model.dbt_project.int_add_fields_to_joined_orders
[0m14:05:11.934914 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:05:11.936739 [debug] [Thread-4 (]: Finished running node model.dbt_project.int_add_fields_to_joined_orders
[0m14:05:11.937820 [debug] [Thread-1 (]: Began running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m14:05:11.938443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_project.stg_orders__amazon_order_items, now model.dbt_project.int_aggregate_joined_orders_with_added_fields)
[0m14:05:11.939210 [debug] [Thread-1 (]: Began compiling node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m14:05:11.946295 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.int_aggregate_joined_orders_with_added_fields"
[0m14:05:11.947971 [debug] [Thread-1 (]: Began executing node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m14:05:11.948672 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:05:11.950064 [debug] [Thread-1 (]: Finished running node model.dbt_project.int_aggregate_joined_orders_with_added_fields
[0m14:05:11.951242 [debug] [Thread-3 (]: Began running node model.dbt_project.obt_orders_per_asin_and_date
[0m14:05:11.951978 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_project.int_join_orders_and_order_items, now model.dbt_project.obt_orders_per_asin_and_date)
[0m14:05:11.952402 [debug] [Thread-3 (]: Began compiling node model.dbt_project.obt_orders_per_asin_and_date
[0m14:05:11.958904 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.obt_orders_per_asin_and_date"
[0m14:05:11.960596 [debug] [Thread-3 (]: Began executing node model.dbt_project.obt_orders_per_asin_and_date
[0m14:05:11.961354 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:05:11.962863 [debug] [Thread-3 (]: Finished running node model.dbt_project.obt_orders_per_asin_and_date
[0m14:05:11.964617 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:11.964890 [debug] [MainThread]: Connection 'model.dbt_project.int_aggregate_joined_orders_with_added_fields' was properly closed.
[0m14:05:11.965234 [debug] [MainThread]: Connection 'model.dbt_project.int_calculate_fields_for_joined_orders' was properly closed.
[0m14:05:11.965530 [debug] [MainThread]: Connection 'model.dbt_project.obt_orders_per_asin_and_date' was properly closed.
[0m14:05:11.965733 [debug] [MainThread]: Connection 'model.dbt_project.int_add_fields_to_joined_orders' was properly closed.
[0m14:05:11.967236 [debug] [MainThread]: Command end result
[0m14:05:12.499071 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/manifest.json
[0m14:05:12.504483 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/semantic_manifest.json
[0m14:05:12.517557 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/cherry/Documents/Work/Bare Barrel Ltd/dbt_project/target/run_results.json
[0m14:05:12.522129 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 10.929388, "process_in_blocks": "0", "process_kernel_time": 1.877829, "process_mem_max_rss": "369016832", "process_out_blocks": "0", "process_user_time": 6.682038}
[0m14:05:12.522911 [debug] [MainThread]: Command `dbt compile` succeeded at 14:05:12.522750 after 10.93 seconds
[0m14:05:12.523711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b195010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x167b16d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x16500b500>]}
[0m14:05:12.524322 [debug] [MainThread]: Flushing usage events
[0m14:05:13.066905 [debug] [MainThread]: An error was encountered while trying to flush usage events
